<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="TC-tea">

<title>ENV222 NOTE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="ENV222 note_files/libs/clipboard/clipboard.min.js"></script>
<script src="ENV222 note_files/libs/quarto-html/quarto.js"></script>
<script src="ENV222 note_files/libs/quarto-html/popper.min.js"></script>
<script src="ENV222 note_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ENV222 note_files/libs/quarto-html/anchor.min.js"></script>
<link href="ENV222 note_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ENV222 note_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ENV222 note_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ENV222 note_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ENV222 note_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-markdownhtml-syntax" id="toc-r-markdownhtml-syntax" class="nav-link active" data-scroll-target="#r-markdownhtml-syntax"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1</strong></span> <strong>R-markdown</strong><span style="font-size: 15px;"><sub>(HTML)</sub></span> <strong>syntax</strong></a>
  <ul class="collapse">
  <li><a href="#fundamental" id="toc-fundamental" class="nav-link" data-scroll-target="#fundamental"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.1</strong></span> <strong>Fundamental</strong></a></li>
  <li><a href="#advanced" id="toc-advanced" class="nav-link" data-scroll-target="#advanced"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.2</strong></span> <strong>Advanced</strong></a></li>
  </ul></li>
  <li><a href="#basic-r-charaters" id="toc-basic-r-charaters" class="nav-link" data-scroll-target="#basic-r-charaters"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2</strong></span> <strong>Basic R charaters</strong></a>
  <ul class="collapse">
  <li><a href="#check-the-data-type" id="toc-check-the-data-type" class="nav-link" data-scroll-target="#check-the-data-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.1</strong></span> <strong>Check the data type</strong></a></li>
  <li><a href="#index-to-maximum-and-minimum-values" id="toc-index-to-maximum-and-minimum-values" class="nav-link" data-scroll-target="#index-to-maximum-and-minimum-values"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.2</strong></span> <strong>Index to maximum and minimum values</strong></a></li>
  <li><a href="#capital-and-small-letter" id="toc-capital-and-small-letter" class="nav-link" data-scroll-target="#capital-and-small-letter"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.3</strong></span> <strong>Capital and small letter</strong></a></li>
  <li><a href="#split-string" id="toc-split-string" class="nav-link" data-scroll-target="#split-string"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.4</strong></span> <strong>Split string</strong></a></li>
  <li><a href="#separate-column" id="toc-separate-column" class="nav-link" data-scroll-target="#separate-column"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.5</strong></span> <strong>Separate column</strong></a></li>
  <li><a href="#extract" id="toc-extract" class="nav-link" data-scroll-target="#extract"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.6</strong></span> <strong>Extract</strong></a></li>
  <li><a href="#connect" id="toc-connect" class="nav-link" data-scroll-target="#connect"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.7</strong></span> <strong>Connect</strong></a></li>
  <li><a href="#find" id="toc-find" class="nav-link" data-scroll-target="#find"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.8</strong></span> <strong>Find</strong></a></li>
  <li><a href="#replace" id="toc-replace" class="nav-link" data-scroll-target="#replace"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.9</strong></span> <strong>Replace</strong></a></li>
  <li><a href="#regular-expression" id="toc-regular-expression" class="nav-link" data-scroll-target="#regular-expression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.10</strong></span> <strong><span style="color:orange">Regular expression</span></strong></a></li>
  </ul></li>
  <li><a href="#time-data-in-r" id="toc-time-data-in-r" class="nav-link" data-scroll-target="#time-data-in-r"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3</strong></span> <strong>Time data in R</strong></a>
  <ul class="collapse">
  <li><a href="#format-of-time" id="toc-format-of-time" class="nav-link" data-scroll-target="#format-of-time"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.1</strong></span> <strong>Format of time</strong></a></li>
  <li><a href="#numeric-of-date" id="toc-numeric-of-date" class="nav-link" data-scroll-target="#numeric-of-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2</strong></span> <strong>Numeric of date</strong></a>
  <ul class="collapse">
  <li><a href="#time-format-codes" id="toc-time-format-codes" class="nav-link" data-scroll-target="#time-format-codes"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2.1</strong></span> <strong>Time format codes</strong></a></li>
  </ul></li>
  <li><a href="#calculating-date" id="toc-calculating-date" class="nav-link" data-scroll-target="#calculating-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.3</strong></span> <strong>Calculating date</strong></a></li>
  <li><a href="#set-time-zone-calculation" id="toc-set-time-zone-calculation" class="nav-link" data-scroll-target="#set-time-zone-calculation"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.4</strong></span> <strong>Set time zone &amp; calculation</strong></a></li>
  </ul></li>
  <li><a href="#latex" id="toc-latex" class="nav-link" data-scroll-target="#latex"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4</strong></span> <strong><span style="color:orange">LaTeX</span></strong></a>
  <ul class="collapse">
  <li><a href="#fundamental-1" id="toc-fundamental-1" class="nav-link" data-scroll-target="#fundamental-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.1</strong></span> <strong>Fundamental</strong></a></li>
  <li><a href="#advanced-1" id="toc-advanced-1" class="nav-link" data-scroll-target="#advanced-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.2</strong></span> <strong>Advanced</strong></a></li>
  </ul></li>
  <li><a href="#r-graph-advanced" id="toc-r-graph-advanced" class="nav-link" data-scroll-target="#r-graph-advanced"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5</strong></span> <strong>R graph (advanced)</strong></a>
  <ul class="collapse">
  <li><a href="#different-theme-of-plot" id="toc-different-theme-of-plot" class="nav-link" data-scroll-target="#different-theme-of-plot"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.1</strong></span> <strong>Different theme of plot</strong></a></li>
  <li><a href="#math-formulas-with-r" id="toc-math-formulas-with-r" class="nav-link" data-scroll-target="#math-formulas-with-r"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.2</strong></span> <strong>Math formulas with R</strong></a></li>
  <li><a href="#size-and-layout" id="toc-size-and-layout" class="nav-link" data-scroll-target="#size-and-layout"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.3</strong></span> <strong>Size and layout</strong></a></li>
  </ul></li>
  <li><a href="#r-tidyverse" id="toc-r-tidyverse" class="nav-link" data-scroll-target="#r-tidyverse"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6</strong></span> <strong>R Tidyverse</strong></a>
  <ul class="collapse">
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.1</strong></span> <strong>Workflow</strong></a></li>
  <li><a href="#fundamental-operations" id="toc-fundamental-operations" class="nav-link" data-scroll-target="#fundamental-operations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.2</strong></span> <strong>Fundamental operations</strong></a></li>
  <li><a href="#pipe-operator" id="toc-pipe-operator" class="nav-link" data-scroll-target="#pipe-operator"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.3</strong></span> <strong>Pipe operator</strong></a></li>
  <li><a href="#mutiply-work-by-using-tidyverse-pipe" id="toc-mutiply-work-by-using-tidyverse-pipe" class="nav-link" data-scroll-target="#mutiply-work-by-using-tidyverse-pipe"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4</strong></span> <strong>Mutiply work by using tidyverse pipe</strong></a>
  <ul class="collapse">
  <li><a href="#graph-work" id="toc-graph-work" class="nav-link" data-scroll-target="#graph-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.1</strong></span> <strong>Graph work</strong></a></li>
  <li><a href="#statistic-work" id="toc-statistic-work" class="nav-link" data-scroll-target="#statistic-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.2</strong></span> <strong>Statistic work</strong></a></li>
  </ul></li>
  <li><a href="#tidy-the-dataset" id="toc-tidy-the-dataset" class="nav-link" data-scroll-target="#tidy-the-dataset"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.5</strong></span> <strong>Tidy the dataset</strong></a></li>
  <li><a href="#conversions-the-dataframe-type" id="toc-conversions-the-dataframe-type" class="nav-link" data-scroll-target="#conversions-the-dataframe-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.6</strong></span> <strong>Conversions the dataframe type</strong></a></li>
  <li><a href="#find-missing-observations" id="toc-find-missing-observations" class="nav-link" data-scroll-target="#find-missing-observations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.7</strong></span> <strong>Find missing observations</strong></a></li>
  </ul></li>
  <li><a href="#anova-post-hoc-tests" id="toc-anova-post-hoc-tests" class="nav-link" data-scroll-target="#anova-post-hoc-tests"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7</strong></span> <strong>ANOVA (Post-hoc tests)</strong></a>
  <ul class="collapse">
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.1</strong></span> <strong>Post-hoc tests</strong></a></li>
  <li><a href="#fishers-least-significant-difference-lsd-test" id="toc-fishers-least-significant-difference-lsd-test" class="nav-link" data-scroll-target="#fishers-least-significant-difference-lsd-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2</strong></span> <strong>Fisher’s Least Significant Difference (LSD) Test</strong></a>
  <ul class="collapse">
  <li><a href="#concept" id="toc-concept" class="nav-link" data-scroll-target="#concept"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.1</strong></span> <strong>Concept</strong></a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.2</strong></span> <strong>Example</strong></a></li>
  </ul></li>
  <li><a href="#bonferroni-t-test" id="toc-bonferroni-t-test" class="nav-link" data-scroll-target="#bonferroni-t-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3</strong></span> <strong>Bonferroni t-test</strong></a>
  <ul class="collapse">
  <li><a href="#concept-1" id="toc-concept-1" class="nav-link" data-scroll-target="#concept-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.1</strong></span> <strong>Concept</strong></a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.2</strong></span> <strong>Example</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#manova" id="toc-manova" class="nav-link" data-scroll-target="#manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8</strong></span> <strong>MANOVA</strong></a>
  <ul class="collapse">
  <li><a href="#definition-of-manova" id="toc-definition-of-manova" class="nav-link" data-scroll-target="#definition-of-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.1</strong></span> <strong>Definition of MANOVA</strong></a></li>
  <li><a href="#coding-and-visualization" id="toc-coding-and-visualization" class="nav-link" data-scroll-target="#coding-and-visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.2</strong></span> <strong>Coding and visualization</strong></a></li>
  <li><a href="#one-way-manova" id="toc-one-way-manova" class="nav-link" data-scroll-target="#one-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.3</strong></span> <strong>One-way MANOVA</strong></a></li>
  <li><a href="#post-hoc-test" id="toc-post-hoc-test" class="nav-link" data-scroll-target="#post-hoc-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.4</strong></span> <strong>Post-hoc test</strong></a></li>
  <li><a href="#multivariate-normality" id="toc-multivariate-normality" class="nav-link" data-scroll-target="#multivariate-normality"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5</strong></span> <strong>Multivariate normality</strong></a>
  <ul class="collapse">
  <li><a href="#shapiro-wilk-test" id="toc-shapiro-wilk-test" class="nav-link" data-scroll-target="#shapiro-wilk-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.1</strong></span> <strong>Shapiro-Wilk test</strong></a></li>
  <li><a href="#mardias-skewness-and-kurtosis-test" id="toc-mardias-skewness-and-kurtosis-test" class="nav-link" data-scroll-target="#mardias-skewness-and-kurtosis-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.2</strong></span> <strong>Mardia’s skewness and kurtosis test</strong></a></li>
  <li><a href="#homogeneity-of-the-variance-covariance-matrix" id="toc-homogeneity-of-the-variance-covariance-matrix" class="nav-link" data-scroll-target="#homogeneity-of-the-variance-covariance-matrix"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.3</strong></span> <strong>Homogeneity of the variance-covariance matrix</strong></a></li>
  <li><a href="#multivariate-outliers" id="toc-multivariate-outliers" class="nav-link" data-scroll-target="#multivariate-outliers"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.4</strong></span> <strong>Multivariate outliers</strong></a></li>
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.5</strong></span> <strong>Linearity</strong></a></li>
  <li><a href="#multicollinearity" id="toc-multicollinearity" class="nav-link" data-scroll-target="#multicollinearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.6</strong></span> <strong>Multicollinearity</strong></a></li>
  </ul></li>
  <li><a href="#two-way-manova" id="toc-two-way-manova" class="nav-link" data-scroll-target="#two-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.6</strong></span> <strong>Two-way MANOVA</strong></a></li>
  </ul></li>
  <li><a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9</strong></span> <strong>ANCOVA</strong></a>
  <ul class="collapse">
  <li><a href="#definition-of-ancova" id="toc-definition-of-ancova" class="nav-link" data-scroll-target="#definition-of-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.1</strong></span> <strong>Definition of ANCOVA</strong></a></li>
  <li><a href="#one-way-ancova" id="toc-one-way-ancova" class="nav-link" data-scroll-target="#one-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2</strong></span> <strong>One-way ANCOVA</strong></a>
  <ul class="collapse">
  <li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.1</strong></span> <strong>Question</strong></a></li>
  <li><a href="#maximal-model" id="toc-maximal-model" class="nav-link" data-scroll-target="#maximal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.2</strong></span> <strong>Maximal model</strong></a></li>
  <li><a href="#minimal-model" id="toc-minimal-model" class="nav-link" data-scroll-target="#minimal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.3</strong></span> <strong>Minimal model</strong></a></li>
  <li><a href="#one-step" id="toc-one-step" class="nav-link" data-scroll-target="#one-step"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.4</strong></span> <strong>One step</strong></a></li>
  <li><a href="#result" id="toc-result" class="nav-link" data-scroll-target="#result"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.5</strong></span> <strong>Result</strong></a></li>
  </ul></li>
  <li><a href="#two-way-ancova" id="toc-two-way-ancova" class="nav-link" data-scroll-target="#two-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3</strong></span> <strong>Two-way ANCOVA</strong></a>
  <ul class="collapse">
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.1</strong></span> <strong>Question</strong></a></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.2</strong></span> <strong>Model</strong></a></li>
  <li><a href="#one-step-1" id="toc-one-step-1" class="nav-link" data-scroll-target="#one-step-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.3</strong></span> <strong>One step</strong></a></li>
  <li><a href="#result-1" id="toc-result-1" class="nav-link" data-scroll-target="#result-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.4</strong></span> <strong>Result</strong></a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.5</strong></span> <strong>Visualization</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#mancova" id="toc-mancova" class="nav-link" data-scroll-target="#mancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10</strong></span> <strong>MANCOVA</strong></a>
  <ul class="collapse">
  <li><a href="#definition-of-mancova" id="toc-definition-of-mancova" class="nav-link" data-scroll-target="#definition-of-mancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.1</strong></span> <strong>Definition of MANCOVA</strong></a></li>
  <li><a href="#workflow-1" id="toc-workflow-1" class="nav-link" data-scroll-target="#workflow-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2</strong></span> <strong>Workflow</strong></a>
  <ul class="collapse">
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.1</strong></span> <strong>Question</strong></a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.2</strong></span> <strong>Visualization</strong></a></li>
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.3</strong></span> <strong>Model</strong></a></li>
  <li><a href="#result-2" id="toc-result-2" class="nav-link" data-scroll-target="#result-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.4</strong></span> <strong>Result</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#combining-statistics" id="toc-combining-statistics" class="nav-link" data-scroll-target="#combining-statistics"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11</strong></span> <strong>Combining statistics</strong></a>
  <ul class="collapse">
  <li><a href="#combining-means-and-standard-errors" id="toc-combining-means-and-standard-errors" class="nav-link" data-scroll-target="#combining-means-and-standard-errors"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.1</strong></span> <strong>Combining means and standard errors</strong></a></li>
  <li><a href="#mean-and-standard-errors-of-sum-and-difference" id="toc-mean-and-standard-errors-of-sum-and-difference" class="nav-link" data-scroll-target="#mean-and-standard-errors-of-sum-and-difference"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.2</strong></span> <strong>Mean and standard errors of sum and difference</strong></a>
  <ul class="collapse">
  <li><a href="#concepts" id="toc-concepts" class="nav-link" data-scroll-target="#concepts"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.2.1</strong></span> <strong>Concepts</strong></a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.2.2</strong></span> <strong>Example</strong></a></li>
  </ul></li>
  <li><a href="#mean-and-standard-error-of-ratios-and-products" id="toc-mean-and-standard-error-of-ratios-and-products" class="nav-link" data-scroll-target="#mean-and-standard-error-of-ratios-and-products"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.3</strong></span> <strong>Mean and standard error of ratios and products</strong></a>
  <ul class="collapse">
  <li><a href="#concepts-1" id="toc-concepts-1" class="nav-link" data-scroll-target="#concepts-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.3.1</strong></span> <strong>Concepts</strong></a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.3.2</strong></span> <strong>Example</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#non-parametric-hypothesis-tests" id="toc-non-parametric-hypothesis-tests" class="nav-link" data-scroll-target="#non-parametric-hypothesis-tests"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12</strong></span> <strong>Non-parametric hypothesis tests</strong></a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.1</strong></span> <strong>Definition</strong></a></li>
  <li><a href="#wilcoxon-rank-sum-test" id="toc-wilcoxon-rank-sum-test" class="nav-link" data-scroll-target="#wilcoxon-rank-sum-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2</strong></span> <strong>Wilcoxon Rank-Sum test</strong></a>
  <ul class="collapse">
  <li><a href="#concept-2" id="toc-concept-2" class="nav-link" data-scroll-target="#concept-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.1</strong></span> <strong>Concept</strong></a></li>
  <li><a href="#example-1-1" id="toc-example-1-1" class="nav-link" data-scroll-target="#example-1-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.2</strong></span> <strong>Example-1</strong></a></li>
  <li><a href="#workflow-2" id="toc-workflow-2" class="nav-link" data-scroll-target="#workflow-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.3</strong></span> <strong>Workflow</strong></a></li>
  <li><a href="#example-2-1" id="toc-example-2-1" class="nav-link" data-scroll-target="#example-2-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.4</strong></span> <strong>Example-2</strong></a></li>
  </ul></li>
  <li><a href="#wilcoxon-signed-rank-test" id="toc-wilcoxon-signed-rank-test" class="nav-link" data-scroll-target="#wilcoxon-signed-rank-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.3</strong></span> <strong>Wilcoxon Signed-Rank test</strong></a>
  <ul class="collapse">
  <li><a href="#concept-3" id="toc-concept-3" class="nav-link" data-scroll-target="#concept-3"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.3.1</strong></span> <strong>Concept</strong></a></li>
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.3.2</strong></span> <strong>Example</strong></a></li>
  </ul></li>
  <li><a href="#kruskal-wallis-test" id="toc-kruskal-wallis-test" class="nav-link" data-scroll-target="#kruskal-wallis-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.4</strong></span> <strong>Kruskal-Wallis test</strong></a>
  <ul class="collapse">
  <li><a href="#concept-4" id="toc-concept-4" class="nav-link" data-scroll-target="#concept-4"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.4.1</strong></span> <strong>Concept</strong></a></li>
  <li><a href="#example-5" id="toc-example-5" class="nav-link" data-scroll-target="#example-5"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.4.2</strong></span> <strong>Example</strong></a></li>
  </ul></li>
  <li><a href="#friedmans-test" id="toc-friedmans-test" class="nav-link" data-scroll-target="#friedmans-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.5</strong></span> <strong>Friedman’s test</strong></a>
  <ul class="collapse">
  <li><a href="#concept-5" id="toc-concept-5" class="nav-link" data-scroll-target="#concept-5"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.5.1</strong></span> <strong>Concept</strong></a></li>
  <li><a href="#example-6" id="toc-example-6" class="nav-link" data-scroll-target="#example-6"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.5.2</strong></span> <strong>Example</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13</strong></span> <strong>Multiple linear regression</strong></a>
  <ul class="collapse">
  <li><a href="#definition-1" id="toc-definition-1" class="nav-link" data-scroll-target="#definition-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.1</strong></span> <strong>Definition</strong></a></li>
  <li><a href="#visualization-2" id="toc-visualization-2" class="nav-link" data-scroll-target="#visualization-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.2</strong></span> <strong>Visualization</strong></a></li>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3</strong></span> <strong>Fit the model</strong></a>
  <ul class="collapse">
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3.1</strong></span> <strong>Analysis</strong></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3.2</strong></span> <strong>Conclusion</strong></a></li>
  <li><a href="#the-difference-between-r2-and-adj-r2" id="toc-the-difference-between-r2-and-adj-r2" class="nav-link" data-scroll-target="#the-difference-between-r2-and-adj-r2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3.3</strong></span> <strong>The difference between <span class="math inline">\(R^2\)</span> and Adj-<span class="math inline">\(R^2\)</span></strong></a></li>
  </ul></li>
  <li><a href="#evaluate-improve-the-model" id="toc-evaluate-improve-the-model" class="nav-link" data-scroll-target="#evaluate-improve-the-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4</strong></span> <strong>Evaluate &amp; improve the model</strong></a>
  <ul class="collapse">
  <li><a href="#issue" id="toc-issue" class="nav-link" data-scroll-target="#issue"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4.1</strong></span> <strong>Issue</strong></a></li>
  <li><a href="#variance-inflation-factor-vif" id="toc-variance-inflation-factor-vif" class="nav-link" data-scroll-target="#variance-inflation-factor-vif"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4.2</strong></span> <strong>Variance inflation factor (VIF)</strong></a></li>
  <li><a href="#eigen-system-analysis" id="toc-eigen-system-analysis" class="nav-link" data-scroll-target="#eigen-system-analysis"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4.3</strong></span> <strong>Eigen System Analysis</strong></a></li>
  </ul></li>
  <li><a href="#simply-the-model" id="toc-simply-the-model" class="nav-link" data-scroll-target="#simply-the-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5</strong></span> <strong>Simply the model</strong></a>
  <ul class="collapse">
  <li><a href="#backward-selection" id="toc-backward-selection" class="nav-link" data-scroll-target="#backward-selection"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.1</strong></span> <strong>Backward selection</strong></a></li>
  <li><a href="#forward-selection" id="toc-forward-selection" class="nav-link" data-scroll-target="#forward-selection"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.2</strong></span> <strong>Forward selection</strong></a></li>
  <li><a href="#aic-selection" id="toc-aic-selection" class="nav-link" data-scroll-target="#aic-selection"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.3</strong></span> <strong>AIC selection</strong></a></li>
  <li><a href="#result-3" id="toc-result-3" class="nav-link" data-scroll-target="#result-3"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.4</strong></span> <strong>Result</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>14</strong></span> <strong>Logistic regression</strong></a></li>
  <li><a href="#poisson-regression" id="toc-poisson-regression" class="nav-link" data-scroll-target="#poisson-regression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>15</strong></span> <strong>Poisson regression</strong></a></li>
  <li><a href="#non-linear-regression" id="toc-non-linear-regression" class="nav-link" data-scroll-target="#non-linear-regression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>16</strong></span> <strong>Non-linear regression</strong></a></li>
  <li><a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link" data-scroll-target="#principal-component-analysis"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>17</strong></span> <strong>Principal component analysis</strong></a></li>
  <li><a href="#cluster-analysis" id="toc-cluster-analysis" class="nav-link" data-scroll-target="#cluster-analysis"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>18</strong></span> <strong>Cluster analysis</strong></a></li>
  <li><a href="#sessioninfo" id="toc-sessioninfo" class="nav-link" data-scroll-target="#sessioninfo"><strong><span style="color:green">SessionInfo:</span></strong></a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>ENV222 NOTE</strong></h1>
<p class="subtitle lead"><em>R in statistics (Advanced)</em></p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>TC-tea </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023.04.18</p>
    </div>
  </div>
  
    
  </div>
  

</header>


<!-- Set viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Set styles for light and dark mode -->
<style>
    mark {
      background-color: yellow;
    }
    .dark-mode {
      background-color: black;
      color: white;
    }
    .light-code {
      color: black;
    }
    .dark-code {
      color: white;
    }
    .quarto-output pre:not([class*="language-"]) {
      background-color: transparent;
      color: inherit;
    }
    .quarto-output pre[class*="language-"] {
      background-color: #F5F5F5;
      color: black;
    }
    .dark-mode .quarto-output pre[class*="language-"] {
      background-color: #2B2B2B;
      color: white;
    }
    /* CSS for back-to-top button */
    #back-to-top {
      position: fixed;
      bottom: 10px;
      right: 22px;
      font-size: 22px;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      text-decoration: none;
    }
    /* CSS for light/dark mode toggle button */
    #myBtn {
      position: fixed;
      top: 20px;
      left: 20px;
      border: none;
      border-radius: 10px;
      padding: 8px;
      background-color: lightgray;
    }
    #myBtn:before {
      content: "☀";
    }
    .dark-mode #myBtn:before {
      content: "🌙";
    }
  </style>


<!-- Button to toggle light/dark mode -->
<button id="myBtn" onclick="myFunction()">
</button>
<script>
    function myFunction() {
      var element = document.body;
      element.classList.toggle("dark-mode");
      var codeBlocks = document.querySelectorAll(".quarto-output pre[class*='language-']");
      codeBlocks.forEach(function(block) {
        block.classList.toggle("light-code");
        block.classList.toggle("dark-code");
      });
    }
  </script>
<!-- Button to scroll back to top of page -->
<a href="#" id="back-to-top" title="Back to top">🚀</a>

<details>
<summary>
Hyperlink of XJTLU ENV222 courseware
</summary>
<ul>
<li><a href="https://pzhao.org/openr/ENV222-Overview.html">Lecture1 ENV222 Overview</a><br></li>
<li><a href="https://pzhao.org/openr/R-markdown-basic.html">Lecture2 R Markdown basic</a><br></li>
<li><a href="https://pzhao.org/openr/R-markdown-advanced.html">Lecture3 R Markdown advanced</a><br></li>
<li><a href="https://pzhao.org/openr/R-characters.html">Lecture4 R for characters</a><br></li>
<li><a href="https://pzhao.org/openr/R-time.html">Lecture5 R for time data</a><br></li>
<li><a href="https://pzhao.org/openr/R-graphs-advanced.html">Lecture6 Statistical graphs (advanced)</a><br></li>
<li><a href="https://pzhao.org/openr/R-Tidyverse.html">Lecture7 R Tidyverse</a><br></li>
<li><a href="https://pzhao.org/openr/ANOVA-post-hoc.html">Lecture8 ANOVA Post-hoc tests</a><br></li>
<li><a href="https://pzhao.org/openr/MANOVA.html">Lecture9 MANOVA</a><br></li>
<li><a href="https://pzhao.org/openr/ANCOVA.html">Lecture10 ANCOVA</a><br></li>
<li><a href="https://pzhao.org/openr/MANCOVA.html">Lecture11 MANCOVA</a><br></li>
<li><a href="https://pzhao.org/openr/Combining-statistics.html">Lecture12 Combining statistics</a><br></li>
<li><a href="https://pzhao.org/openr/Non-parametric-hypothesis-tests.html">Lecture13 Non-parametric hypothesis tests</a><br></li>
<li><a href="https://pzhao.org/openr/Multiple-linear-regression.html">Lecture14 Multiple linear regression</a><br></li>
<li><a href="https://pzhao.org/openr/Logistic-regression.html">Lecture15 Logistic regression</a><br></li>
<li><a href="https://pzhao.org/openr/Poisson-regression.html">Lecture16 Poisson regression</a><br></li>
<li><a href="https://pzhao.org/openr/Non-linear-regression.html">Lecture17 Non-linear regression</a><br></li>
<li><a href="https://pzhao.org/openr/Principal-component-analysis.html">Lecture18 Principal component analysis</a><br></li>
<li><a href="https://pzhao.org/openr/Cluster-analysis.html">Lecture19 Cluster analysis</a><br></li>
</ul>
</details>
<details>
<summary>
The meaning of each parameter in statistical table (Chinese)
</summary>
<ul>
<li>Df（自由度）: 回归自由度（regression degrees of freedom）和误差自由度（error degrees of freedom）的总数，其中回归自由度为解释变量的个数减1，误差自由度为样本量减去解释变量的个数。</li>
<li>Sum Sq（平方和）: 每个来源的平方和（sum of squares），是变量离均差的平方和。回归平方和（regression sum of squares）表示自变量对因变量的影响程度，误差平方和（error sum of squares）表示自变量未能解释的部分。</li>
<li>Mean Sq（均方）: 每个来源的均方（mean square），是平方和除以自由度得到的平均数。回归均方（regression mean square）表示每个自变量对因变量的影响程度，误差均方（error mean square）表示自变量未能解释的部分的平均方差。</li>
<li>F value: 回归均方与误差均方的比值，用于判断模型的拟合程度，F值越大则模型越好。在一元线性回归中，F值等于t值的平方。</li>
<li>Pr(&gt;F): Probability of obtaining a larger F value（得到更大的F值的概率）Pr(&gt;F)是F检验得到的P值。p值越小则说明结果越显著，一般将显著性水平设为0.05，即当p值小于0.05时认为结果具有统计显著性。</li>
<li>Pillai: Pillai trace（皮莱迹）是在多元方差分析中使用的一种统计量，用于衡量所有因素对因变量的共同影响程度。</li>
<li>approx F: F approximation（F近似值）是根据Pillai迹值计算出来的F值。它用于评估多元方差分析的总体显著性。</li>
<li>num Df: Numerator degrees of freedom（分子自由度）指的是分子中的自由度。</li>
<li>den Df: Denominator degrees of freedom（分母自由度）指的是分母中的自由度。</li>
<li>Residuals: 残差，是指多元方差分析中的误差项，即不能被自变量解释的因变量方差。</li>
<li>Intercept: 截距，也称为常数项，表示当自变量为0时，因变量的预测值（或期望值）。</li>
<li>Estimate: 回归系数，表示自变量每增加一个单位时，因变量发生的平均变化量。</li>
<li>Std.Error: 标准误差，表示估计值的不确定性或误差，即估计值与真实值之间的平均差异。</li>
<li>t value: t值，表示回归系数的显著性，即回归系数除以其标准误差，得到的值与t分布相比较的结果。</li>
</ul>
</details>
<details>
<summary>
How to choose between ANOVA, MANOVA, ANCOVA and MANCOVA (Chinese)
</summary>
<p>ANOVA、MANOVA、ANCOVA和MANCOVA都是统计学中常见的分析方法，主要用于比较两个或多个组之间的差异性，并用统计学方法对这些差异进行推断和验证。</p>
<ul>
<li>ANOVA（Analysis of Variance）：方差分析，用于比较两个或多个组的均值是否有显著差异，适用于只有一个自变量和一个因变量的情况。例如，用于比较不同教学方法对学生成绩的影响是否有显著差异。</li>
<li>MANOVA（Multivariate Analysis of Variance）：多元方差分析，用于比较两个或多个组的多个相关因变量是否有显著差异，适用于有多个相关因变量的情况。例如，用于比较不同教学方法对学生成绩、学生态度和学生动机等多个方面的影响是否有显著差异。</li>
<li>ANCOVA（Analysis of Covariance）：协方差分析，用于比较两个或多个组的均值是否有显著差异，并控制一个或多个协变量（即影响因素），适用于需要控制其他因素影响的情况。例如，用于比较不同教学方法对学生成绩的影响是否有显著差异，同时控制学生的初始水平，避免学生初始水平的不同对比较结果产生影响。</li>
<li>MANCOVA（Multivariate Analysis of Covariance）：多元协方差分析，同时控制多个协变量，比较两个或多个组的多个相关因变量是否有显著差异，适用于有多个相关因变量和多个协变量的情况。例如，用于比较不同教学方法对学生成绩、学生态度和学生动机等多个方面的影响是否有显著差异，同时控制学生的初始水平、性别、年龄等因素的影响。</li>
</ul>
</details>
<p>👉🏻<a href="../ENV222%20exercise/ENV222%20exercise.html">Click to enter the ENV222 exercise section</a><br> 👉🏻<a href="../ENV221%20note/ENV221%20note.html">Click to enter the ENV221 note section</a></p>
<section id="r-markdownhtml-syntax" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1</strong></span> <strong>R-markdown</strong><span style="font-size: 15px;"><sub>(HTML)</sub></span> <strong>syntax</strong></h1>
<section id="fundamental" class="level2">
<h2 class="anchored" data-anchor-id="fundamental"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.1</strong></span> <strong>Fundamental</strong></h2>
<ul>
<li><p>Subscript by Rmarkdown: Use <code>PM~2.5~</code> to form PM<sub>2.5</sub>. <br>Subscript by html: <code>log&lt;sub&gt;2&lt;/sub&gt;</code> will be displayed as log<sub>2</sub>.<br></p></li>
<li><p>Superscript by Rmarkdown: Use <code>R^2^</code> to form R<sup>2</sup>. <br>Superscript by html: <code>2&lt;sup&gt;n&lt;/sup&gt;</code> will be displayed as 2<sup>n</sup>.<br></p></li>
<li><p>Use <code>$E = mc^2$</code> to form <span class="math inline">\(E = mc^2\)</span><br></p></li>
<li><p>Use <code>[Link of XJTLU](http://xjtlu.edu.cn)</code> to form <a href="https://www.xjtlu.edu.cn/en/">Link of XJTLU</a><br></p></li>
<li><p>Use <code>&lt;mark&gt;text&lt;/mark&gt;</code> to highlight the <mark>text</mark></p></li>
<li><p>Use <code>&lt;u&gt;text&lt;/u&gt;</code> to add underline to the <u>text</u></p></li>
<li><p>Use <code>&lt;center&gt;&lt;img src="images/rstudio-qmd-how-it-works.png" width="1400" height="257"/&gt;</code> or <code>&lt;center&gt; ![rstudio qmd how it works](images/rstudio-qmd-how-it-works.png){width=100%}</code> to form<br></p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/rstudio-qmd-how-it-works.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Rstudio qmd how it works</figcaption><p></p>
</figure>
</div>
</center>
<p><br></p></li>
<li><p>Use <code>&lt;iframe src="https://www.r-project.org/" width="100%" height="300px"&gt;&lt;/iframe&gt;</code> to form a windows which show another file on-line, like this:<iframe src="https://www.r-project.org/" width="100%" height="300px"></iframe></p></li>
<li><p>Use the following HTML code to add a video to your Rmarkdown(HTML):</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;video</span> <span class="er">width</span><span class="ot">=</span><span class="st">"420"</span> <span class="er">controls</span><span class="kw">&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;source</span> <span class="er">src</span><span class="ot">=</span><span class="st">"mov_bbb.mp4"</span> <span class="er">type</span><span class="ot">=</span><span class="st">"video/mp4"</span><span class="kw">&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;source</span> <span class="er">src</span><span class="ot">=</span><span class="st">"mov_bbb.ogg"</span> <span class="er">type</span><span class="ot">=</span><span class="st">"video/ogg"</span><span class="kw">&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> Your browser does not support the video tag.</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/video&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Use something like <code>{r, fig.width = 6, fig.height = 4, fig.align='center'}</code> in front of the code chunk to change the output graphics</p></li>
<li><p>Also, use<code>{r, XXX-Plot, fig.cap="XXX-Plot"}</code> in the front of code chunk to add a caption of this figure</p></li>
<li><p>Use something like<code>&lt;span style="color:red; font-weight:bold; font-size:16px; font-family:Tahoma;"&gt;sentence&lt;/span&gt;</code> to change the properties of text</p></li>
<li><p>Use the following HTML code to add a foldable item to your Rmarkdown(HTML):</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;summary&gt;</span>title<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  content</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
title
</summary>
content
</details>
<ul>
<li>Use<br> <code>| Name | Math | English |</code><br> <code>|:----:|:-----|--------:|</code><br> <code>| Tom  | 93   |     100 |</code><br> <code>| Mary | 60   |      90 |</code><br> to form<br></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Name</th>
<th style="text-align: left;">Math</th>
<th style="text-align: right;">English</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Tom</td>
<td style="text-align: left;">93</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;">Mary</td>
<td style="text-align: left;">60</td>
<td style="text-align: right;">90</td>
</tr>
</tbody>
</table>
<ul>
<li>Or use</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">90</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">English =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">95</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">"Tom"</span>, <span class="st">"Mary"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(df, <span class="at">format =</span> <span class="st">"markdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Math</th>
<th style="text-align: right;">English</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tom</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">85</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mary</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">95</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Use</li>
</ul>
<pre><code>- 1. 
- 2. 
    - 1.
    - 2.
- 3.</code></pre>
<p>to form sub-rank like this below:<br></p>
<ul>
<li><ol type="1">
<li></li>
</ol></li>
<li><ol start="2" type="1">
<li></li>
</ol>
<ul>
<li><ol type="1">
<li></li>
</ol></li>
<li><ol start="2" type="1">
<li></li>
</ol></li>
</ul></li>
<li><ol start="3" type="1">
<li></li>
</ol></li>
</ul>
</section>
<section id="advanced" class="level2">
<h2 class="anchored" data-anchor-id="advanced"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>1.2</strong></span> <strong>Advanced</strong></h2>
<ul>
<li>Numbering, caption, and cross-reference of R-plots in academic paper <a href="https://pzhao.org/openr/R-graphs-advanced.html#numbering-caption-and-cross-reference">Click to see the detail in ENV222 Week5-5.2</a></li>
</ul>
</section>
</section>
<section id="basic-r-charaters" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2</strong></span> <strong>Basic R charaters</strong></h1>
<section id="check-the-data-type" class="level2">
<h2 class="anchored" data-anchor-id="check-the-data-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.1</strong></span> <strong>Check the data type</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">'The world is on the verge of being flipped topsy-turvy.'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/student_names.csv'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm
1   Yuzhou Liu   Bio
2 Penghui Wang   Bio
3     Ziang Li   Eco
4 Youcheng Jin   Bio
5    Yuge Yang   Bio
6  Yutian Song   Eco</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data type</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># length of the dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># length of the sub dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
</section>
<section id="index-to-maximum-and-minimum-values" class="level2">
<h2 class="anchored" data-anchor-id="index-to-maximum-and-minimum-values"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.2</strong></span> <strong>Index to maximum and minimum values</strong></h2>
<ul>
<li>Find the longest name in <span style="color:green"><em>student_names.csv</em></span>, <code>which.max</code> or <code>which.min</code> is used to find the index of the (first) minimum or maximum of a numeric (or logical) vector</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>name_n <span class="ot">&lt;-</span> <span class="fu">nchar</span>(dtf<span class="sc">$</span>Name)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>name_nmax <span class="ot">&lt;-</span> <span class="fu">which.max</span>(name_n)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>Name[name_nmax]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Iyan Hafiz Bin Mohamed Faizel"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>Name[<span class="fu">which.max</span>(<span class="fu">nchar</span>((dtf<span class="sc">$</span>Name)))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Iyan Hafiz Bin Mohamed Faizel"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>Name <span class="sc">%&gt;%</span> <span class="fu">nchar</span>() <span class="sc">%&gt;%</span> <span class="fu">which.max</span>() <span class="sc">%&gt;%</span> dtf<span class="sc">$</span>Name[.]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Iyan Hafiz Bin Mohamed Faizel"</code></pre>
</div>
</div>
</section>
<section id="capital-and-small-letter" class="level2">
<h2 class="anchored" data-anchor-id="capital-and-small-letter"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.3</strong></span> <strong>Capital and small letter</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tolower() toupper()</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>(xupper <span class="ot">&lt;-</span> <span class="fu">toupper</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE WORLD IS ON THE VERGE OF BEING FLIPPED TOPSY-TURVY."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(dtf<span class="sc">$</span>pro <span class="ot">&lt;-</span> <span class="fu">tolower</span>(dtf<span class="sc">$</span>Prgrm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "bio" "bio" "eco" "bio" "bio" "eco" "bio" "bio" "eco" "bio" "eco" "bio"
[13] "bio" "env" "bio" "bio" "bio" "env" "bio" "env" "bio" "bio" "bio" "bio"
[25] "eco" "eco" "env" "bio" "bio" "bio" "bio" "env" "bio" "bio" "bio" "bio"
[37] "bio" "eco" "eco" "bio" "bio" "bio" "bio" "bio" "bio" "bio" "bio" "eco"
[49] "bio" "bio" "env" "eco" "eco" "bio" "env" "env" "env"</code></pre>
</div>
</div>
</section>
<section id="split-string" class="level2">
<h2 class="anchored" data-anchor-id="split-string"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.4</strong></span> <strong>Split string</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># strsplit()</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>x_word <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(xupper, <span class="st">' '</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x_word)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to extract the first element in the list, you need to use double brackets [[]], and if you want to extract the first sublist in the list, use single brackets []</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>x_word1 <span class="ot">&lt;-</span> x_word[[<span class="dv">1</span>]]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x_word1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x_word1)  <span class="co"># Form a table which involved the frequency of each char acter</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x_word1
       BEING      FLIPPED           IS           OF           ON          THE 
           1            1            1            1            1            2 
TOPSY-TURVY.        VERGE        WORLD 
           1            1            1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>x_word1[<span class="sc">!</span><span class="fu">duplicated</span>(x_word1)]  <span class="co"># Find the distinct characters in the list by use duplicated() function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE"          "WORLD"        "IS"           "ON"           "VERGE"       
[6] "OF"           "BEING"        "FLIPPED"      "TOPSY-TURVY."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(x_word1)  <span class="co"># Other way yo detect the distinct characters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THE"          "WORLD"        "IS"           "ON"           "VERGE"       
[6] "OF"           "BEING"        "FLIPPED"      "TOPSY-TURVY."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x_word, length)  <span class="co"># The output of the lapply() function is a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x_word, length)  <span class="co"># The output of the sapply() function is a vector or a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x_word, nchar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]
 [1,]    3
 [2,]    5
 [3,]    2
 [4,]    2
 [5,]    3
 [6,]    5
 [7,]    2
 [8,]    5
 [9,]    7
[10,]   12</code></pre>
</div>
</div>
</section>
<section id="separate-column" class="level2">
<h2 class="anchored" data-anchor-id="separate-column"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.5</strong></span> <strong>Separate column</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate() is a function in the tidyr package that can be used to split a column in a data box into multiple columns</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>dtf2 <span class="ot">&lt;-</span> <span class="fu">separate</span>(dtf, Name, <span class="fu">c</span>(<span class="st">"GivenName"</span>, <span class="st">"LastName"</span>), <span class="at">sep =</span> <span class="st">' '</span>)  <span class="co"># separate(data, col, into, sep)</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>FamilyName <span class="ot">&lt;-</span> dtf2<span class="sc">$</span>LastName</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm pro FamilyName
1   Yuzhou Liu   Bio bio        Liu
2 Penghui Wang   Bio bio       Wang
3     Ziang Li   Eco eco         Li
4 Youcheng Jin   Bio bio        Jin
5    Yuge Yang   Bio bio       Yang
6  Yutian Song   Eco eco       Song</code></pre>
</div>
</div>
</section>
<section id="extract" class="level2">
<h2 class="anchored" data-anchor-id="extract"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.6</strong></span> <strong>Extract</strong></h2>
<p>The world is <span style="color:red">on</span> the verge of being flipped topsy-turvy.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># substr() is a built-in function in R that can be used to extract or replace substrings from a character vector</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(x, <span class="dv">13</span>, <span class="dv">15</span>)  <span class="co"># substr(x, start, stop)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] " on"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>NameAbb <span class="ot">&lt;-</span> <span class="fu">substr</span>(dtf<span class="sc">$</span>Name, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm pro FamilyName NameAbb
1   Yuzhou Liu   Bio bio        Liu       Y
2 Penghui Wang   Bio bio       Wang       P
3     Ziang Li   Eco eco         Li       Z</code></pre>
</div>
</div>
</section>
<section id="connect" class="level2">
<h2 class="anchored" data-anchor-id="connect"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.7</strong></span> <strong>Connect</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste() function can convert multiple objects into character vectors and concatenate them</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(x, <span class="st">'&lt;end&gt;'</span>, <span class="at">sep =</span> <span class="st">' '</span>)  <span class="co"># paste(x1, x2,... sep, collapse)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The world is on the verge of being flipped topsy-turvy. &lt;end&gt;"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(dtf<span class="sc">$</span>NameAbb, <span class="st">'.'</span>, <span class="at">sep =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Y." "P." "Z." "Y." "Y." "Y." "H." "A." "E." "J." "Y." "M." "Y." "Y." "X."
[16] "Z." "W." "J." "Q." "Y." "F." "Y." "Z." "M." "Z." "S." "X." "J." "R." "Z."
[31] "Y." "X." "Z." "Y." "Q." "Y." "Y." "M." "Q." "J." "Y." "X." "M." "Q." "Y."
[46] "P." "Y." "J." "L." "Y." "Q." "H." "Z." "H." "J." "Y." "I."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(dtf<span class="sc">$</span>NameAbb, <span class="at">collapse =</span> <span class="st">' '</span>)  <span class="co"># collapse = ' ' put all of the characters into a character</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Y P Z Y Y Y H A E J Y M Y Y X Z W J Q Y F Y Z M Z S X J R Z Y X Z Y Q Y Y M Q J Y X M Q Y P Y J L Y Q H Z H J Y I"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(dtf<span class="sc">$</span>NameAbb, dtf<span class="sc">$</span>FamilyName, <span class="at">sep =</span> <span class="st">'. '</span>)[<span class="dv">7</span>]  <span class="co"># This is my name for academic essay cite</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "H. Zhu"</code></pre>
</div>
</div>
</section>
<section id="find" class="level2">
<h2 class="anchored" data-anchor-id="find"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.8</strong></span> <strong>Find</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grep() function in R is a built-in function that searches for a pattern match in each element of character </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"R"</span>, <span class="st">"Python"</span>, <span class="st">"Java"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">"Java"</span>, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y)) {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">grep</span>(<span class="fu">as.character</span>(y[i]), y))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 2
[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(y, <span class="cf">function</span>(x) <span class="fu">grep</span>(x, y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     R Python   Java 
     1      2      3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">table</span>(dtf2<span class="sc">$</span>GivenName), <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Adriel        Elina       Fengyi        Haode       Hongli Huangtianchi 
           1            1            1            1            1            1 
        Iyan       Jiajie       Jiawei        Jiayi      Jingyun       Jiumei 
           1            1            1            2            1            1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">'Jiayi'</span>, dtf<span class="sc">$</span>Name, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jiayi Chen" "Jiayi Guo" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">'Jiayi|Guo'</span>, dtf<span class="sc">$</span>Name, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Jiayi Chen" "Fengyi Guo" "Jiayi Guo" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># regexpr() function is used to identify the position of the pattern in the character vector, where each element is searched separately.</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"R is fun"</span>, <span class="st">"R is cool"</span>, <span class="st">"R is awesome"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">regexpr</span>(<span class="st">"is"</span>, z)  <span class="co"># Returns include starting position, duration length, data type ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 3 3
attr(,"match.length")
[1] 2 2 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gregexpr</span>(<span class="st">"is"</span>, z)  <span class="co"># The gregexpr() function returns all matching positions and lengths, as a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 3
attr(,"match.length")
[1] 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE

[[2]]
[1] 3
attr(,"match.length")
[1] 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE

[[3]]
[1] 3
attr(,"match.length")
[1] 2
attr(,"index.type")
[1] "chars"
attr(,"useBytes")
[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="replace" class="level2">
<h2 class="anchored" data-anchor-id="replace"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.9</strong></span> <strong>Replace</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gsub()</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsub</span>(<span class="st">' '</span>, <span class="st">'-'</span>, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The-world-is-on-the-verge-of-being-flipped-topsy-turvy."</code></pre>
</div>
</div>
</section>
<section id="regular-expression" class="level2">
<h2 class="anchored" data-anchor-id="regular-expression"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>2.10</strong></span> <strong><span style="color:orange">Regular expression</span></strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># help(regex)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the one who has a given name with 4 letters and a family name with 4 letters</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">'^[[:alpha:]]{4} [[:alpha:]]{4}$'</span>, dtf<span class="sc">$</span>Name, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yuge Yang" "Ziyu Yuan" "Qian Chen" "Ying Zhou"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, parentheses are used to create a capturing group. A capturing group is a subexpression of a regular expression that can capture and store the matched text during matching. </span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In this example, the capturing group is used to extract the first word from the string. Without a capturing group, the entire matched string would be replaced with \\1 instead of just the first word.</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>FirstName <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'^([^ ]+).+[^ ]+$'</span>, <span class="st">'</span><span class="sc">\\</span><span class="st">1'</span>, dtf<span class="sc">$</span>Name)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Name Prgrm pro FamilyName NameAbb FirstName
1   Yuzhou Liu   Bio bio        Liu       Y    Yuzhou
2 Penghui Wang   Bio bio       Wang       P   Penghui
3     Ziang Li   Eco eco         Li       Z     Ziang
4 Youcheng Jin   Bio bio        Jin       Y  Youcheng
5    Yuge Yang   Bio bio       Yang       Y      Yuge
6  Yutian Song   Eco eco       Song       Y    Yutian</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Rmarkdown 中正则表达式的基本语法如下：</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  . 匹配任意单个字符，除了换行符。</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  [ ] 匹配方括号内的任意一个字符，例如 [abc] 匹配 a 或 b 或 c。</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  [<span class="sc">^</span> ] 匹配方括号外的任意一个字符，例如 [<span class="sc">^</span>abc] 匹配除了 a 和 b 和 c 之外的任意字符。</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span> 在方括号内表示范围，例如 [a<span class="sc">-</span>z] 匹配小写字母， [<span class="dv">0-9</span>] 匹配数字。</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  \d \D \w \W \s \S 分别匹配数字、非数字、单词字符（字母、数字和下划线）、非单词字符、空白符（空格、制表符和换行符）、非空白符。</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  \b \B <span class="sc">^</span> <span class="er">$</span> \ 分别匹配单词边界（单词和非单词之间）、非单词边界（两个单词或两个非单词之间）、字符串开头、字符串结尾、转义符（用于匹配元字符本身）。</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  ( ) <span class="sc">|</span> ? <span class="sc">+</span> <span class="er">*</span> { } \ 分别匹配分组或捕获子表达式（可以用反斜杠加数字引用），选择（匹配左边或右边），零次或一次重复，一次或多次重复，零次或多次重复，指定重复次数，零宽断言（匹配位置而不是字符）。</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>简单的例子，查找 Markdown 链接（[This is a link](https<span class="sc">:</span><span class="er">//</span>www.example.com)）：</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>\[([<span class="sc">^</span>\]]<span class="sc">+</span>)\]\(([<span class="sc">^</span>)]<span class="sc">+</span>)\<span class="er">)</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>这个正则表达式可以分解为以下部分：</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  \[ 匹配左方括号</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  ([<span class="sc">^</span>\]]<span class="sc">+</span>) 匹配并捕获一个或多个不是右方括号的字符</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  \] 匹配右方括号</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  \( 匹配左圆括号</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  ([<span class="sc">^</span>)]<span class="sc">+</span>) 匹配并捕获一个或多个不是右圆括号的字符</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  \<span class="er">)</span> 匹配右圆括号</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="time-data-in-r" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3</strong></span> <strong>Time data in R</strong></h1>
<section id="format-of-time" class="level2">
<h2 class="anchored" data-anchor-id="format-of-time"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.1</strong></span> <strong>Format of time</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the current date</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tue Apr 18 14:04:28 2023"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># character</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="st">"2/11/1962"</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Date/Time format, we can just directly use like "d2 + 1" to add 1 day to d2</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check their type</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">list</span>(<span class="fu">class</span>(d1), <span class="fu">class</span>(d2), <span class="fu">class</span>(t2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]        [,2]   [,3]       
[1,] "character" "Date" character,2</code></pre>
</div>
</div>
</section>
<section id="numeric-of-date" class="level2">
<h2 class="anchored" data-anchor-id="numeric-of-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2</strong></span> <strong>Numeric of date</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use format="" to identify the character to date</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2/11/1962"</span>, <span class="at">format=</span><span class="st">"%d/%m/%Y"</span> )</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2617</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">+</span> <span class="dv">2617</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1970-01-01"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(d3, <span class="st">'%Y %m %d'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1962 11 02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(d3, <span class="st">"%Y %B %d %A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1962 十一月 02 星期五"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Different format will have different meaning</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>( <span class="st">"2/11/1962"</span>, <span class="at">format=</span><span class="st">"%m/%d/%Y"</span> )</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>d3 <span class="sc">==</span> d4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<section id="time-format-codes" class="level3">
<h3 class="anchored" data-anchor-id="time-format-codes"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.2.1</strong></span> <strong>Time format codes</strong></h3>
<p><code>%Y</code>: Four-digit year<br> <code>%y</code>: Two-digit year<br> <code>%m</code>: Two-digit month (01~12)<br> <code>%d</code>: Two-digit day of the month (01~31)<br> <code>%H</code>: Hour in 24-hour format (00~23)<br> <code>%M</code>: Two-digit minute (00~59)<br> <code>%S</code>: Two-digit second (00~59)<br> <code>%z</code>: Time zone offset, for example +0800<br> <code>%Z</code>: Time zone name, for example CST</p>
</section>
</section>
<section id="calculating-date" class="level2">
<h2 class="anchored" data-anchor-id="calculating-date"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.3</strong></span> <strong>Calculating date</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import built-in data diet (The data concern a subsample of subjects drawn from larger cohort studies of the incidence of coronary heart disease (CHD))</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'Epi'</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"diet"</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   337 obs. of  15 variables:
 $ id        : num  102 59 126 16 247 272 268 206 182 2 ...
 $ doe       : Date, format: "1976-01-17" "1973-07-16" ...
 $ dox       : Date, format: "1986-12-02" "1982-07-05" ...
 $ dob       : Date, format: "1939-03-02" "1912-07-05" ...
 $ y         : num  10.875 8.969 14.01 0.627 11.274 ...
 $ fail      : num  0 0 13 3 13 3 0 0 13 0 ...
 $ job       : Factor w/ 3 levels "Driver","Conductor",..: 1 1 2 1 3 3 3 3 2 1 ...
 $ month     : num  1 7 3 5 3 3 2 1 3 12 ...
 $ energy    : num  22.9 23.9 25 22.2 18.5 ...
 $ height    : num  182 166 152 171 178 ...
 $ weight    : num  88.2 58.7 49.9 89.4 97.1 ...
 $ fat       : num  9.17 9.65 11.25 7.58 9.15 ...
 $ fibre     : num  1.4 0.935 1.248 1.557 0.991 ...
 $ energy.grp: Factor w/ 2 levels "&lt;=2750 KCals",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ chd       : num  0 0 1 1 1 1 0 0 1 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data which we will deal with</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>bdat <span class="ot">&lt;-</span> diet<span class="sc">$</span>dox[<span class="dv">1</span>]</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>bdat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some basic calculation between dates</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>bdat <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-03"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>diet<span class="sc">$</span>dox2 <span class="ot">&lt;-</span> <span class="fu">format</span>(diet<span class="sc">$</span>dox, <span class="at">format=</span><span class="st">"%A %d %B %Y"</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diet<span class="sc">$</span>dox2, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "星期二 02 十二月 1986" "星期一 05 七月 1982"   "星期二 20 三月 1984"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some advanced calculation between dates</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1968-08-29" "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1984-02-20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(diet<span class="sc">$</span>dox)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1986-12-02"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">range</span>(diet<span class="sc">$</span>dox))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 6669 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(<span class="fu">min</span>(diet<span class="sc">$</span>dox), <span class="fu">max</span>(diet<span class="sc">$</span>dox), <span class="at">units =</span> <span class="st">"weeks"</span>)  <span class="co"># Set unit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of -952.7143 weeks</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Epi::cal.yr() function converts the date format to numeric format</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>diet2 <span class="ot">&lt;-</span> Epi<span class="sc">::</span><span class="fu">cal.yr</span>(diet)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(diet2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   337 obs. of  16 variables:
 $ id        : num  102 59 126 16 247 272 268 206 182 2 ...
 $ doe       : 'cal.yr' num  1976 1974 1970 1969 1968 ...
 $ dox       : 'cal.yr' num  1987 1983 1984 1970 1979 ...
 $ dob       : 'cal.yr' num  1939 1913 1920 1907 1919 ...
 $ y         : num  10.875 8.969 14.01 0.627 11.274 ...
 $ fail      : num  0 0 13 3 13 3 0 0 13 0 ...
 $ job       : Factor w/ 3 levels "Driver","Conductor",..: 1 1 2 1 3 3 3 3 2 1 ...
 $ month     : num  1 7 3 5 3 3 2 1 3 12 ...
 $ energy    : num  22.9 23.9 25 22.2 18.5 ...
 $ height    : num  182 166 152 171 178 ...
 $ weight    : num  88.2 58.7 49.9 89.4 97.1 ...
 $ fat       : num  9.17 9.65 11.25 7.58 9.15 ...
 $ fibre     : num  1.4 0.935 1.248 1.557 0.991 ...
 $ energy.grp: Factor w/ 2 levels "&lt;=2750 KCals",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ chd       : num  0 0 1 1 1 1 0 0 1 0 ...
 $ dox2      : chr  "星期二 02 十二月 1986" "星期一 05 七月 1982" "星期二 20 三月 1984" "星期三 31 十二月 1969" ...</code></pre>
</div>
</div>
</section>
<section id="set-time-zone-calculation" class="level2">
<h2 class="anchored" data-anchor-id="set-time-zone-calculation"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>3.4</strong></span> <strong>Set time zone &amp; calculation</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>bd <span class="ot">&lt;-</span> <span class="st">'1994-09-22 20:30:00'</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>bdtime <span class="ot">&lt;-</span> <span class="fu">strptime</span>(<span class="at">x =</span> bd, <span class="at">format =</span> <span class="st">'%Y-%m-%d %H:%M:%S'</span>, <span class="at">tz =</span> <span class="st">"Asia/Shanghai"</span>)  <span class="co"># Set character to time format and add a time zone</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bdtime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "POSIXlt" "POSIXt" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">unclass</span>(bdtime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sec min hour mday mon year wday yday isdst zone  gmtoff
[1,] 0   30  20   22   8   94   4    264  0     "CST" NA    
attr(,"tzone")
[1] "Asia/Shanghai" "CST"           "CDT"          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>bdtime<span class="sc">$</span>wday</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(bdtime, <span class="at">format =</span> <span class="st">'%d.%m.%Y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "22.09.1994"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>bdtime <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1994-09-22 20:30:01 CST"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, some essential calculation</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>bd2 <span class="ot">&lt;-</span> <span class="st">'1995-09-01 7:30:00'</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>bdtime2 <span class="ot">&lt;-</span> <span class="fu">strptime</span>(bd2, <span class="at">format =</span> <span class="st">'%Y-%m-%d %H:%M:%S'</span>, <span class="at">tz =</span> <span class="st">'Asia/Shanghai'</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>bdtime2 <span class="sc">-</span> bdtime</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 343.4583 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(<span class="at">time1 =</span> bdtime2, <span class="at">time2 =</span> bdtime, <span class="at">units =</span> <span class="st">'secs'</span>)  <span class="co"># Set unit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 29674800 secs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(bdtime, bdtime2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1995-03-13 14:00:00 CST"</code></pre>
</div>
</div>
</section>
</section>
<section id="latex" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4</strong></span> <strong><span style="color:orange">LaTeX</span></strong></h1>
<section id="fundamental-1" class="level2">
<h2 class="anchored" data-anchor-id="fundamental-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.1</strong></span> <strong>Fundamental</strong></h2>
<center>
<img src="images/Mathematical Annotation in R.png" width="600" height="579">
</center>
<ul>
<li>Use <code>$$e^{i\pi}+1=0$$</code> to form Euler’s Law expression <span class="math display">\[e^{i\pi}+1=0\]</span></li>
<li><a href="https://blog.csdn.net/ViatorSun/article/details/82826664">Hyperlink of a CN website for more detail about LaTeX</a></li>
</ul>
</section>
<section id="advanced-1" class="level2">
<h2 class="anchored" data-anchor-id="advanced-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>4.2</strong></span> <strong>Advanced</strong></h2>
<ul>
<li>Here are some additional formulas from ENV221 statistic method:<br>
<ol type="1">
<li><span style="color:orange">Z-test</span>:<br> The LaTex expression for Z-test is: <span class="math display">\[Z=\frac{\overline{x}-\mu}{\frac{\sigma}{\sqrt{n}}}\]</span> where <span class="math inline">\(\overline{x}\)</span> is the sample mean, <span class="math inline">\(\mu\)</span> is the population mean, <span class="math inline">\(\sigma\)</span> is the population standard deviation, and <span class="math inline">\(n\)</span> is the sample size.</li>
<li><span style="color:orange">t-test</span>:<br> The LaTex expression for t-test is: <span class="math display">\[t=\frac{\overline{x}-\mu}{\frac{s}{\sqrt{n}}}\]</span> where <span class="math inline">\(\overline{x}\)</span> is the sample mean, <span class="math inline">\(\mu\)</span> is the population mean, <span class="math inline">\(s\)</span> is the sample standard deviation, and <span class="math inline">\(n\)</span> is the sample size.</li>
<li><span style="color:orange">F-test</span>:<br> The LaTex expression for F-test is: <span class="math display">\[F=\frac{s_1^2}{s_2^2}\]</span> where <span class="math inline">\(s_1^2\)</span> is the variance of the first sample and <span class="math inline">\(s_2^2\)</span> is the variance of the second sample.</li>
<li><span style="color:orange">Chi-square test</span>:<br> The LaTex expression for the chi-square test is: <span class="math display">\[\chi2=\sum_{i=1}{n}\frac{(O_i-E_i)^2}{E_i}\]</span> where <span class="math inline">\(O_i\)</span> represents observed values and <span class="math inline">\(E_i\)</span> represents expected values.</li>
</ol></li>
</ul>
</section>
</section>
<section id="r-graph-advanced" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5</strong></span> <strong>R graph (advanced)</strong></h1>
<section id="different-theme-of-plot" class="level2">
<h2 class="anchored" data-anchor-id="different-theme-of-plot"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.1</strong></span> <strong>Different theme of plot</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(CO2) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(conc, uptake)) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(CO2) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(conc, uptake)) <span class="sc">+</span> <span class="fu">theme_test</span>()</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>classic <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(CO2) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(conc, uptake)) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>bw <span class="sc">+</span> test <span class="sc">+</span> classic <span class="sc">+</span> </span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">expression</span>(CO[<span class="dv">2</span>] <span class="sc">*</span> <span class="st">" uptake by plant type plot with different theme"</span>),</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag_levels =</span> <span class="st">"A"</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="math-formulas-with-r" class="level2">
<h2 class="anchored" data-anchor-id="math-formulas-with-r"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.2</strong></span> <strong>Math formulas with R</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CO2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Grouped Data: uptake ~ conc | Plant
  Plant   Type  Treatment conc uptake
1   Qn1 Quebec nonchilled   95   16.0
2   Qn1 Quebec nonchilled  175   30.4
3   Qn1 Quebec nonchilled  250   34.8
4   Qn1 Quebec nonchilled  350   37.2
5   Qn1 Quebec nonchilled  500   35.3
6   Qn1 Quebec nonchilled  675   39.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fundamental expression</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CO2<span class="sc">$</span>conc, CO2<span class="sc">$</span>uptake, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'CO2 concentration'</span>, <span class="at">ylab =</span> <span class="st">'CO2 uptake'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Advanced expression (Use `?plotmath` to check more details of mathematical annotation in R)</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CO2<span class="sc">$</span>conc, CO2<span class="sc">$</span>uptake, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">'CO'</span>[<span class="dv">2</span>] <span class="sc">*</span> <span class="st">' concentration (mL/L)'</span>), </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">'CO'</span>[<span class="dv">2</span>] <span class="sc">*</span> <span class="st">' uptake ('</span> <span class="sc">*</span>mu <span class="sc">*</span> <span class="st">'mol m'</span><span class="sc">^-</span><span class="dv">2</span> <span class="sc">*</span> <span class="st">'s'</span><span class="sc">^-</span><span class="dv">1</span> <span class="sc">*</span> <span class="st">')'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LaTeX expression</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CO2<span class="sc">$</span>conc, CO2<span class="sc">$</span>uptake, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">TeX</span>(<span class="st">'CO$_2$ concentration (mL/L)'</span>), </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">TeX</span>(<span class="st">'CO$_2$ uptake ($</span><span class="sc">\\</span><span class="st">mu$mol m$^{-2}$ s$^{-1}$)'</span>))</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">850</span>, <span class="dv">30</span>, <span class="fu">expression</span>(<span class="fu">prod</span>(<span class="fu">plain</span>(P)(X <span class="sc">==</span> x), x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><a href="https://www.cnblogs.com/kisen/p/12574830.html">Hyperlink of a CN website for more detail about Mathematical Annotation in R</a></li>
</ul>
</section>
<section id="size-and-layout" class="level2">
<h2 class="anchored" data-anchor-id="size-and-layout"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>5.3</strong></span> <strong>Size and layout</strong></h2>
<ul>
<li>ggplot2: patchwork package is used to range the size and layout of multiply plots</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(airquality) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="fu">as.factor</span>(Month), Ozone))</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(airquality) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(Solar.R, Ozone))</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(airquality) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(Ozone))</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># plot_layout() function is used to define the grid layout of the composite graph.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-21-4.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Built-in par() function</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))  <span class="co"># Set the layout by using vector c(x, y)</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><span style="color:red">Built-in layout() function</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a matrix to store the information about layout</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(mymat)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also, customize the exact layout by using some parameters like 'widths=' and 'heights=' by filling vector</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>mymat  <span class="co"># Check the matrix which was used to layout plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    2    4
[2,]    1    3    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(mymat, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(airquality<span class="sc">$</span>Month)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airquality<span class="sc">$</span>Solar.R, airquality<span class="sc">$</span>Ozone)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Solar.R)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is an example from quiz1. Also, please check the exercises to view more difficult questions</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>mymat  <span class="co"># Check the matrix which was used to layout plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    3
[2,]    2    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(mymat, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))  <span class="co"># Set the ratio between widths and heights</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">'Sepal Length (cm)'</span>, <span class="at">ylab=</span><span class="st">'Sepal Width (cm)'</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">horizontal=</span>T)</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Width, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">las=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-23-3.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="r-tidyverse" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6</strong></span> <strong>R Tidyverse</strong></h1>
<section id="workflow" class="level2">
<h2 class="anchored" data-anchor-id="workflow"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.1</strong></span> <strong>Workflow</strong></h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Tidyverse%20workflow.png" class="img-fluid figure-img" style="width:75.0%"></p>
<p></p><figcaption class="figure-caption">Tidyverse workflow</figcaption><p></p>
</figure>
</div>
</center>
</section>
<section id="fundamental-operations" class="level2">
<h2 class="anchored" data-anchor-id="fundamental-operations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.2</strong></span> <strong>Fundamental operations</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the members of them</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyverse_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "broom"         "conflicted"    "cli"           "dbplyr"       
 [5] "dplyr"         "dtplyr"        "forcats"       "ggplot2"      
 [9] "googledrive"   "googlesheets4" "haven"         "hms"          
[13] "httr"          "jsonlite"      "lubridate"     "magrittr"     
[17] "modelr"        "pillar"        "purrr"         "ragg"         
[21] "readr"         "readxl"        "reprex"        "rlang"        
[25] "rstudioapi"    "rvest"         "stringr"       "tibble"       
[29] "tidyr"         "xml2"          "tidyverse"    </code></pre>
</div>
</div>
<p>Core members and their function:</p>
<ul>
<li><code>ggplot2</code>: Creating graphics</li>
<li><code>dplyr</code>: Data manipulation</li>
<li><code>tidyr</code>: Get to tidy data</li>
<li><code>readr</code>: Read rectangular data</li>
<li><code>purrr</code>: Functional programming</li>
<li><code>tibble</code>: Re-imagining of the data frame</li>
<li><code>stringr</code>: Working with strings</li>
<li><code>forcats</code>: Working with factors</li>
</ul>
</section>
<section id="pipe-operator" class="level2">
<h2 class="anchored" data-anchor-id="pipe-operator"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.3</strong></span> <strong>Pipe operator</strong></h2>
<p>The pipe operator can be written as <code>%&gt;%</code> or <code>|&gt;</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.109</span>, <span class="fl">0.359</span>, <span class="fl">0.63</span>, <span class="fl">0.996</span>, <span class="fl">0.515</span>, <span class="fl">0.142</span>, <span class="fl">0.017</span>, <span class="fl">0.829</span>, <span class="fl">0.907</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1:</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(y1)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(y2)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">round</span>(y3)</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">diff</span>(<span class="fu">log</span>(x))))</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pipe method</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">log</span>() <span class="sc">%&gt;%</span> <span class="fu">diff</span>() <span class="sc">%&gt;%</span> <span class="fu">exp</span>() <span class="sc">%&gt;%</span> <span class="fu">round</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mutiply-work-by-using-tidyverse-pipe" class="level2">
<h2 class="anchored" data-anchor-id="mutiply-work-by-using-tidyverse-pipe"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4</strong></span> <strong>Mutiply work by using tidyverse pipe</strong></h2>
<section id="graph-work" class="level3">
<h3 class="anchored" data-anchor-id="graph-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.1</strong></span> <strong>Graph work</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By using R built-in par() function and a loop</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boxplot</span>(iris[, i] <span class="sc">~</span> iris<span class="sc">$</span>Species, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">'Species'</span>, <span class="at">ylab =</span> <span class="fu">names</span>(iris)[i])</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By using pivot_longer() function and tidyverse pipe</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>Species) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(Species, value)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(name <span class="sc">~</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="statistic-work" class="level3">
<h3 class="anchored" data-anchor-id="statistic-work"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.4.2</strong></span> <strong>Statistic work</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base R</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>dtf1_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species), <span class="at">Mean_Sepal_Length =</span> <span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>dtf1_sd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species), <span class="at">SD_Sepal_Length =</span> <span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>dtf1_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species), <span class="at">Median_Sepal_Length =</span> <span class="fu">tapply</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Species, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf1_mean) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Mean_Sepal_Length"</span>)</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf1_sd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"SD_Sepal_Length"</span>)</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf1_median) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Median_Sepal_Length"</span>)</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(dtf1_mean, dtf1_sd, dtf1_median)  <span class="co"># Show them in one table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Species Mean_Sepal_Length    Species SD_Sepal_Length    Species
setosa         setosa             5.006     setosa       0.3524897     setosa
versicolor versicolor             5.936 versicolor       0.5161711 versicolor
virginica   virginica             6.588  virginica       0.6358796  virginica
           Median_Sepal_Length
setosa                     5.0
versicolor                 5.9
virginica                  6.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use a loop</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  dtf1_mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tapply</span>(iris[, i], iris<span class="sc">$</span>Species, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  dtf1_sd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tapply</span>(iris[, i], iris<span class="sc">$</span>Species, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  dtf1_median <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tapply</span>(iris[, i], iris<span class="sc">$</span>Species, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  dtf1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dtf1_mean, dtf1_sd, dtf1_median)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(dtf1) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">names</span>(iris)[i], <span class="st">'.'</span>, <span class="fu">c</span>(<span class="st">'mean'</span>, <span class="st">'sd'</span>, <span class="st">'median'</span>))</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>  dtf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dtf, dtf1)</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>dtf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           rep.NA..3. Sepal.Length.mean Sepal.Length.sd Sepal.Length.median
setosa             NA             5.006       0.3524897                 5.0
versicolor         NA             5.936       0.5161711                 5.9
virginica          NA             6.588       0.6358796                 6.5
           Sepal.Width.mean Sepal.Width.sd Sepal.Width.median Petal.Length.mean
setosa                3.428      0.3790644                3.4             1.462
versicolor            2.770      0.3137983                2.8             4.260
virginica             2.974      0.3224966                3.0             5.552
           Petal.Length.sd Petal.Length.median Petal.Width.mean Petal.Width.sd
setosa           0.1736640                1.50            0.246      0.1053856
versicolor       0.4699110                4.35            1.326      0.1977527
virginica        0.5518947                5.55            2.026      0.2746501
           Petal.Width.median
setosa                    0.2
versicolor                1.3
virginica                 2.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> </span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Species) <span class="sc">|&gt;</span> </span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species, name) <span class="sc">|&gt;</span> </span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>dtf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
   Species    name          mean    sd median
   &lt;fct&gt;      &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 setosa     Petal.Length 1.46  0.174   1.5 
 2 setosa     Petal.Width  0.246 0.105   0.2 
 3 setosa     Sepal.Length 5.01  0.352   5   
 4 setosa     Sepal.Width  3.43  0.379   3.4 
 5 versicolor Petal.Length 4.26  0.470   4.35
 6 versicolor Petal.Width  1.33  0.198   1.3 
 7 versicolor Sepal.Length 5.94  0.516   5.9 
 8 versicolor Sepal.Width  2.77  0.314   2.8 
 9 virginica  Petal.Length 5.55  0.552   5.55
10 virginica  Petal.Width  2.03  0.275   2   
11 virginica  Sepal.Length 6.59  0.636   6.5 
12 virginica  Sepal.Width  2.97  0.322   3   </code></pre>
</div>
</div>
</section>
</section>
<section id="tidy-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="tidy-the-dataset"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.5</strong></span> <strong>Tidy the dataset</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table1</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute rate per 10,000</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rate =</span> cases <span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country      year  cases population  rate
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Afghanistan  1999    745   19987071 0.373
2 Afghanistan  2000   2666   20595360 1.29 
3 Brazil       1999  37737  172006362 2.19 
4 Brazil       2000  80488  174504898 4.61 
5 China        1999 212258 1272915272 1.67 
6 China        2000 213766 1280428583 1.67 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute cases per year</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> <span class="fu">count</span>(year, <span class="at">wt =</span> cases)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year      n
  &lt;dbl&gt;  &lt;dbl&gt;
1  1999 250740
2  2000 296920</code></pre>
</div>
</div>
</section>
<section id="conversions-the-dataframe-type" class="level2">
<h2 class="anchored" data-anchor-id="conversions-the-dataframe-type"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.6</strong></span> <strong>Conversions the dataframe type</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table2</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Divided the type into cases and population</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table3</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate the rate into cases and population</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> <span class="fu">separate</span>(<span class="at">col =</span> rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"cases"</span>, <span class="st">"population"</span>), <span class="at">sep =</span> <span class="st">"/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year cases  population
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
1 Afghanistan  1999 745    19987071  
2 Afghanistan  2000 2666   20595360  
3 Brazil       1999 37737  172006362 
4 Brazil       2000 80488  174504898 
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original dataset of table4a and table4b</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(table4a, table4b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      country   1999   2000     country       1999       2000
1 Afghanistan    745   2666 Afghanistan   19987071   20595360
2      Brazil  37737  80488      Brazil  172006362  174504898
3       China 212258 213766       China 1272915272 1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put table4a and table4b together to form a new table with both of their dataset</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>tidy4a_changed <span class="ot">&lt;-</span> table4a <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">1999</span><span class="st">`</span>, <span class="st">`</span><span class="at">2000</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"cases"</span>)</span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>tidy4b_changed <span class="ot">&lt;-</span> table4b <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">1999</span><span class="st">`</span>, <span class="st">`</span><span class="at">2000</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"year"</span>, <span class="at">values_to =</span> <span class="st">"population"</span>)</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(tidy4a_changed, tidy4b_changed)   <span class="do">## Kind of like MySQL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country     year   cases population
  &lt;chr&gt;       &lt;chr&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan 1999     745   19987071
2 Afghanistan 2000    2666   20595360
3 Brazil      1999   37737  172006362
4 Brazil      2000   80488  174504898
5 China       1999  212258 1272915272
6 China       2000  213766 1280428583</code></pre>
</div>
</div>
</section>
<section id="find-missing-observations" class="level2">
<h2 class="anchored" data-anchor-id="find-missing-observations"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>6.7</strong></span> <strong>Find missing observations</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openair)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a function to count missing observations</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>sum_of_na <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">is.na</span>(x))</span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(</span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">across</span>(<span class="fu">everything</span>(), sum_of_na)</span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
   date    ws    wd   nox   no2    o3  pm10   so2    co  pm25
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1     0   632   219  2423  2438  2589  2162 10450  1936  8775</code></pre>
</div>
</div>
</section>
</section>
<section id="anova-post-hoc-tests" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7</strong></span> <strong>ANOVA (Post-hoc tests)</strong></h1>
<section id="post-hoc-tests" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-tests"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.1</strong></span> <strong>Post-hoc tests</strong></h2>
<p>Background informations: A biologist studies the weight gain of male lab rats on diets over a 4-week period. Three different diets are applied.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistic anlysis</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>(dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">diet1 =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">95</span>, <span class="dv">100</span>),</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet2 =</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="dv">125</span>, <span class="dv">130</span>),</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet3 =</span> <span class="fu">c</span>(<span class="dv">125</span>, <span class="dv">130</span>, <span class="dv">135</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  diet1 diet2 diet3
1    90   120   125
2    95   125   130
3   100   130   135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>dtf2 <span class="ot">&lt;-</span> <span class="fu">stack</span>(dtf)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dtf2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"wg"</span>, <span class="st">"diet"</span>)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>wg_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(wg <span class="sc">~</span> diet, <span class="at">data =</span> dtf2)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wg_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet         2   2150    1075      43 0.000277 ***
Residuals    6    150      25                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dtf2) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(wg, diet))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fishers-least-significant-difference-lsd-test" class="level2">
<h2 class="anchored" data-anchor-id="fishers-least-significant-difference-lsd-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2</strong></span> <strong>Fisher’s Least Significant Difference (LSD) Test</strong></h2>
<section id="concept" class="level3">
<h3 class="anchored" data-anchor-id="concept"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.1</strong></span> <strong>Concept</strong></h3>
<p>Pair-wise comparisons of all the groups based on the <span class="math inline">\(t\)</span>-test: <span class="math display">\[L S D=t_{\alpha / 2} \sqrt{S_{p}^{2}\left(\frac{1}{n_1}+\frac{1}{n_2}+\cdots\right)}\]</span> <span class="math display">\[S_{p}^{2}=\frac{\left(n_{1}-1\right) S_{1}^{2}+\left(n_{2}-1\right) S_{2}^{2}+\left(n_{3}-1\right) S_{3}^{2}+\cdots}{\left(n_{1}-1\right)+\left(n_{2}-1\right)+\left(n_{3}-1\right)+\cdots}\]</span></p>
<ul>
<li><span class="math inline">\(S_{p}^{2}:\)</span>: pooled standard deviation (some use Mean Standard Error)</li>
<li><span class="math inline">\(t_{\alpha / 2}: \mathrm{t}\)</span>: <span class="math inline">\(t\)</span> critical value at <span class="math inline">\(\alpha=0.025\)</span></li>
<li>Degree of freedom: <span class="math inline">\(N - k\)</span>
<ul>
<li><span class="math inline">\(N\)</span>: total observations</li>
<li><span class="math inline">\(k\)</span>: number of factors</li>
</ul></li>
<li>If <span class="math inline">\(\left|\bar{x}_{1}-\bar{x}_{2}\right|&gt;L S D\)</span>, then the difference of <span class="math inline">\(x_1\)</span> group and <span class="math inline">\(x_2\)</span> group is significant at <span class="math inline">\(\alpha\)</span>.</li>
<li>In multiple comparisons (<span class="math inline">\(k\)</span> factors), the number of comparison needed is: <span class="math inline">\(\frac{k(k-1)}{2}\)</span></li>
</ul>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.2.2</strong></span> <strong>Example</strong></h3>
<p>(Rats on diets in the previous section)</p>
<ol type="1">
<li>Step by step</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate LSD</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dtf2)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(dtf2<span class="sc">$</span>diet)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>dfree <span class="ot">&lt;-</span> n <span class="sc">-</span> k</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>t_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> dfree, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">apply</span>(dtf, <span class="dv">2</span>, sd) <span class="sc">^</span> <span class="dv">2</span>)<span class="sc">/</span> dfree</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>LSD <span class="ot">&lt;-</span> t_critical <span class="sc">*</span> <span class="fu">sqrt</span>(sp2 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate |mean_x1-mean_x2|</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>dtf_groupmean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(dtf)</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>paired_groupmean <span class="ot">&lt;-</span> <span class="fu">combn</span>(dtf_groupmean, <span class="dv">2</span>)</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>paired_groupmean[<span class="dv">2</span>, ] <span class="sc">-</span> paired_groupmean[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 35  5</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Step by step by using loop</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>dtf_sm <span class="ot">&lt;-</span> dtf2 <span class="sc">|&gt;</span> </span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(diet) <span class="sc">|&gt;</span> </span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">length</span>(wg), <span class="at">sd =</span> <span class="fu">sd</span>(wg), <span class="at">mean =</span> <span class="fu">mean</span>(wg))</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>sp2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((dtf_sm<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> dtf_sm<span class="sc">$</span>sd <span class="sc">^</span> <span class="dv">2</span> )<span class="sc">/</span> dfree</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>LSD <span class="ot">&lt;-</span> t_critical <span class="sc">*</span> <span class="fu">sqrt</span>(sp2 <span class="sc">*</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> dtf_sm<span class="sc">$</span>n))</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>paired_groupmean <span class="ot">&lt;-</span> <span class="fu">combn</span>(dtf_sm<span class="sc">$</span>mean, <span class="dv">2</span>)</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>paired_groupmean[<span class="dv">2</span>, ] <span class="sc">-</span> paired_groupmean[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 35  5</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>One step</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistic analysis</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(wg_aov, <span class="st">"diet"</span>, <span class="at">p.adj =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
  MSerror Df     Mean       CV  t.value      MSD
       25  6 116.6667 4.285714 3.287455 13.42098

$parameters
        test  p.ajusted name.t ntr alpha
  Fisher-LSD bonferroni   diet   3  0.05

$means
       wg std r       LCL      UCL Min Max   Q25 Q50   Q75
diet1  95   5 3  87.93637 102.0636  90 100  92.5  95  97.5
diet2 125   5 3 117.93637 132.0636 120 130 122.5 125 127.5
diet3 130   5 3 122.93637 137.0636 125 135 127.5 130 132.5

$comparison
NULL

$groups
       wg groups
diet3 130      a
diet2 125      a
diet1  95      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<details>
<summary>
The meaning of each parameter in this table
</summary>
<ul>
<li>$statistics：包含ANOVA分析的统计量（statistics）的列表。
<ul>
<li>MSerror：平均方差误差（mean square error），也称为残差方差，表示模型误差的平均程度。</li>
<li>Df：自由度（degrees of freedom）。</li>
<li>Mean：均值（mean）。</li>
<li>CV：变异系数（coefficient of variation），变异系数越大，说明数据的离散程度越大。</li>
<li>t.value：t值（t-value），表示组间均值之间的显著性差异程度。</li>
<li>MSD：最小显著差异（minimum significant difference），表示在显著性水平下两个组之间的最小显著差异值。</li>
</ul></li>
<li>$parameters：包含对比分析的参数（parameters）的列表。
<ul>
<li>test：所使用的多重比较方法（multiple comparison method），此处为Fisher-LSD法。</li>
<li>p.ajusted：经过校正后的显著性水平（adjusted significance level），此处为Bonferroni法。 -name.t：所进行对比分析的因素名称（name of tested factor），此处为diet。</li>
<li>ntr：因素水平数（number of treatments），此处为3。</li>
<li>alpha：显著性水平（significance level），此处为0.05。</li>
</ul></li>
<li>$means：包含各组均值和统计信息（means and statistics）的列表。
<ul>
<li>wg：组均值（group mean）。</li>
<li>std：标准差（standard deviation）。</li>
<li>r：重复次数（replications）。</li>
<li>LCL：下限置信区间（lower confidence limit）。</li>
<li>UCL：上限置信区间（upper confidence limit）。</li>
<li>Min：最小值（minimum value）。</li>
<li>Max：最大值（maximum value）。</li>
<li>Q25：25%分位数（25th percentile）。</li>
<li>Q50：50%分位数（50th percentile），也称为中位数。</li>
<li>Q75：75%分位数（75th percentile）。</li>
</ul></li>
<li>$comparison：对比分析结果（comparison），此处为空。</li>
<li>$groups：分组结果（groups）。
<ul>
<li>wg：组均值（group mean）。</li>
<li>groups：分组结果（groups），使用字母表示不同组别，相同字母表示在统计上没有显著差异。</li>
</ul></li>
<li>attr(,“class”)：结果的类别（class），此处为”group”。</li>
</ul>
</details>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(wg_aov, <span class="st">"diet"</span>, <span class="at">p.adj =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: At <span class="math inline">\(\alpha = 0.05\)</span>, Diet 2 and Diet 3 are significantly different from Diet 1 in the mean weight gain, while Diet 2 is not significantly different from Diet 3.</p>
</section>
</section>
<section id="bonferroni-t-test" class="level2">
<h2 class="anchored" data-anchor-id="bonferroni-t-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3</strong></span> <strong>Bonferroni t-test</strong></h2>
<section id="concept-1" class="level3">
<h3 class="anchored" data-anchor-id="concept-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.1</strong></span> <strong>Concept</strong></h3>
<p>A multiple-comparison post-hoc test, which sets the significance cut off at <span class="math inline">\(\alpha/m\)</span> for each comparison, where <span class="math inline">\(m\)</span> represents <span style="color:red">the <u>number</u> of comparisons we apply</span>.</p>
<p><span style="color:#880000">Overall chance of making a Type I error:</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>siglevel <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>Type_I <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> (siglevel <span class="sc">/</span> m)) <span class="sc">^</span> m</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>Type_I</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.05000000 0.04937500 0.04917130 0.04907029 0.04900995 0.04896984
  [7] 0.04894124 0.04891982 0.04890317 0.04888987 0.04887899 0.04886993
 [13] 0.04886227 0.04885571 0.04885002 0.04884504 0.04884065 0.04883675
 [19] 0.04883326 0.04883012 0.04882728 0.04882470 0.04882235 0.04882019
 [25] 0.04881820 0.04881637 0.04881467 0.04881309 0.04881162 0.04881025
 [31] 0.04880897 0.04880777 0.04880664 0.04880558 0.04880458 0.04880363
 [37] 0.04880274 0.04880189 0.04880109 0.04880033 0.04879960 0.04879891
 [43] 0.04879825 0.04879762 0.04879702 0.04879644 0.04879589 0.04879536
 [49] 0.04879486 0.04879437 0.04879390 0.04879346 0.04879302 0.04879261
 [55] 0.04879221 0.04879182 0.04879145 0.04879109 0.04879074 0.04879040
 [61] 0.04879008 0.04878976 0.04878946 0.04878916 0.04878888 0.04878860
 [67] 0.04878833 0.04878807 0.04878782 0.04878757 0.04878733 0.04878710
 [73] 0.04878687 0.04878665 0.04878644 0.04878623 0.04878602 0.04878583
 [79] 0.04878563 0.04878544 0.04878526 0.04878508 0.04878491 0.04878474
 [85] 0.04878457 0.04878441 0.04878425 0.04878409 0.04878394 0.04878379
 [91] 0.04878365 0.04878350 0.04878337 0.04878323 0.04878310 0.04878297
 [97] 0.04878284 0.04878271 0.04878259 0.04878247</code></pre>
</div>
</div>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>7.3.2</strong></span> <strong>Example</strong></h3>
<p>(Rats on diets in the previous section)</p>
<ol type="1">
<li>Step by step</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">choose</span>(<span class="fu">nlevels</span>(dtf2<span class="sc">$</span>diet), <span class="dv">2</span>)  <span class="co"># 1:2 or 1:3 or 2:3</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>alpha_cor <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="sc">/</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparison between diet1 and diet2</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wg <span class="sc">~</span> diet, dtf2, <span class="at">subset =</span> diet <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"diet1"</span>, <span class="st">"diet2"</span>), <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wg by diet
t = -7.3485, df = 4, p-value = 0.001826
alternative hypothesis: true difference in means between group diet1 and group diet2 is not equal to 0
98.33333 percent confidence interval:
 -46.16984 -13.83016
sample estimates:
mean in group diet1 mean in group diet2 
                 95                 125 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparison between diet1 and diet3</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wg <span class="sc">~</span> diet, dtf2, <span class="at">subset =</span> diet <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"diet1"</span>, <span class="st">"diet3"</span>), <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wg by diet
t = -8.5732, df = 4, p-value = 0.001017
alternative hypothesis: true difference in means between group diet1 and group diet3 is not equal to 0
98.33333 percent confidence interval:
 -51.16984 -18.83016
sample estimates:
mean in group diet1 mean in group diet3 
                 95                 130 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparison between diet2 and diet3</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(wg <span class="sc">~</span> diet, dtf2, <span class="at">subset =</span> diet <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"diet2"</span>, <span class="st">"diet3"</span>), <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha_cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  wg by diet
t = -1.2247, df = 4, p-value = 0.2879
alternative hypothesis: true difference in means between group diet2 and group diet3 is not equal to 0
98.33333 percent confidence interval:
 -21.16984  11.16984
sample estimates:
mean in group diet2 mean in group diet3 
                125                 130 </code></pre>
</div>
</div>
<ol start="2" type="1">
<li>One step</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>(diet_pt <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(dtf2<span class="sc">$</span>wg, dtf2<span class="sc">$</span>diet, <span class="at">pool.sd =</span> <span class="cn">FALSE</span>,<span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">p.adj =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  dtf2$wg and dtf2$diet 

      diet1  diet2 
diet2 0.0018 -     
diet3 0.0010 0.2879

P value adjustment method: none </code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>diet_pt<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      diet1 diet2
diet2  TRUE    NA
diet3  TRUE FALSE</code></pre>
</div>
</div>
<p>Conclusion: At <span class="math inline">\(\alpha = 0.05\)</span>, Diet 2 and Diet 3 are significantly different from Diet 1 in the mean weight gain, while Diet 2 is not significantly different from Diet 3.</p>
</section>
</section>
</section>
<section id="manova" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8</strong></span> <strong>MANOVA</strong></h1>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/One-Way%20ANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">One-Way ANOVA (ENV221)</figcaption><p></p>
</figure>
</div>
</center>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Two-Way%20ANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Two-Way ANOVA (ENV221)</figcaption><p></p>
</figure>
</div>
</center>
<center>
<a href="https://www.statology.org/differences-between-anova-ancova-manova-mancova/">The Differences Between ANOVA, ANCOVA, MANOVA, and MANCOVA</a>
</center>
<section id="definition-of-manova" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.1</strong></span> <strong>Definition of MANOVA</strong></h2>
<p><strong>Univariate Analysis of Variance (ANOVA):</strong></p>
<ul>
<li>one dependent variable (continuous) ~ one or multiple independent variables (categorical).<br>
<strong>Multivariate Analysis of Variance (MANOVA)</strong></li>
<li>multiple dependent variables (continuous) ~ one or multiple independent variables (categorical).<br>
Comparing multivariate sample means. It uses the covariance between outcome variables in testing the statistical significance of the mean differences when there are multiple dependent variables.</li>
</ul>
<p>Merit of MANOVA:</p>
<ol type="1">
<li>Reduce the Type I error</li>
<li>It allows for the analysis of multiple dependent variables simultaneously</li>
<li>It provides information about the strength and direction of relationships</li>
</ol>
</section>
<section id="coding-and-visualization" class="level2">
<h2 class="anchored" data-anchor-id="coding-and-visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.2</strong></span> <strong>Coding and visualization</strong></h2>
<p><strong>Example:</strong> Influence of <u>teaching methods</u> on student <u>satisfaction scores</u> and <u>exam scores</u>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/teaching_methods.csv'</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dtf, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Method  Test Satisfaction
1      1 3.000        3.001
2      1 2.990        2.994
3      1 3.041        3.032</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA between Test and Method</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Test <span class="sc">~</span> Method, <span class="at">data =</span> dtf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq   Mean Sq F value Pr(&gt;F)
Method       1 0.000578 0.0005780   2.426  0.126
Residuals   46 0.010958 0.0002382               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA between Satisfaction and Method</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(Satisfaction <span class="sc">~</span> Method, <span class="at">data =</span> dtf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq   Mean Sq F value Pr(&gt;F)
Method       1 0.000032 0.0000320   0.135  0.715
Residuals   46 0.010944 0.0002379               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with Scatter plot</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>dtf <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>Method) <span class="sc">|&gt;</span> </span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> value, <span class="at">group =</span> Method), <span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span> </span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(name<span class="sc">~</span>.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with Box plot</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Test <span class="sc">~</span> Method, <span class="at">data =</span> dtf)</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Satisfaction <span class="sc">~</span> Method, <span class="at">data =</span> dtf)</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dtf<span class="sc">$</span>Satisfaction, dtf<span class="sc">$</span>Test, <span class="at">col =</span> dtf<span class="sc">$</span>Method, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span> <span class="st">'Satisfaction'</span>, <span class="at">ylab =</span> <span class="st">'Test'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MANOVA method: use manova() function with multiple response variables ~ one or multiple factor</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="co"># column bind way</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>tm_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(dtf<span class="sc">$</span>Test, dtf<span class="sc">$</span>Satisfaction) <span class="sc">~</span> dtf<span class="sc">$</span>Method)</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix way</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>tm_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">as.matrix</span>(dtf[, <span class="fu">c</span>(<span class="st">'Test'</span>, <span class="st">'Satisfaction'</span>)]) <span class="sc">~</span> dtf<span class="sc">$</span>Method)</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tm_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Df  Pillai approx F num Df den Df   Pr(&gt;F)    
dtf$Method  1 0.45766   18.987      2     45 1.05e-06 ***
Residuals  46                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="one-way-manova" class="level2">
<h2 class="anchored" data-anchor-id="one-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.3</strong></span> <strong>One-way MANOVA</strong></h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/One-way%20MANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">One-way MANOVA</figcaption><p></p>
</figure>
</div>
</center>
<p><strong>Example:</strong> The iris dataset. Do the species have influence on the sepal size?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a>iris[, <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)] <span class="sc">|&gt;</span> </span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Sepal.Length, Sepal.Width)) <span class="sc">|&gt;</span> </span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(Species, value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Size (cm)'</span>, <span class="at">fill =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species, <span class="at">xlab =</span> <span class="st">"Species"</span>, <span class="at">ylab =</span> <span class="st">"Sepal length"</span>)</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plotmeans</span>(iris<span class="sc">$</span>Sepal.Width <span class="sc">~</span> iris<span class="sc">$</span>Species, <span class="at">xlab =</span> <span class="st">"Species"</span>, <span class="at">ylab =</span> <span class="st">"Sepal width"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Hypothesis:</strong> multivariate normality test</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: The population means of the sepal length and the sepal width are not different across the species.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary MANOVA result with different test method</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>SepalSize <span class="ot">&lt;-</span> <span class="fu">cbind</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>iris_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(SepalSize <span class="sc">~</span> iris<span class="sc">$</span>Species)</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Pillai'</span>)  <span class="co"># default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df  Pillai approx F num Df den Df    Pr(&gt;F)    
iris$Species   2 0.94531   65.878      4    294 &lt; 2.2e-16 ***
Residuals    147                                             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Wilks'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df   Wilks approx F num Df den Df    Pr(&gt;F)    
iris$Species   2 0.16654   105.88      4    292 &lt; 2.2e-16 ***
Residuals    147                                             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Roy'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df    Roy approx F num Df den Df    Pr(&gt;F)    
iris$Species   2 4.1718   306.63      2    147 &lt; 2.2e-16 ***
Residuals    147                                            
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris_manova, <span class="at">test =</span> <span class="st">'Hotelling-Lawley'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Hotelling-Lawley approx F num Df den Df    Pr(&gt;F)    
iris$Species   2           4.3328   157.06      4    290 &lt; 2.2e-16 ***
Residuals    147                                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Univariate ANOVAs for each dependent variable</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(iris_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response 1 :
              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
iris$Species   2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals    147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response 2 :
              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
iris$Species   2 11.345  5.6725   49.16 &lt; 2.2e-16 ***
Residuals    147 16.962  0.1154                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> The species has a statistically significant effect on the sepal width and sepal length.</p>
</section>
<section id="post-hoc-test" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.4</strong></span> <strong>Post-hoc test</strong></h2>
<p><strong>Example:</strong> after One-way MANOVA gives a significant result, which group(s) is/are different from other(s)?<br>
<strong>Hypothesis:</strong> Linear Discriminant Analysis (LDA)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>iris_lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(iris<span class="sc">$</span>Species <span class="sc">~</span> SepalSize, <span class="at">CV =</span> <span class="cn">FALSE</span>)</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>plot_lda <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Species =</span> iris<span class="sc">$</span>Species, <span class="at">lda =</span> <span class="fu">predict</span>(iris_lda)<span class="sc">$</span>x)</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_lda) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lda.LD1, <span class="at">y =</span> lda.LD2, <span class="at">colour =</span> Species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusion:</strong> The sepal size of the setosa species is different from other species.</p>
</section>
<section id="multivariate-normality" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-normality"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5</strong></span> <strong>Multivariate normality</strong></h2>
<section id="shapiro-wilk-test" class="level3">
<h3 class="anchored" data-anchor-id="shapiro-wilk-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.1</strong></span> <strong>Shapiro-Wilk test</strong></h3>
<p><strong>Hypothesis:</strong><br>
<span class="math inline">\(H_0\)</span>: The variable follows a normal distribution</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span>  </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span>  </span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Sepal.Length, Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Species    variable     statistic     p
  &lt;fct&gt;      &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;
1 setosa     Sepal.Length     0.978 0.460
2 setosa     Sepal.Width      0.972 0.272
3 versicolor Sepal.Length     0.978 0.465
4 versicolor Sepal.Width      0.974 0.338
5 virginica  Sepal.Length     0.971 0.258
6 virginica  Sepal.Width      0.967 0.181</code></pre>
</div>
</div>
<p>Tip:</p>
<ul>
<li><span style="color:green">If the sample size is large (say n &gt; 50), the visual approaches such as QQ-plot and histogram will be better for assessing the normality assumption.</span></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>iris[, <span class="fu">c</span>(<span class="st">'Species'</span>, <span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)] <span class="sc">|&gt;</span> </span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Sepal.Length, Sepal.Width)) <span class="sc">|&gt;</span> </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(name <span class="sc">~</span> Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusion:</strong> As <span class="math inline">\(p&gt;0.05\)</span>, the sepal length and the width for each species are normally distributed.</p>
</section>
<section id="mardias-skewness-and-kurtosis-test" class="level3">
<h3 class="anchored" data-anchor-id="mardias-skewness-and-kurtosis-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.2</strong></span> <strong>Mardia’s skewness and kurtosis test</strong></h3>
<p><strong>Hypothesis:</strong><br>
<span class="math inline">\(H_0\)</span>: The variables follow a multivariate normal distribution</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormalTest)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mardia</span>(iris[, <span class="fu">c</span>(<span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)])<span class="sc">$</span>mv.test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Test Statistic p-value Result
1     Skewness    9.4614  0.0505    YES
2     Kurtosis    -0.691  0.4896    YES
3 MV Normality      &lt;NA&gt;    &lt;NA&gt;    YES</code></pre>
</div>
</div>
<p>Tip:</p>
<ul>
<li><span style="color:green">When n &gt; 20 for each combination of the independent and dependent variable, the multivariate normality can be assumed (Multivariate Central Limit Theorem).</span></li>
</ul>
<p><strong>Conclusion:</strong> As <span class="math inline">\(p&gt;0.05\)</span>, the sepal length and the width follow a multivariate normal distribution.</p>
</section>
<section id="homogeneity-of-the-variance-covariance-matrix" class="level3">
<h3 class="anchored" data-anchor-id="homogeneity-of-the-variance-covariance-matrix"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.3</strong></span> <strong>Homogeneity of the variance-covariance matrix</strong></h3>
<p><strong>Main:</strong><br>
Box’s M test: Use a lower <span class="math inline">\(\alpha\)</span> level such as <span class="math inline">\(\alpha = 0.001\)</span> to assess the <span class="math inline">\(p\)</span> value for significance.<br>
<strong>Hypothesis:</strong><br>
<span class="math inline">\(H_0\)</span>: The variance-covariance matrices are equal for each combination formed by each group in the independent variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biotools)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxM</span>(<span class="fu">cbind</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width), iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  cbind(iris$Sepal.Length, iris$Sepal.Width)
Chi-Sq (approx.) = 35.655, df = 6, p-value = 3.217e-06</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> As <span class="math inline">\(p &lt; 0.001\)</span>, the variance-covariance matrices for the sepal length and width are not equal for each combination formed by each species.</p>
</section>
<section id="multivariate-outliers" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-outliers"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.4</strong></span> <strong>Multivariate outliers</strong></h3>
<ul>
<li><span style="color:red">MANOVA is highly sensitive to outliers and may produce Type I or II errors.</span></li>
<li>Multivariate outliers can be detected using the Mahalanobis Distance test. The larger the Mahalanobis Distance, the more likely it is an outlier.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>iris_outlier <span class="ot">&lt;-</span> <span class="fu">mahalanobis_distance</span>(iris[, <span class="fu">c</span>(<span class="st">'Sepal.Length'</span>, <span class="st">'Sepal.Width'</span>)])</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris_outlier, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width mahal.dist is.outlier
1          5.1         3.5      1.646      FALSE
2          4.9         3.0      1.369      FALSE
3          4.7         3.2      1.934      FALSE
4          4.6         3.1      2.261      FALSE
5          5.0         3.6      2.321      FALSE</code></pre>
</div>
</div>
</section>
<section id="linearity" class="level3">
<h3 class="anchored" data-anchor-id="linearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.5</strong></span> <strong>Linearity</strong></h3>
<ul>
<li>Or test the regression or the slope (ENV221)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the pairwise scatterplot for the dependent variable for each group</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Species <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="multicollinearity"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.5.6</strong></span> <strong>Multicollinearity</strong></h3>
<p>Correlation between the dependent variable.<br>
For three or more dependent variables, use a correlation matrix or variance inflation factor (VIF).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the correlation</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> iris<span class="sc">$</span>Sepal.Length, <span class="at">y =</span> iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  iris$Sepal.Length and iris$Sepal.Width
t = -1.4403, df = 148, p-value = 0.1519
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.27269325  0.04351158
sample estimates:
       cor 
-0.1175698 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Sepal.Width)) <span class="sc">+</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>If <span class="math inline">\(|r|\)</span> &gt; 0.9, there is multicollinearity.</li>
<li>If r is too low, perform separate univariate ANOVA for each dependent variable.</li>
</ul>
</section>
</section>
<section id="two-way-manova" class="level2">
<h2 class="anchored" data-anchor-id="two-way-manova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>8.6</strong></span> <strong>Two-way MANOVA</strong></h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Two-way%20MANOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Two-way MANOVA</figcaption><p></p>
</figure>
</div>
</center>
<p><strong>Example:</strong> Plastic. Do the rate of extrusion and the additive have influence on the plastic quality?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary MANOVA result</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">'Plastic'</span>, <span class="at">package =</span> <span class="st">'heplots'</span>)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>Plastic_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Plastic[, <span class="fu">c</span>(<span class="st">'tear'</span>,<span class="st">'gloss'</span>,<span class="st">'opacity'</span>)])</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>Plastic_manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(Plastic_matrix <span class="sc">~</span> Plastic<span class="sc">$</span>rate <span class="sc">*</span> Plastic<span class="sc">$</span>additive)</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Plastic_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              Df  Pillai approx F num Df den Df   Pr(&gt;F)   
Plastic$rate                   1 0.61814   7.5543      3     14 0.003034 **
Plastic$additive               1 0.47697   4.2556      3     14 0.024745 * 
Plastic$rate:Plastic$additive  1 0.22289   1.3385      3     14 0.301782   
Residuals                     16                                           
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Univariate ANOVAs for each dependent variable</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(Plastic_manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response tear :
                              Df Sum Sq Mean Sq F value   Pr(&gt;F)   
Plastic$rate                   1 1.7405 1.74050 15.7868 0.001092 **
Plastic$additive               1 0.7605 0.76050  6.8980 0.018330 * 
Plastic$rate:Plastic$additive  1 0.0005 0.00050  0.0045 0.947143   
Residuals                     16 1.7640 0.11025                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response gloss :
                              Df Sum Sq Mean Sq F value  Pr(&gt;F)  
Plastic$rate                   1 1.3005 1.30050  7.9178 0.01248 *
Plastic$additive               1 0.6125 0.61250  3.7291 0.07139 .
Plastic$rate:Plastic$additive  1 0.5445 0.54450  3.3151 0.08740 .
Residuals                     16 2.6280 0.16425                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response opacity :
                              Df Sum Sq Mean Sq F value Pr(&gt;F)
Plastic$rate                   1  0.421  0.4205  0.1036 0.7517
Plastic$additive               1  4.901  4.9005  1.2077 0.2881
Plastic$rate:Plastic$additive  1  3.960  3.9605  0.9760 0.3379
Residuals                     16 64.924  4.0578               </code></pre>
</div>
</div>
</section>
</section>
<section id="ancova" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9</strong></span> <strong>ANCOVA</strong></h1>
<section id="definition-of-ancova" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.1</strong></span> <strong>Definition of ANCOVA</strong></h2>
<p><span style="color:red">Test whether the independent variable(s) has a significant influence on the dependent variable, excluding the influence of the covariate (preferably highly correlated with the dependent variable)</span> <span class="math display">\[Y_{ij} = (\mu+\tau_{i})+\beta(x_{ij}-\bar{x})+\epsilon_{ij}\]</span></p>
<ul>
<li><span class="math inline">\(Y_{ij}\)</span>: the j-th observation under the i-th categorical group</li>
<li><span class="math inline">\(\mu\)</span>: the population mean</li>
<li><span class="math inline">\(i\)</span>: groups, 1,2, …</li>
<li><span class="math inline">\(j\)</span>: observations, 1,2,…</li>
<li><span class="math inline">\(\tau_i\)</span>: an adjustment to the y intercept for the i-th regression line</li>
<li><span class="math inline">\(\mu + \tau_i\)</span>: the intercept for group i</li>
<li><span class="math inline">\(\beta\)</span>: the slope of the line</li>
<li><span class="math inline">\(x_{ij}\)</span>: the j-th observation of the continuous variable under the i-th group</li>
<li><span class="math inline">\(\bar x\)</span>: the global mean of the variable x</li>
<li><span class="math inline">\(\epsilon _{ij}\)</span>: the associated unobserved error</li>
</ul>
<p><strong>Analysis of covariance (ANCOVA):</strong></p>
<ul>
<li>Dependent variable (DV): One continuous variable</li>
<li>Independent variables (IVs): One or multiple categorical variables, one or multiple continuous variables (covariate, CV)</li>
</ul>
<p><strong>Covariate (CV):</strong></p>
<ul>
<li>An independent variable that is not manipulated by experimenters but still influences experimental results.</li>
</ul>
<p><strong>Example:</strong></p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ANCOVA-plot.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Model simplification</figcaption><p></p>
</figure>
</div>
</center>
</section>
<section id="one-way-ancova" class="level2">
<h2 class="anchored" data-anchor-id="one-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2</strong></span> <strong>One-way ANCOVA</strong></h2>
<section id="question" class="level3">
<h3 class="anchored" data-anchor-id="question"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.1</strong></span> <strong>Question</strong></h3>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ANCOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">ANCOVA</figcaption><p></p>
</figure>
</div>
</center>
<p><strong>Example 1:</strong> Does <u>grazing</u> have influence on the fruit production? Are grazed plants have more fruit <u>production</u> than ungrazed ones?</p>
<ul>
<li>Independent variable:
<ul>
<li>Grazing (categorical)</li>
</ul></li>
<li>Dependent variable:
<ul>
<li>Fruit production (continuous)</li>
</ul></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/ipomopsis.txt"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Root Fruit  Grazing
1 6.225 59.77 Ungrazed
2 6.487 60.98 Ungrazed
3 4.919 14.73 Ungrazed
4 5.130 19.28 Ungrazed
5 5.417 34.25 Ungrazed</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(df1<span class="sc">$</span>Fruit,df1<span class="sc">$</span>Grazing, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Grazed Ungrazed 
 67.9405  50.8805 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(Fruit, Grazing))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis test</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Fruit <span class="sc">~</span> Grazing, <span class="at">data =</span> df1, <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">"greater"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Fruit by Grazing
t = 2.304, df = 37.306, p-value = 0.01344
alternative hypothesis: true difference in means between group Grazed and group Ungrazed is greater than 0
95 percent confidence interval:
 4.570757      Inf
sample estimates:
  mean in group Grazed mean in group Ungrazed 
               67.9405                50.8805 </code></pre>
</div>
</div>
<p><strong>Example 2:</strong> What is the influence of <u>grazing</u> and <u>root diameter</u> on the fruit production of a plant?</p>
<p>Independent variables:</p>
<ul>
<li>grazing (categorical: grazed or ungrazed)</li>
<li>root diameter (continuous, mm, covariate)</li>
</ul>
<p>Dependent variable:</p>
<ul>
<li>fruit production (mg)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(Root, Fruit))<span class="sc">+</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>) <span class="sc">+</span></span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Grazing)) <span class="sc">+</span> </span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Grazing), <span class="at">method =</span> <span class="st">'lm'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="maximal-model" class="level3">
<h3 class="anchored" data-anchor-id="maximal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.2</strong></span> <strong>Maximal model</strong></h3>
<table class="table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Symbol</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>~</code></td>
<td style="text-align: left;">Separating DV (<span style="color:red">left</span>) and IV (<span style="color:red">right</span>)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>:</code></td>
<td style="text-align: left;">Interaction effect of two factors</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>*</code></td>
<td style="text-align: left;">Main effect of the two factors and the interaction effect. <code>f1 * f2</code> is equivalent to <code>f1 + f2 + f1:f2</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>^</code></td>
<td style="text-align: left;">Square the sum of several terms. The main effect of these terms and the interaction between them</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>.</code></td>
<td style="text-align: left;">All variables except the DV</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The maximal model</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>df1_ancova <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fruit <span class="sc">~</span> Grazing <span class="sc">*</span> Root, <span class="at">data =</span> df1)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing * Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.3177  -2.8320   0.1247   3.8511  17.1313 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          -125.173     12.811  -9.771 1.15e-11 ***
GrazingUngrazed        30.806     16.842   1.829   0.0757 .  
Root                   23.240      1.531  15.182  &lt; 2e-16 ***
GrazingUngrazed:Root    0.756      2.354   0.321   0.7500    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.831 on 36 degrees of freedom
Multiple R-squared:  0.9293,    Adjusted R-squared:  0.9234 
F-statistic: 157.6 on 3 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The ANOVA table for the maximal model</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Fruit
             Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
Grazing       1  2910.4  2910.4  62.3795 2.262e-09 ***
Root          1 19148.9 19148.9 410.4201 &lt; 2.2e-16 ***
Grazing:Root  1     4.8     4.8   0.1031      0.75    
Residuals    36  1679.6    46.7                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># other method to see the ANOVA table </span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>df1_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Fruit <span class="sc">~</span> Grazing <span class="sc">*</span> Root, <span class="at">data =</span> df1)</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Grazing       1   2910    2910  62.380 2.26e-09 ***
Root          1  19149   19149 410.420  &lt; 2e-16 ***
Grazing:Root  1      5       5   0.103     0.75    
Residuals    36   1680      47                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Grazing       1   2910    2910  62.380 2.26e-09 ***
Root          1  19149   19149 410.420  &lt; 2e-16 ***
Grazing:Root  1      5       5   0.103     0.75    
Residuals    36   1680      47                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="minimal-model" class="level3">
<h3 class="anchored" data-anchor-id="minimal-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.3</strong></span> <strong>Minimal model</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete the interaction factor </span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>df1_ancova2 <span class="ot">&lt;-</span> <span class="fu">update</span>(df1_ancova, <span class="sc">~</span> . <span class="sc">-</span> Grazing<span class="sc">:</span>Root)</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing + Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.1920  -2.8224   0.3223   3.9144  17.3290 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -127.829      9.664  -13.23 1.35e-15 ***
GrazingUngrazed   36.103      3.357   10.75 6.11e-13 ***
Root              23.560      1.149   20.51  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.747 on 37 degrees of freedom
Multiple R-squared:  0.9291,    Adjusted R-squared:  0.9252 
F-statistic: 242.3 on 2 and 37 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the simplified model with the maximal model</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova, df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Fruit ~ Grazing * Root
Model 2: Fruit ~ Grazing + Root
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     36 1679.7                           
2     37 1684.5 -1   -4.8122 0.1031   0.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete the grazing factor </span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>df1_ancova3 <span class="ot">&lt;-</span> <span class="fu">update</span>(df1_ancova2, <span class="sc">~</span> . <span class="sc">-</span> Grazing)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-29.3844 -10.4447  -0.7574  10.7606  23.7556 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -41.286     10.723  -3.850 0.000439 ***
Root          14.022      1.463   9.584  1.1e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.52 on 38 degrees of freedom
Multiple R-squared:  0.7073,    Adjusted R-squared:  0.6996 
F-statistic: 91.84 on 1 and 38 DF,  p-value: 1.099e-11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the two models</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova2, df1_ancova3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Fruit ~ Grazing + Root
Model 2: Fruit ~ Root
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     37 1684.5                                  
2     38 6948.8 -1   -5264.4 115.63 6.107e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing + Root, data = df1)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.1920  -2.8224   0.3223   3.9144  17.3290 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -127.829      9.664  -13.23 1.35e-15 ***
GrazingUngrazed   36.103      3.357   10.75 6.11e-13 ***
Root              23.560      1.149   20.51  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.747 on 37 degrees of freedom
Multiple R-squared:  0.9291,    Adjusted R-squared:  0.9252 
F-statistic: 242.3 on 2 and 37 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(df1_ancova2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Fruit
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Grazing    1  2910.4  2910.4  63.929 1.397e-09 ***
Root       1 19148.9 19148.9 420.616 &lt; 2.2e-16 ***
Residuals 37  1684.5    45.5                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="one-step" class="level3">
<h3 class="anchored" data-anchor-id="one-step"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.4</strong></span> <strong>One step</strong></h3>
<p>Criterion: Akaike’s information criterion (AIC). The model is <u>worse</u> if AIC gets <u>greater</u>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(df1_ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=157.5
Fruit ~ Grazing * Root

               Df Sum of Sq    RSS    AIC
- Grazing:Root  1    4.8122 1684.5 155.61
&lt;none&gt;                      1679.7 157.50

Step:  AIC=155.61
Fruit ~ Grazing + Root

          Df Sum of Sq     RSS    AIC
&lt;none&gt;                  1684.5 155.61
- Grazing  1    5264.4  6948.8 210.30
- Root     1   19148.9 20833.4 254.22</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Fruit ~ Grazing + Root, data = df1)

Coefficients:
    (Intercept)  GrazingUngrazed             Root  
        -127.83            36.10            23.56  </code></pre>
</div>
</div>
</section>
<section id="result" class="level3">
<h3 class="anchored" data-anchor-id="result"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.2.5</strong></span> <strong>Result</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting formulas from linear regression models</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(df1_ancova2, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Fruit}} = -127.83 + 36.1(\operatorname{Grazing}_{\operatorname{Ungrazed}}) + 23.56(\operatorname{Root})
\]</span></p>
</div>
</div>
<p><a id="diagnostic statistical data text table" href=""></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a diagnostic statistical data text table</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(df1_ancova2, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                               Fruit           
-----------------------------------------------
GrazingUngrazed              36.103***         
                              (3.357)          
                                               
Root                         23.560***         
                              (1.149)          
                                               
Constant                    -127.829***        
                              (9.664)          
                                               
-----------------------------------------------
Observations                    40             
R2                             0.929           
Adjusted R2                    0.925           
Residual Std. Error       6.747 (df = 37)      
F Statistic           242.272*** (df = 2; 37)  
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<details>
<summary>
The meaning of each parameter in this table
</summary>
<ul>
<li>Dependent variable: The name of the dependent variable. (因变量的名称)</li>
<li>Independent variables: The names of the independent variables. (自变量的名称)</li>
<li>Coefficients: Regression coefficients, indicating the degree to which an independent variable affects the dependent variable when it increases by one unit. (回归系数，表示自变量每增加一个单位对因变量的影响程度)</li>
<li>Standard errors: Standard error of regression coefficients, measuring the stability of regression coefficients. (回归系数的标准误差，衡量回归系数的稳定性)</li>
<li>t-statistics: t-value of regression coefficients, representing whether a regression coefficient is significantly different from zero and has a significant impact on the dependent variable. (回归系数的t值，代表回归系数是否显著不为0，即是否对因变量有显著影响)</li>
<li>p-values: Significance level of regression coefficients, usually used to determine whether a regression coefficient is significantly different from zero. The smaller the p-value, the more significant the regression coefficient is considered to be. (回归系数的显著性水平，通常用于判断回归系数是否显著不为0，p值越小，表示回归系数越显著)</li>
<li>Observations: Sample size. (样本数量)</li>
<li>R2: Goodness-of-fit measure that represents how much variance in explanatory variables can be explained by model. A higher value indicates better fit between model and data. (拟合优度，表示模型解释变量方差的比例，数值越高表示模型拟合程度越好)</li>
<li>Adjusted R2：A modified version of R2 that takes into account number of independent variables for greater accuracy. (调整后的拟合优度，考虑到自变量的个数，比R2更准确)</li>
<li>Residual standard error：Standard deviation or dispersion measure for residuals; smaller values indicate better model fit. (残差标准误，表示残差的离散程度，越小表示模型越好)</li>
<li>F-statistic：Statistical test used to evaluate overall goodness-of-fit for linear models. (F统计量，用于检验模型整体拟合优度是否显著)</li>
<li>df：Degrees of freedom. (自由度)</li>
<li>Note:p&lt;0.1,p&lt;0.05,p&lt;0.01 : When p-value is less than 0.1, 0.05 or 0.01 respectively,* , ** , *** are used as symbols indicating significance levels for corresponding regressions coefficients. (p&lt;0.1, p&lt;0.05, p&lt;0.01：p值小于0.1，0.05，0.01时，分别用<em>，<strong>，</strong></em>表示，代表回归系数的显著性水平)</li>
</ul>
</details>
</section>
</section>
<section id="two-way-ancova" class="level2">
<h2 class="anchored" data-anchor-id="two-way-ancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3</strong></span> <strong>Two-way ANCOVA</strong></h2>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ANCOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">ANCOVA</figcaption><p></p>
</figure>
</div>
</center>
<section id="question-1" class="level3">
<h3 class="anchored" data-anchor-id="question-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.1</strong></span> <strong>Question</strong></h3>
<p>Previous experiments have shown that both genotype and sex of an organism affect body weight gain. However, a scientist believes that after adjusting for <u>age</u>, there was no significant difference in means of <u>weight</u> gain between groups at different levels of <u>sex</u> and <u>Genotype</u>. Can experiments support this claim?</p>
<ul>
<li>Independent variables:
<ul>
<li>genotype (categorical)</li>
<li>sex (categorical)</li>
<li>age (covariate)</li>
</ul></li>
<li>Dependent variable:
<ul>
<li>Weight gain (continuous)</li>
</ul></li>
</ul>
</section>
<section id="model" class="level3">
<h3 class="anchored" data-anchor-id="model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.2</strong></span> <strong>Model</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>Gain <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/Gain.txt"</span>, <span class="at">header =</span> T)</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Gain, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Weight  Sex Age Genotype Score
1 7.445630 male   1   CloneA     4
2 8.000223 male   2   CloneA     4
3 7.705105 male   3   CloneA     4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Sex <span class="sc">*</span> Age <span class="sc">*</span> Genotype, <span class="at">data =</span> Gain)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Sex * Age * Genotype, data = Gain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40218 -0.12043 -0.01065  0.12592  0.44687 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 7.80053    0.24941  31.276  &lt; 2e-16 ***
Sexmale                    -0.51966    0.35272  -1.473  0.14936    
Age                         0.34950    0.07520   4.648 4.39e-05 ***
GenotypeCloneB              1.19870    0.35272   3.398  0.00167 ** 
GenotypeCloneC             -0.41751    0.35272  -1.184  0.24429    
GenotypeCloneD              0.95600    0.35272   2.710  0.01023 *  
GenotypeCloneE             -0.81604    0.35272  -2.314  0.02651 *  
GenotypeCloneF              1.66851    0.35272   4.730 3.41e-05 ***
Sexmale:Age                -0.11283    0.10635  -1.061  0.29579    
Sexmale:GenotypeCloneB     -0.31716    0.49882  -0.636  0.52891    
Sexmale:GenotypeCloneC     -1.06234    0.49882  -2.130  0.04010 *  
Sexmale:GenotypeCloneD     -0.73547    0.49882  -1.474  0.14906    
Sexmale:GenotypeCloneE     -0.28533    0.49882  -0.572  0.57087    
Sexmale:GenotypeCloneF     -0.19839    0.49882  -0.398  0.69319    
Age:GenotypeCloneB         -0.10146    0.10635  -0.954  0.34643    
Age:GenotypeCloneC         -0.20825    0.10635  -1.958  0.05799 .  
Age:GenotypeCloneD         -0.01757    0.10635  -0.165  0.86970    
Age:GenotypeCloneE         -0.03825    0.10635  -0.360  0.72123    
Age:GenotypeCloneF         -0.05512    0.10635  -0.518  0.60743    
Sexmale:Age:GenotypeCloneB  0.15469    0.15040   1.029  0.31055    
Sexmale:Age:GenotypeCloneC  0.35322    0.15040   2.349  0.02446 *  
Sexmale:Age:GenotypeCloneD  0.19227    0.15040   1.278  0.20929    
Sexmale:Age:GenotypeCloneE  0.13203    0.15040   0.878  0.38585    
Sexmale:Age:GenotypeCloneF  0.08709    0.15040   0.579  0.56616    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2378 on 36 degrees of freedom
Multiple R-squared:  0.9742,    Adjusted R-squared:  0.9577 
F-statistic: 59.06 on 23 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>There are no things like Age:Sex or Age:Genotype, so the slope of weight gain against age does not vary with sex or genotype</li>
<li>In the final minimal adequate model, three main effects were included (Sex, Age, Genotype), so it can be considered that there are intercept differences between gender, age and genotype (intercepts vary).</li>
<li>The final minimal adequate model includes three main effects (Sex, Age, Genotype), but no interaction effect. This means that the effects of these variables are independent and there is no interaction between them.</li>
</ul>
</section>
<section id="one-step-1" class="level3">
<h3 class="anchored" data-anchor-id="one-step-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.3</strong></span> <strong>One step</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">step</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-155.01
Weight ~ Sex * Age * Genotype

                   Df Sum of Sq    RSS     AIC
- Sex:Age:Genotype  5   0.34912 2.3849 -155.51
&lt;none&gt;                          2.0358 -155.01

Step:  AIC=-155.51
Weight ~ Sex + Age + Genotype + Sex:Age + Sex:Genotype + Age:Genotype

               Df Sum of Sq    RSS     AIC
- Sex:Genotype  5  0.146901 2.5318 -161.92
- Age:Genotype  5  0.168136 2.5531 -161.42
- Sex:Age       1  0.048937 2.4339 -156.29
&lt;none&gt;                      2.3849 -155.51

Step:  AIC=-161.92
Weight ~ Sex + Age + Genotype + Sex:Age + Age:Genotype

               Df Sum of Sq    RSS     AIC
- Age:Genotype  5  0.168136 2.7000 -168.07
- Sex:Age       1  0.048937 2.5808 -162.78
&lt;none&gt;                      2.5318 -161.92

Step:  AIC=-168.07
Weight ~ Sex + Age + Genotype + Sex:Age

           Df Sum of Sq    RSS      AIC
- Sex:Age   1     0.049  2.749 -168.989
&lt;none&gt;                   2.700 -168.066
- Genotype  5    54.958 57.658    5.612

Step:  AIC=-168.99
Weight ~ Sex + Age + Genotype

           Df Sum of Sq    RSS      AIC
&lt;none&gt;                   2.749 -168.989
- Sex       1    10.374 13.122  -77.201
- Age       1    10.770 13.519  -75.415
- Genotype  5    54.958 57.707    3.662</code></pre>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Sex + Age + Genotype, data = Gain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40005 -0.15120 -0.01668  0.16953  0.49227 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     7.93701    0.10066  78.851  &lt; 2e-16 ***
Sexmale        -0.83161    0.05937 -14.008  &lt; 2e-16 ***
Age             0.29958    0.02099  14.273  &lt; 2e-16 ***
GenotypeCloneB  0.96778    0.10282   9.412 8.07e-13 ***
GenotypeCloneC -1.04361    0.10282 -10.149 6.21e-14 ***
GenotypeCloneD  0.82396    0.10282   8.013 1.21e-10 ***
GenotypeCloneE -0.87540    0.10282  -8.514 1.98e-11 ***
GenotypeCloneF  1.53460    0.10282  14.925  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2299 on 52 degrees of freedom
Multiple R-squared:  0.9651,    Adjusted R-squared:  0.9604 
F-statistic: 205.7 on 7 and 52 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>From the above output, we can see the coefficients of each genotype and their corresponding significance level (in the Estimate column). It can be observed that GenotypeCloneC and GenotypeCloneE have similar effects on the dependent variable, with coefficients close to -1 and very small significance levels (p-value &lt; 0.001). Therefore, we can combine these two factors into one factor, reducing the number of genotype levels from six to five. The same approach can be applied to B and D.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>newGenotype <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Gain<span class="sc">$</span>Genotype)</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CloneA" "CloneB" "CloneC" "CloneD" "CloneE" "CloneF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="st">"ClonesCandE"</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)] <span class="ot">&lt;-</span> <span class="st">"ClonesBandD"</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(newGenotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CloneA"      "ClonesBandD" "ClonesCandE" "CloneF"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liner regression &amp; compare</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Sex <span class="sc">+</span> Age <span class="sc">+</span> newGenotype, <span class="at">data =</span> Gain)</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2,m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Weight ~ Sex + Age + Genotype
Model 2: Weight ~ Sex + Age + newGenotype
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     52 2.7489                           
2     54 2.9938 -2  -0.24489 2.3163 0.1087</code></pre>
</div>
</div>
<details>
<summary>
Analysis of RSS above
</summary>
In regression models, the residual sum of squares (RSS) represents the unexplained variance in the dependent variable. In this example, the RSS for Model 1 and Model 2 are 2.7489 and 2.9938 respectively. The goal of a model is to minimize RSS because it represents how well the model fits with observed values. Generally, a smaller RSS indicates a better fit for the model. When comparing two models’ fit, one can use both RSS and F-statistic. In this example, although Model 2 has a slightly larger RSS than Model 1, its P-value for F-statistic is 0.1087 which does not reach commonly used significance levels such as 0.05; therefore we cannot reject null hypothesis that Model 2 performs worse than Model 1.
</details>
</section>
<section id="result-1" class="level3">
<h3 class="anchored" data-anchor-id="result-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.4</strong></span> <strong>Result</strong></h3>
<p>As <span class="math inline">\(p=0.1087\)</span>, there is no significant difference between the two models. Therefore, the new model uses NewGenotype (four levels) instead of Genotype (six levels).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Sex + Age + newGenotype, data = Gain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.42651 -0.16687  0.01211  0.18776  0.47736 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             7.93701    0.10308  76.996  &lt; 2e-16 ***
Sexmale                -0.83161    0.06080 -13.679  &lt; 2e-16 ***
Age                     0.29958    0.02149  13.938  &lt; 2e-16 ***
newGenotypeClonesBandD  0.89587    0.09119   9.824 1.28e-13 ***
newGenotypeClonesCandE -0.95950    0.09119 -10.522 1.10e-14 ***
newGenotypeCloneF       1.53460    0.10530  14.574  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2355 on 54 degrees of freedom
Multiple R-squared:  0.962, Adjusted R-squared:  0.9585 
F-statistic: 273.7 on 5 and 54 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting formulas from linear regression models</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(m3, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{Weight}} = 7.94 - 0.83(\operatorname{Sex}_{\operatorname{male}}) + 0.3(\operatorname{Age}) + 0.9(\operatorname{newGenotype}_{\operatorname{ClonesBandD}}) - 0.96(\operatorname{newGenotype}_{\operatorname{ClonesCandE}}) + 1.53(\operatorname{newGenotype}_{\operatorname{CloneF}})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a diagnostic statistical data text table</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(m3, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================
                           Dependent variable:    
                       ---------------------------
                                 Weight           
--------------------------------------------------
Sexmale                         -0.832***         
                                 (0.061)          
                                                  
Age                             0.300***          
                                 (0.021)          
                                                  
newGenotypeClonesBandD          0.896***          
                                 (0.091)          
                                                  
newGenotypeClonesCandE          -0.960***         
                                 (0.091)          
                                                  
newGenotypeCloneF               1.535***          
                                 (0.105)          
                                                  
Constant                        7.937***          
                                 (0.103)          
                                                  
--------------------------------------------------
Observations                       60             
R2                                0.962           
Adjusted R2                       0.959           
Residual Std. Error          0.235 (df = 54)      
F Statistic              273.652*** (df = 5; 54)  
==================================================
Note:                  *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p><a href="#diagnostic%20statistical%20data%20text%20table">The meaning of each parameter in this table</a></p>
</section>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>9.3.5</strong></span> <strong>Visualization</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Weight<span class="sc">~</span>Age,<span class="at">data=</span>Gain,<span class="at">type=</span><span class="st">"n"</span>)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>colours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"red"</span>,<span class="st">"black"</span>,<span class="st">"blue"</span>)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>lines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>symbols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>NewSex<span class="ot">&lt;-</span><span class="fu">as.factor</span>(Gain<span class="sc">$</span>Sex)</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Weight<span class="sc">~</span>Age,<span class="at">data=</span>Gain,<span class="at">pch=</span>symbols[<span class="fu">as.numeric</span>(NewSex)],</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span>colours[<span class="fu">as.numeric</span>(newGenotype)])</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>xv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">coef</span>(m3)[<span class="dv">1</span>]<span class="sc">+</span>(i<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">*</span> <span class="fu">coef</span>(m3)[<span class="dv">2</span>]<span class="sc">+</span>(j<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">coef</span>(m3)[j<span class="sc">+</span><span class="dv">2</span>]</span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">coef</span>(m3)[<span class="dv">3</span>]</span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a>    yv <span class="ot">&lt;-</span> a<span class="sc">+</span>b<span class="sc">*</span>xv</span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(xv,yv,<span class="at">lty=</span>lines[i],<span class="at">col=</span>colours[j]) } }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="mancova" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10</strong></span> <strong>MANCOVA</strong></h1>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/One-Way%20MANCOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">One-Way MANCOVA</figcaption><p></p>
</figure>
</div>
</center>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Two-Way%20MANCOVA.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Two-Way MANCOVA</figcaption><p></p>
</figure>
</div>
</center>
<ul>
<li>Dependent variables: multiple continuous variables</li>
<li>Independent variables: one or multiple categorical variables, one or multiple continuous variables (covariates)</li>
</ul>
<section id="definition-of-mancova" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-mancova"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.1</strong></span> <strong>Definition of MANCOVA</strong></h2>
<p><span style="color:red"><strong>Multivariate Analysis of Covariance (MANCOVA) = multivariate ANCOVA = MANOVA with covariate(s)</strong></span><br> Analysis for the differences among group means for a linear combination of the dependent variables after adjusted for the covariate. Test whether the independent variable(s) has a significant influence on the dependent variables, excluding the influence of the covariate (preferably highly correlated with the dependent variable)</p>
<ul>
<li>Independent Random Sampling: Independence of observations from all other observations.</li>
<li>Level and Measurement of the Variables: The independent variables are categorical and the dependent variables are continuous or scale variables. Covariates are continuous.</li>
<li>Homogeneity of Variance: Variance between groups is equal.</li>
<li>Normality: For each group, each dependent variable follows a normal distribution and any linear combination of dependent variables are normally distributed</li>
</ul>
<details>
<summary>
Brief explanation in Chinese
</summary>
在MANCOVA中，我们有多个因变量（即连续或比例变量），一个或多个自变量（即分类变量），以及一个或多个协变量（即连续变量）。这些变量的测量水平应该正确，并且观察值应该是独立随机采样的。这意味着，我们要确保观察值彼此独立，不受其他变量的影响。同时，我们需要检查每个组的因变量是否都符合正态分布，并且方差应该相等。<br>
如果我们的数据满足这些假设，则可以使用MANCOVA来探索自变量对因变量的影响，并且通过协变量来控制一些其他影响因素的影响。MANCOVA可以更准确地确定组间差异是否真实存在，而不是基于单个因变量的分析来做出判断。 MANCOVA通常用于实验设计，研究人员想要比较多个组的平均得分，同时控制其他因素的影响。
</details>
</section>
<section id="workflow-1" class="level2">
<h2 class="anchored" data-anchor-id="workflow-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2</strong></span> <strong>Workflow</strong></h2>
<section id="question-2" class="level3">
<h3 class="anchored" data-anchor-id="question-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.1</strong></span> <strong>Question</strong></h3>
<p><strong>Example:</strong> Are there differences in productivity (measured by income and hours worked) for individuals in different age groups after adjusted for the education level?</p>
<ul>
<li>Dependent variables:
<ul>
<li>wage (continuous)</li>
<li>age (continuous)</li>
</ul></li>
<li>Independent variables:
<ul>
<li>education (categorical)</li>
<li>year (continuous, covariate)</li>
</ul></li>
</ul>
</section>
<section id="visualization-1" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.2</strong></span> <strong>Visualization</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Wage, <span class="fu">aes</span>(age, wage)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span> <span class="fu">facet_grid</span>(year<span class="sc">~</span>education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-1" class="level3">
<h3 class="anchored" data-anchor-id="model-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.3</strong></span> <strong>Model</strong></h3>
<ul>
<li><code>manova()</code> way</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>wage_manova1 <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(wage, age) <span class="sc">~</span> education <span class="sc">*</span> year, <span class="at">data =</span> Wage)</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>wage_manova1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
   manova(cbind(wage, age) ~ education * year, data = Wage)

Terms:
                education    year education:year Residuals
wage              1226364   16807           2404   3976510
age                  4608     494            724    393723
Deg. of Freedom         4       1              4      2990

Residual standard errors: 36.4683 11.47519
Estimated effects may be unbalanced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(wage_manova1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Response wage :
                 Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
education         4 1226364  306591 230.5306 &lt; 2.2e-16 ***
year              1   16807   16807  12.6374  0.000384 ***
education:year    4    2404     601   0.4519  0.771086    
Residuals      2990 3976510    1330                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response age :
                 Df Sum Sq Mean Sq F value    Pr(&gt;F)    
education         4   4608 1151.90  8.7477 5.108e-07 ***
year              1    494  494.13  3.7525   0.05282 .  
education:year    4    724  180.90  1.3738   0.24043    
Residuals      2990 393723  131.68                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<details>
<summary>
Brief explanation in Chinese
</summary>
根据结果，教育和年份两个因子对 wage 有显著影响，因为它们的 P 值均小于0.05。但是，交互作用项 “education:year” 的 P 值大于0.05，表明这个交互项对 wage 没有显著影响。<br><br> 对于年龄变量，教育和(年份≈0.05)都对其有显著影响，因为它们的 P 值小于0.05。然而，交互项 “education:year” 对 age 没有显著影响，因为其 P 值大于0.05。
</details>
<ul>
<li><code>jmv::mancova()</code> way</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jmv)</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>wage_manova2 <span class="ot">&lt;-</span> jmv<span class="sc">::</span><span class="fu">mancova</span>(<span class="at">data =</span> Wage,</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">deps =</span> <span class="fu">vars</span>(wage, age),</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">factors =</span> education, </span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">covs =</span> year)</span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>wage_manova2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 MANCOVA

 Multivariate Tests                                                                            
 ───────────────────────────────────────────────────────────────────────────────────────────── 
                                      value          F             df1    df2     p            
 ───────────────────────────────────────────────────────────────────────────────────────────── 
   education    Pillai's Trace        0.240590546    102.353675      8    5988    &lt; .0000001   
                Wilks' Lambda           0.7605539    109.739015      8    5986    &lt; .0000001   
                Hotelling's Trace     0.313326457    117.184095      8    5984    &lt; .0000001   
                Roy's Largest Root    0.308447997    230.873326      4    2994    &lt; .0000001   
                                                                                               
   year         Pillai's Trace        0.004790217      7.203065      2    2993     0.0007573   
                Wilks' Lambda           0.9952098      7.203065      2    2993     0.0007573   
                Hotelling's Trace     0.004813274      7.203065      2    2993     0.0007573   
                Roy's Largest Root    0.004813274      7.203065      2    2993     0.0007573   
 ───────────────────────────────────────────────────────────────────────────────────────────── 


 Univariate Tests                                                                                         
 ──────────────────────────────────────────────────────────────────────────────────────────────────────── 
                Dependent Variable    Sum of Squares    df      Mean Square    F             p            
 ──────────────────────────────────────────────────────────────────────────────────────────────────────── 
   education    wage                    1226364.4849       4    306591.1212    230.699570    &lt; .0000001   
                age                        4607.5852       4      1151.8963      8.743336     0.0000005   
   year         wage                      16806.9907       1     16806.9907     12.646699     0.0003821   
                age                         494.1336       1       494.1336      3.750664     0.0528805   
   Residuals    wage                    3978914.2941    2994      1328.9627                               
                age                      394446.4359    2994       131.7456                               
 ──────────────────────────────────────────────────────────────────────────────────────────────────────── </code></pre>
</div>
</div>
<details>
<summary>
Brief explanation in Chinese
</summary>
在 Multivariate Tests 表格中，我们可以看到 education 和 year 这两个自变量的多元假设检验结果。四种统计量都显示了这两个变量的组合对因变量 wage 和 age 有显著影响（p 值 &lt; 0.0001）。<br><br> 在 Univariate Tests 表格中，我们可以看到每个因变量 wage 和 age 的单元假设检验结果。结果显示 education 对 wage 和 age 都有显著影响（p 值 &lt; 0.0001），而 year 只对 wage 有显著影响（p 值 = 0.0004）。值得注意的是，age 的 year 效应在 p 值为 0.0529 的边缘。Residuals 列显示了每个因变量在模型中的残差方差。<br><br> 总体来说，这个 MANCOVA 模型表明，在控制了 education 和 year 之后，wage 和 age 之间存在着相关性，并且 education 和 year 对这种关系都有显著的影响。
</details>
</section>
<section id="result-2" class="level3">
<h3 class="anchored" data-anchor-id="result-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>10.2.4</strong></span> <strong>Result</strong></h3>
<ul>
<li>Since the interaction effect is not significant (p = 0.77 for salary and p = 0.24 for age), the slopes are parallel.</li>
<li>The wage and age differ significantly among education groups (p for both wage and age are far below 0.05).</li>
<li>Differences in salary also significantly (p = 0.00038) increase over time (variable year), due to some economic reasons, while differences in age don’t change (p = 0.053) much.</li>
</ul>
<details>
<summary>
Brief explanation in Chinese
</summary>
<ul>
<li>对于交互作用效应而言，它在wage和age方面的p值分别为0.771086和0.24043，因此交互作用效应不显著。这意味着不同教育水平组之间的工资和年龄差异的斜率是平行的。</li>
<li>对于MANOVA表格中的“Multivariate Tests”部分，education组之间的差异在wage和age方面都显著(p值均远远低于0.05)。</li>
<li>对于ANOVA表格中的“Univariate Tests”部分，随时间的推移，salary方面的差异显著增加(p=0.000384)，而age方面的差异则没有显著变化(p=0.05282)。这表明时间变化是造成salary变化的一个重要原因，而不是年龄变化。</li>
</ul>
</details>
</section>
</section>
</section>
<section id="combining-statistics" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11</strong></span> <strong>Combining statistics</strong></h1>
<section id="combining-means-and-standard-errors" class="level2">
<h2 class="anchored" data-anchor-id="combining-means-and-standard-errors"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.1</strong></span> <strong>Combining means and standard errors</strong></h2>
<p><strong>Example:</strong> Two separate but similar experiments measuring the rate of glucose production of liver cells.<br> <em>Tips: for different group experments we can’t just sum them up and simply calculate the mean and standard error.</em></p>
<ul>
<li>Experiment 1: 4.802, 3.81, 4.004, 4.467, 3.8</li>
<li>Experiment 2: 5.404, 5.256, 4.145, 5.401, 5.622, 4.312</li>
<li>Calculate the overall <span class="math inline">\(n, \bar x, se\)</span></li>
</ul>
<p><strong>If we know the row data:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row data</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.802</span>, <span class="fl">3.81</span>, <span class="fl">4.004</span>, <span class="fl">4.467</span>, <span class="fl">3.8</span>)</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.404</span>, <span class="fl">5.256</span>, <span class="fl">4.145</span>, <span class="fl">5.401</span>, <span class="fl">5.622</span>, <span class="fl">4.312</span>)</span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Form a new dataframe which contains Those columns</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x1)</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(x2)</span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> <span class="fu">c</span>(n1, n2), <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">mean</span>(x1), <span class="fu">mean</span>(x2)), <span class="at">sd =</span> <span class="fu">c</span>(<span class="fu">sd</span>(x1), <span class="fu">sd</span>(x2)))</span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>se <span class="ot">&lt;-</span> dtf<span class="sc">$</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(dtf<span class="sc">$</span>n)</span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>dtf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  n     mean        sd        se
1 5 4.176600 0.4420043 0.1976703
2 6 5.023333 0.6288942 0.2567450</code></pre>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean and standard error</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(x1, x2)</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(x_bar, se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.6384545 0.2070211</code></pre>
</div>
</div>
<p><strong>If we don’t know the row data:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>cmean <span class="ot">&lt;-</span>  <span class="fu">sum</span>(dtf<span class="sc">$</span>mean <span class="sc">*</span> dtf<span class="sc">$</span>n) <span class="sc">/</span> <span class="fu">sum</span>(dtf<span class="sc">$</span>n)</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>cse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">sum</span>(dtf<span class="sc">$</span>n <span class="sc">*</span> ((dtf<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span> dtf<span class="sc">$</span>se <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> dtf<span class="sc">$</span>mean <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">-</span> <span class="fu">sum</span>(dtf<span class="sc">$</span>n <span class="sc">*</span> dtf<span class="sc">$</span>mean) <span class="sc">^</span> <span class="dv">2</span><span class="sc">/</span> <span class="fu">sum</span>(dtf<span class="sc">$</span>n)) <span class="sc">/</span> (<span class="fu">sum</span>(dtf<span class="sc">$</span>n) <span class="sc">*</span> (<span class="fu">sum</span>(dtf<span class="sc">$</span>n) <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(cmean, cse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.6384545 0.2070211</code></pre>
</div>
</div>
</section>
<section id="mean-and-standard-errors-of-sum-and-difference" class="level2">
<h2 class="anchored" data-anchor-id="mean-and-standard-errors-of-sum-and-difference"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.2</strong></span> <strong>Mean and standard errors of sum and difference</strong></h2>
<section id="concepts" class="level3">
<h3 class="anchored" data-anchor-id="concepts"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.2.1</strong></span> <strong>Concepts</strong></h3>
<ul>
<li>First we have two variables <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span></li>
<li>The third variable <span class="math inline">\(x = p + q\)</span></li>
<li>The fourth variable <span class="math inline">\(y = p - q\)</span></li>
<li>When <span class="math inline">\(n_p \neq n_q \neq n\)</span>: <span class="math display">\[\bar x = \bar p + \bar q\]</span> <span class="math display">\[\bar y = \bar p - \bar q\]</span> <span class="math display">\[se_x = se_y = \sqrt{\frac{(n_p - 1)se_p^2 + (n_q - 1)se_q^2}{n_p + n_q - 2} \cdot \frac{n_p + n_q}{n_p n_q}}\]</span></li>
<li>When <span class="math inline">\(n_p = n_q = n\)</span>: <span class="math display">\[se_x = se_y = \sqrt{\frac{se_p^2 + se_q^2}{n}}\]</span></li>
</ul>
</section>
<section id="example-2" class="level3">
<h3 class="anchored" data-anchor-id="example-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.2.2</strong></span> <strong>Example</strong></h3>
<p>A luciferase-based assay is being used to quantify the amount of ATP and ADP in small tissue samples. The amount of ATP (q) is measured directly in 8 samples as <span class="math inline">\(3.25 \pm 0.14 mol g^{-1}\)</span>. A further 10 samples are treated with pyruvate kinase plus phosphoenolpyruvate to convert ADP quantitatively to ATP. The total ATP (p) in these samples is determined to be <span class="math inline">\(4.56 \pm 0.29\mu mol g^{-1}\)</span>. The ADP content is <span class="math inline">\(p - q\)</span>.<br><br> What is the mean and standard error of ADP concentration?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe of example experiment</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="fl">3.25</span>, <span class="fl">4.56</span>), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>), <span class="at">se =</span> <span class="fu">c</span>(<span class="fl">0.14</span>, <span class="fl">0.29</span>))</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mean  n   se
1 3.25  8 0.14
2 4.56 10 0.29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>ADP <span class="ot">&lt;-</span> <span class="fu">diff</span>(x<span class="sc">$</span>mean)</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>cse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">$</span>se <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (x<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> (<span class="fu">sum</span>(x<span class="sc">$</span>n) <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sum</span>(x<span class="sc">$</span>n) <span class="sc">/</span> <span class="fu">prod</span>(x<span class="sc">$</span>n))</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(ADP, cse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.3100000 0.1121306</code></pre>
</div>
</div>
</section>
</section>
<section id="mean-and-standard-error-of-ratios-and-products" class="level2">
<h2 class="anchored" data-anchor-id="mean-and-standard-error-of-ratios-and-products"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.3</strong></span> <strong>Mean and standard error of ratios and products</strong></h2>
<section id="concepts-1" class="level3">
<h3 class="anchored" data-anchor-id="concepts-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.3.1</strong></span> <strong>Concepts</strong></h3>
<ul>
<li>First we have two variables <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span></li>
<li>The third variable <span class="math inline">\(x = p \cdot q\)</span></li>
<li>The fourth variable <span class="math inline">\(y = p / q\)</span> <span class="math display">\[\bar x = \bar p \cdot \bar q\]</span> <span class="math display">\[\bar y = \bar p / \bar q\]</span> <span class="math display">\[se_x = \sqrt{\frac{\bar p^2 n_q se_q^2 + \bar q^2 n_p se_p^2 + n_p se_p^2 n_q se_q^2}{n_p + n_q - 2}}\]</span> <span class="math display">\[se_y = \frac{1}{\bar q} \sqrt {\frac{n_p se_p^2 + n_qse_q^2(\frac{\bar p}{\bar q})^2}{n_p + n_q - 2}}\]</span></li>
</ul>
</section>
<section id="example-3" class="level3">
<h3 class="anchored" data-anchor-id="example-3"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>11.3.2</strong></span> <strong>Example</strong></h3>
<p>In the previous example, we got the concentrations of ATP and ADP in a tissue sample. what is the ratio of [ATP]/[ADP]?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mean =</span> <span class="fu">c</span>(<span class="fl">3.25</span>, ADP), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>), <span class="at">se =</span> <span class="fu">c</span>(<span class="fl">0.14</span>, cse))</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mean  n        se
1 3.25  8 0.1400000
2 1.31 10 0.1121306</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>ratiox <span class="ot">&lt;-</span> x<span class="sc">$</span>mean[<span class="dv">1</span>] <span class="sc">/</span> x<span class="sc">$</span>mean[<span class="dv">2</span>]</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>cse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((x<span class="sc">$</span>n[<span class="dv">1</span>] <span class="sc">*</span> x<span class="sc">$</span>se[<span class="dv">1</span>] <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> x<span class="sc">$</span>n[<span class="dv">2</span>] <span class="sc">*</span> x<span class="sc">$</span>se[<span class="dv">2</span>] <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> ((x<span class="sc">$</span>mean[<span class="dv">1</span>] <span class="sc">/</span> x<span class="sc">$</span>mean[<span class="dv">2</span>]) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> (<span class="fu">sum</span>(x<span class="sc">$</span>n) <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">/</span> x<span class="sc">$</span>mean[<span class="dv">2</span>]</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(ratiox, cse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.4809160 0.1841063</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="non-parametric-hypothesis-tests" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12</strong></span> <strong>Non-parametric hypothesis tests</strong></h1>
<section id="definition" class="level2">
<h2 class="anchored" data-anchor-id="definition"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.1</strong></span> <strong>Definition</strong></h2>
<p><strong>Non-parametric hypothesis tests:</strong><br> A hypothesis test that does not require any specific conditions concerning the shapes of <mark>population distributions</mark> or <mark>the values of population parameters</mark>. When we don’t know the distribution of the population, the it is <mark>easier to perform</mark> than corresponding parametric tests but <mark>less efficient</mark> than parametric tests.</p>
</section>
<section id="wilcoxon-rank-sum-test" class="level2">
<h2 class="anchored" data-anchor-id="wilcoxon-rank-sum-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2</strong></span> <strong>Wilcoxon Rank-Sum test</strong></h2>
<section id="concept-2" class="level3">
<h3 class="anchored" data-anchor-id="concept-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.1</strong></span> <strong>Concept</strong></h3>
<p>Wilcoxon Rank-Sum test, also known as the Mann-Whitney U test, is a non-parametric test for <mark>comparing the equality of the medians of two independent samples</mark>. Its original hypothesis is that the medians of the two samples are equal, and the alternative hypothesis is that the medians of the two samples are not equal.<br></p>
<ul>
<li><span class="math inline">\(H_0\)</span>: the medians of the two populations are equal.
<ul>
<li>Both samples are drawn randomly and independently.</li>
<li>The measures within the two samples are able to be ranked and hence must be continuous, discrete or ordinal.</li>
</ul></li>
</ul>
<p>The basic idea of this test is to combine the two samples, rank them in order of size, and then calculate how many of the rankings in each sample are less than or equal to the value of that sample. The sum of these rankings is then used as the test statistic. If the medians of the two samples are equal, the test statistic should be close to half the sum of the total rankings. If the medians of the two samples are not equal, then the test statistic should be far from half the sum of the total rankings. <span class="math display">\[U=\sum_{i=1}^n \sum_{j=1}^m S\left(X_i, Y_j\right)\]</span> <span class="math display">\[S(X, Y)= \begin{cases}1, &amp; \text { if } X&gt;Y \\ \frac{1}{2}, &amp; \text { if } X=Y \\ 0, &amp; \text { if } X&lt;Y\end{cases}\]</span></p>
<ul>
<li><span class="math inline">\(U\)</span>: The Wilcoxon Rank-Sum test statistic</li>
<li><span class="math inline">\(X_1, \ldots, X_n\)</span>: an independent sample from <span class="math inline">\(X\)</span></li>
<li><span class="math inline">\(Y_1, \ldots, Y_m\)</span>: an independent sample from <span class="math inline">\(Y\)</span></li>
</ul>
</section>
<section id="example-1-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.2</strong></span> <strong>Example-1</strong></h3>
<p><strong>Suppose we have two dataset x and y, calculate the U (U is the smaller rank sum of these two samples):</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row data</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb319-5"><a href="#cb319-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb319-6"><a href="#cb319-6" aria-hidden="true" tabindex="-1"></a><span class="co"># One step</span></span>
<span id="cb319-7"><a href="#cb319-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The outer() function is the function used in R to perform various operations between two vectors, </span></span>
<span id="cb319-8"><a href="#cb319-8" aria-hidden="true" tabindex="-1"></a><span class="co"># returning the result of all operations between all elements of the two vectors.</span></span>
<span id="cb319-9"><a href="#cb319-9" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">outer</span>(x, y, <span class="st">"&gt;"</span>)) <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">outer</span>(x, y, <span class="st">"=="</span>)) <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span>  <span class="fu">sum</span>(<span class="fu">outer</span>(x, y, <span class="st">"&lt;"</span>)) <span class="sc">*</span> <span class="dv">0</span></span>
<span id="cb319-10"><a href="#cb319-10" aria-hidden="true" tabindex="-1"></a>U</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<strong>Here is the distribution of Wilcoxon Rank-Sum test statistic:</strong><br> The larger of the m and n, the U more like normal distribution, approximately normal distribution by:<br> <span class="math display">\[\mu_U = mn/2\]</span> <span class="math display">\[s_U = \sqrt{\frac{mn(m + n + 1)}{12}}\]</span>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Wilcoxon%20Rank-Sum%20test.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Wilcoxon Rank-Sum test</figcaption><p></p>
</figure>
</div>
</center>
If there have ties, <span class="math inline">\(s_U\)</span> need to be corrected as: <span class="math display">\[s_U = \sqrt{\frac{mn(m + n + 1)}{12}  - \frac{mn\sum((T_i - 1) T_i(T_i+1))}{12(m + n)((m+n)^2-1)}}\]</span> <span style="color:gray">
<center>
<em><span class="math inline">\(T_i\)</span> is the number of ties in the ith set of ties</em>
</center>
<p><br></p>
<p>Ties concept:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duplicate value ranking</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rank</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.0 2.5 2.5 4.0</code></pre>
</div>
</div>
</span></section>
<section id="workflow-2" class="level3">
<h3 class="anchored" data-anchor-id="workflow-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.3</strong></span> <strong>Workflow</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One step</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  x and y
W = 4, p-value = 0.8571
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">c</span>(x, y),</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">name =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'x'</span>, <span class="st">'y'</span>), <span class="fu">c</span>(m, n)))</span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(value <span class="sc">~</span> name, <span class="at">data =</span> dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  value by name
W = 4, p-value = 0.8571
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot visualization</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(x, y, <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>U_critical <span class="ot">&lt;-</span> <span class="fu">qwilcox</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), m, n)</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pwilcox</span>(U, m, n) <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8571429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability density function plot visualization</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dwilcox</span>(x, m, n), <span class="at">from =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">to =</span> <span class="dv">15</span>, <span class="at">n =</span> <span class="dv">17</span>, <span class="at">ylab =</span> <span class="st">'Probability distribution density'</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">'S'</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>))</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="fu">c</span>(U, U_critical), <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">x1 =</span> <span class="fu">c</span>(U, U_critical), <span class="at">y1 =</span> <span class="fu">dwilcox</span>(<span class="fu">c</span>(U, U_critical), m, n), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'blue'</span>, <span class="st">'red'</span>, <span class="st">'red'</span>))</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">'Distribution curve'</span>, <span class="st">'Critical values'</span>, <span class="st">'U score'</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'black'</span>, <span class="st">'red'</span>, <span class="st">'blue'</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-74-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-2-1" class="level3">
<h3 class="anchored" data-anchor-id="example-2-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.2.4</strong></span> <strong>Example-2</strong></h3>
<p>The insect spray dataset for C, D and F (just the pick C and D). The number of insects that survived when treated with insecticide treatments.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row data</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>insect <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/InsectSprays.csv"</span>)</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>insect <span class="ot">&lt;-</span> insect[insect<span class="sc">$</span>spray <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"D"</span>), ]</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(bugs <span class="sc">~</span> spray, <span class="at">data =</span> insect, <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>Use Shapiro test to test each of the group we treat to see if they are normal distribution:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">"C"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  insect$bugs[insect$spray == "C"]
W = 0.85907, p-value = 0.04759</code></pre>
</div>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">"D"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  insect$bugs[insect$spray == "D"]
W = 0.75063, p-value = 0.002713</code></pre>
</div>
</div>
<p>Instead, we could test whether the two medians are different:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(insect<span class="sc">$</span>bugs, insect<span class="sc">$</span>spray, median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  C   D 
1.5 5.0 </code></pre>
</div>
</div>
<p><strong><span class="math inline">\(H_0\)</span>:</strong> The median of the survived insects treated by C is equal to that by D.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step by step</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">'C'</span>)</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">'D'</span>)</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">'C'</span>]</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">'D'</span>]</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">outer</span>(x, y, <span class="st">"&gt;"</span>)) <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">outer</span>(x, y, <span class="st">"=="</span>)) <span class="sc">*</span> <span class="fl">0.5</span></span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>U2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">outer</span>(y, x, <span class="st">"&gt;"</span>)) <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">outer</span>(y, x, <span class="st">"=="</span>)) <span class="sc">*</span> <span class="fl">0.5</span></span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">c</span>(U1, U2))</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a>U_critical <span class="ot">&lt;-</span> <span class="fu">qwilcox</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), m, n)</span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pwilcox</span>(U, m, n) <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001829776</code></pre>
</div>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Approximately z distribution</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>U_mu <span class="ot">&lt;-</span> m <span class="sc">*</span> n <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>U_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(m <span class="sc">*</span> n <span class="sc">*</span> (m <span class="sc">+</span> n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">12</span>)</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>z_score <span class="ot">&lt;-</span> (U <span class="sc">-</span> U_mu)<span class="sc">/</span>U_sd</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(z_score) <span class="sc">*</span> <span class="dv">2</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002680172</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine if there is a significant difference between those two sprays</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(<span class="fu">outer</span>(insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">'C'</span>], insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">'D'</span>], <span class="st">"-"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One step</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(bugs <span class="sc">~</span> spray, <span class="at">data =</span> insect, <span class="at">conf.int=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  bugs by spray
W = 20, p-value = 0.002651
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -4.000018 -1.000009
sample estimates:
difference in location 
             -2.999922 </code></pre>
</div>
</div>
<details>
<summary>
The meaning of each parameter in this table
</summary>
<ul>
<li>W: the Wilcoxon test statistic U.</li>
<li>We are 95% certain that the median difference between spray D and C across the population will be between 1 and 4 bugs.</li>
<li>It does not estimate the difference in medians but rather the median of the difference (between the two samples)</li>
</ul>
</details>
<p><strong>Decision:</strong> Reject <span class="math inline">\(H_0\)</span><br> <strong>Conclusion:</strong> There is a significant difference in insecticide effectiveness.</p>
</section>
</section>
<section id="wilcoxon-signed-rank-test" class="level2">
<h2 class="anchored" data-anchor-id="wilcoxon-signed-rank-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.3</strong></span> <strong>Wilcoxon Signed-Rank test</strong></h2>
<section id="concept-3" class="level3">
<h3 class="anchored" data-anchor-id="concept-3"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.3.1</strong></span> <strong>Concept</strong></h3>
<p>Test whether the median of the observed differences deviates enough from zero, based on paired samples. Roughly a <mark>non-parametric version of paired t-test</mark>.<br> <strong><span class="math inline">\(H_0\)</span>:</strong> the medians of the two populations are equal.</p>
</section>
<section id="example-4" class="level3">
<h3 class="anchored" data-anchor-id="example-4"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.3.2</strong></span> <strong>Example</strong></h3>
<p>Ten people take part in a weight-loss program. They weigh before starting the program, and weigh again after the one-month program. Does the program have effect on the weight?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row data</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>wl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">c</span>(<span class="dv">198</span>, <span class="dv">201</span>, <span class="dv">210</span>, <span class="dv">185</span>, <span class="dv">204</span>, <span class="dv">156</span>, <span class="dv">167</span>, <span class="dv">197</span>, <span class="dv">220</span>, <span class="dv">186</span>),</span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">c</span>(<span class="dv">194</span>, <span class="dv">203</span>, <span class="dv">200</span>, <span class="dv">183</span>, <span class="dv">200</span>, <span class="dv">153</span>, <span class="dv">166</span>, <span class="dv">197</span>, <span class="dv">215</span>, <span class="dv">184</span>))</span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step by step</span></span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(wl)</span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> wl<span class="sc">$</span>after <span class="sc">-</span> wl<span class="sc">$</span>before</span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="fu">abs</span>(d)) <span class="sc">*</span> <span class="fu">abs</span>(d) <span class="sc">/</span> d <span class="co"># signed ranks of the differences</span></span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">sum</span>(R, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a>sW <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">6</span>) <span class="co"># population standard deviation of W</span></span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (<span class="fu">abs</span>(W) <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> sW</span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>z_critical <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) <span class="co"># alpha = 0.05</span></span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02040075</code></pre>
</div>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One step</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(wl<span class="sc">$</span>before, wl<span class="sc">$</span>after, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test

data:  wl$before and wl$after
V = 42, p-value = 0.02032
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 0.9999463 6.0000301
sample estimates:
(pseudo)median 
       3.00007 </code></pre>
</div>
</div>
<p><strong>Decision:</strong> As <span class="math inline">\(p &lt; 0.05\)</span>, reject <span class="math inline">\(H_0\)</span>.<br> <strong>Conclusion:</strong> The two population medians are different at <span class="math inline">\(\alpha = 0.05\)</span>. The program has effect on the weight.</p>
</section>
</section>
<section id="kruskal-wallis-test" class="level2">
<h2 class="anchored" data-anchor-id="kruskal-wallis-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.4</strong></span> <strong>Kruskal-Wallis test</strong></h2>
<section id="concept-4" class="level3">
<h3 class="anchored" data-anchor-id="concept-4"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.4.1</strong></span> <strong>Concept</strong></h3>
<p>Test whether three or more population medians are equal. Roughly a <mark>non-parametric version of ANOVA</mark><br> <strong><span class="math inline">\(H_0\)</span>:</strong> the medians of the populations are equal.</p>
</section>
<section id="example-5" class="level3">
<h3 class="anchored" data-anchor-id="example-5"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.4.2</strong></span> <strong>Example</strong></h3>
<p>The insect spray dataset for C, D, and F. The number of insects that survived when treated with insecticide treatments.<br> Do any difference in the number of insects that survived when treated with multiple available insecticide treatments?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row data</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>insect <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/InsectSprays.csv"</span>)</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(bugs <span class="sc">~</span> spray, <span class="at">data =</span> insect, <span class="at">horizontal =</span> <span class="cn">TRUE</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">"C"</span>])  <span class="co"># Normal distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  insect$bugs[insect$spray == "C"]
W = 0.85907, p-value = 0.04759</code></pre>
</div>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">"D"</span>])  <span class="co"># Normal distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  insect$bugs[insect$spray == "D"]
W = 0.75063, p-value = 0.002713</code></pre>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(insect<span class="sc">$</span>bugs[insect<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">"F"</span>])  <span class="co"># Not normal distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  insect$bugs[insect$spray == "F"]
W = 0.88475, p-value = 0.1009</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine if there is a significant difference between those three sprays</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(insect<span class="sc">$</span>bugs, insect<span class="sc">$</span>spray, median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   C    D    F 
 1.5  5.0 15.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One step</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(bugs <span class="sc">~</span> spray, <span class="at">data =</span> insect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  bugs by spray
Kruskal-Wallis chi-squared = 26.866, df = 2, p-value = 1.466e-06</code></pre>
</div>
</div>
<p><strong>Decision:</strong> As <span class="math inline">\(p &lt; 0.05\)</span>, reject H0.<br> <strong>Conclusion:</strong> There is a significant difference in insecticide effectiveness.</p>
</section>
</section>
<section id="friedmans-test" class="level2">
<h2 class="anchored" data-anchor-id="friedmans-test"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.5</strong></span> <strong>Friedman’s test</strong></h2>
<section id="concept-5" class="level3">
<h3 class="anchored" data-anchor-id="concept-5"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.5.1</strong></span> <strong>Concept</strong></h3>
<p>Test whether three or more population medians are equal for repeated measures. Roughly a <mark>non-parametric version of repeated measures ANOVA</mark>. <u>More powerful than ANOVA for very skewed (heavy tail) distributions</u>. <span class="math display">\[F_{r}=\frac{12}{n k(k+1)}\left(T_{1}^{2}+T_{2}^{2}+\ldots+T_{k}^{2}\right)-3 n(k+1)\]</span></p>
</section>
<section id="example-6" class="level3">
<h3 class="anchored" data-anchor-id="example-6"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>12.5.2</strong></span> <strong>Example</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Row data</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">c</span>(<span class="dv">198</span>, <span class="dv">201</span>, <span class="dv">210</span>, <span class="dv">185</span>, <span class="dv">204</span>, <span class="dv">156</span>, <span class="dv">167</span>, <span class="dv">197</span>, <span class="dv">220</span>, <span class="dv">186</span>),</span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">one =</span> <span class="fu">c</span>(<span class="dv">194</span>, <span class="dv">203</span>, <span class="dv">200</span>, <span class="dv">183</span>, <span class="dv">200</span>, <span class="dv">153</span>, <span class="dv">166</span>, <span class="dv">197</span>, <span class="dv">215</span>, <span class="dv">184</span>),</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">two =</span> <span class="fu">c</span>(<span class="dv">191</span>, <span class="dv">200</span>, <span class="dv">192</span>, <span class="dv">180</span>, <span class="dv">195</span>, <span class="dv">150</span>, <span class="dv">167</span>, <span class="dv">195</span>, <span class="dv">209</span>, <span class="dv">179</span>),</span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">three =</span> <span class="fu">c</span>(<span class="dv">188</span>, <span class="dv">196</span>, <span class="dv">188</span>, <span class="dv">178</span>, <span class="dv">191</span>, <span class="dv">145</span>, <span class="dv">166</span>, <span class="dv">192</span>, <span class="dv">205</span>, <span class="dv">175</span>)</span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dtf) <span class="ot">&lt;-</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ncol</span>(dtf)</span>
<span id="cb361-10"><a href="#cb361-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate the Friedman test statistic:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rank of each group</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>dtf_rank <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(dtf, <span class="at">MARGIN =</span> <span class="dv">1</span>, rank))</span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>dtf_rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  before one two three
A    4.0 3.0 2.0   1.0
B    3.0 4.0 2.0   1.0
C    4.0 3.0 2.0   1.0
D    4.0 3.0 2.0   1.0
E    4.0 3.0 2.0   1.0
F    4.0 3.0 2.0   1.0
G    3.5 1.5 3.5   1.5
H    3.5 3.5 2.0   1.0
I    4.0 3.0 2.0   1.0
J    4.0 3.0 2.0   1.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Method-1 of Chi-square value</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>rank_sum <span class="ot">&lt;-</span> <span class="fu">colSums</span>(dtf_rank)</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>chi_sq <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">/</span> (n <span class="sc">*</span> k <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>(rank_sum <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> n <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Method-2 of Chi-square value</span></span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>rank_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(dtf_rank)</span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>rank_overall <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>ssb <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">sum</span>((rank_mean <span class="sc">-</span> rank_overall) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>chi_sq <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">*</span> ssb <span class="sc">/</span> (k <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>chi_sq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Critical point</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>chi_critical <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.05</span>, <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>chi_critical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.814728</code></pre>
</div>
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P-value</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chi_sq, <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>p_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.551501e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># One step</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(<span class="fu">as.matrix</span>(dtf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Friedman rank sum test

data:  as.matrix(dtf)
Friedman chi-squared = 25.763, df = 3, p-value = 1.069e-05</code></pre>
</div>
</div>
<p><span style="color:gray">Tips: the sample is too small, so the results calculated manually may different from those using the R function which uses more accurate mathematical methods to calculate the value of the statistic.</span></p>
</section>
</section>
</section>
<section id="multiple-linear-regression" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13</strong></span> <strong>Multiple linear regression</strong></h1>
<section id="definition-1" class="level2">
<h2 class="anchored" data-anchor-id="definition-1"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.1</strong></span> <strong>Definition</strong></h2>
<ul>
<li><p><strong>Linear Regression:</strong> A statistical method to determine the independent quantitative relationship between one or more predictor variables and one dependent variable.</p>
<ul>
<li><strong>Simple Linear Regression:</strong> Only <mark>one</mark> predictor variable.</li>
<li><strong>Multiple linear regression:</strong> <mark>Two or more</mark> predictor variables.</li>
</ul></li>
<li><p><strong>Selection</strong> of predictor variables:</p>
<ul>
<li>The predictor variables must have a significant influence on the dependent variable and show a close linear correlation.</li>
<li>The predictor variables should be mutually exclusive. The degree of correlation between independent variables should not be higher than the degree of correlation between independent variables and dependent variables.</li>
<li>The predictor variables should have complete statistical data, and their predicted values can be easily determined.</li>
</ul></li>
<li><p><strong>Model:</strong> <span class="math display">\[\begin{array}{*{20}{l}}
{{y_1} = {\beta _0} + {\beta _1}{X_{11}} + {\beta _2}{X_{12}}... + {\beta _k}{X_{1k}} + {\varepsilon _1}}\\
{{y_2} = {\beta _0} + {\beta _1}{X_{21}} + {\beta _2}{X_{22}}... + {\beta _k}{X_{2k}} + {\varepsilon _2}}\\
{....}\\
{y_i} = {\beta _0} + {\beta _1}{X_{i1}} + {\beta _2}{X_{i2}}... + {\beta _k}{X_{ik}} + {\varepsilon _i}\\
....\\
y_n = {\beta _0} + {\beta _1}{X_{n1}} + {\beta _2}{X_{n2}}... + {\beta _k}{X_{nk}} + \varepsilon _n
\end{array}\]</span> <span class="math display">\[\begin{array}{*{20}{l}}
{\begin{array}{*{20}{l}}
{{\bf{Y = (}}{{\bf{y}}_{\bf{1}}}{\bf{,}}{{\bf{y}}_{\bf{2}}}{\bf{,}}...{\bf{,}}{{\bf{y}}_{\bf{n}}}{{\bf{)}}^{\bf{T}}}}\\
{{\bf{\beta  = (}}{{\bf{\beta }}_{\bf{1}}}{\bf{,}}{{\bf{\beta }}_{\bf{2}}}{\bf{,}}...{\bf{,}}{{\bf{\beta }}_{\bf{k}}}{{\bf{)}}^{\bf{T}}}}
\end{array}}\\
{{\bf{\varepsilon  = (}}{{\bf{\varepsilon }}_{\bf{1}}}{\bf{,}}{{\bf{\varepsilon }}_{\bf{2}}}{\bf{,}}...{\bf{,}}{{\bf{\varepsilon }}_{\bf{n}}}{{\bf{)}}^{\bf{T}}}}
\end{array}\]</span> <span class="math display">\[{\bf{X}} = \left( {\begin{array}{*{20}{c}}
1 &amp; {X_{11}}&amp; {X_{12}} &amp; \ldots &amp;{{X_{1k}}}\\
\vdots&amp;\vdots &amp;\vdots&amp; \ddots &amp; \vdots \\
1&amp; {X_{n1}}&amp;{X_{n2}}&amp;\cdots&amp;{{X_{nk}}}
\end{array}} \right)\]</span> <span class="math display">\[\bf{Y = X\beta  + \varepsilon }\]</span></p>
<ul>
<li><span class="math inline">\(X\)</span>: predictor variable</li>
<li><span class="math inline">\(y\)</span>: dependent variable</li>
<li><span class="math inline">\(\beta_k\)</span>: regression coefficient</li>
<li><span class="math inline">\(\epsilon\)</span>: effect of other random factors.</li>
<li>The least-squares estimator of <span class="math inline">\(\beta\)</span>: <span class="math display">\[\bf{\beta  = (X'X)^{-1}X'Y}\]</span></li>
<li>The least square estimation of random error variance: <span class="math display">\[{\sigma ^2}{\rm{ = }}\frac{{{e^T}e}}{{n - k - 1}}\]</span></li>
</ul></li>
<li><p>Workflow:</p>
<ul>
<li>Fit the model by <code>lm()</code></li>
<li>Diagnose the model by <code>summary()</code></li>
<li>Optimize the model by <code>step()</code></li>
</ul></li>
</ul>
</section>
<section id="visualization-2" class="level2">
<h2 class="anchored" data-anchor-id="visualization-2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.2</strong></span> <strong>Visualization</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the dataset which is about the US Crime Data</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(usc, <span class="at">package =</span> <span class="st">"ACSWR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the pair plot to visualize the correlation</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="do">## pairs(usc)</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(usc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From the plot above, we can calculate that there have high correlation coefficient between Ex0 and Ex1</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(usc<span class="sc">$</span>Ex0,usc<span class="sc">$</span>Ex1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9935865</code></pre>
</div>
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the correlation coefficient directly</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>ucor <span class="ot">&lt;-</span> <span class="fu">cor</span>(usc)</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a>ucor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              R         Age           S          Ed         Ex0         Ex1
R    1.00000000 -0.08947240 -0.09063696  0.32283487  0.68760446  0.66671414
Age -0.08947240  1.00000000  0.58435534 -0.53023964 -0.50573690 -0.51317336
S   -0.09063696  0.58435534  1.00000000 -0.70274132 -0.37263633 -0.37616753
Ed   0.32283487 -0.53023964 -0.70274132  1.00000000  0.48295213  0.49940958
Ex0  0.68760446 -0.50573690 -0.37263633  0.48295213  1.00000000  0.99358648
Ex1  0.66671414 -0.51317336 -0.37616753  0.49940958  0.99358648  1.00000000
LF   0.18886635 -0.16094882 -0.50546948  0.56117795  0.12149320  0.10634960
M    0.21391426 -0.02867993 -0.31473291  0.43691492  0.03376027  0.02284250
N    0.33747406 -0.28063762 -0.04991832 -0.01722740  0.52628358  0.51378940
NW   0.03259884  0.59319826  0.76710262 -0.66488190 -0.21370878 -0.21876821
U1  -0.05047792 -0.22438060 -0.17241931  0.01810345 -0.04369761 -0.05171199
U2   0.17732065 -0.24484339  0.07169289 -0.21568155  0.18509304  0.16922422
W    0.44131995 -0.67005506 -0.63694543  0.73599704  0.78722528  0.79426205
X   -0.17902373  0.63921138  0.73718106 -0.76865789 -0.63050025 -0.64815183
            LF           M           N          NW          U1          U2
R    0.1888663  0.21391426  0.33747406  0.03259884 -0.05047792  0.17732065
Age -0.1609488 -0.02867993 -0.28063762  0.59319826 -0.22438060 -0.24484339
S   -0.5054695 -0.31473291 -0.04991832  0.76710262 -0.17241931  0.07169289
Ed   0.5611780  0.43691492 -0.01722740 -0.66488190  0.01810345 -0.21568155
Ex0  0.1214932  0.03376027  0.52628358 -0.21370878 -0.04369761  0.18509304
Ex1  0.1063496  0.02284250  0.51378940 -0.21876821 -0.05171199  0.16922422
LF   1.0000000  0.51355879 -0.12367222 -0.34121444 -0.22939968 -0.42076249
M    0.5135588  1.00000000 -0.41062750 -0.32730454  0.35189190 -0.01869169
N   -0.1236722 -0.41062750  1.00000000  0.09515301 -0.03811995  0.27042159
NW  -0.3412144 -0.32730454  0.09515301  1.00000000 -0.15645002  0.08090829
U1  -0.2293997  0.35189190 -0.03811995 -0.15645002  1.00000000  0.74592482
U2  -0.4207625 -0.01869169  0.27042159  0.08090829  0.74592482  1.00000000
W    0.2946323  0.17960864  0.30826271 -0.59010707  0.04485720  0.09207166
X   -0.2698865 -0.16708869 -0.12629357  0.67731286 -0.06383218  0.01567818
              W           X
R    0.44131995 -0.17902373
Age -0.67005506  0.63921138
S   -0.63694543  0.73718106
Ed   0.73599704 -0.76865789
Ex0  0.78722528 -0.63050025
Ex1  0.79426205 -0.64815183
LF   0.29463231 -0.26988646
M    0.17960864 -0.16708869
N    0.30826271 -0.12629357
NW  -0.59010707  0.67731286
U1   0.04485720 -0.06383218
U2   0.09207166  0.01567818
W    1.00000000 -0.88399728
X   -0.88399728  1.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the correlation plot divided by two part (numerical &amp; graphic)</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(ucor, <span class="at">order =</span> <span class="st">'AOE'</span>, <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">method =</span> <span class="st">"number"</span>)</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(ucor, <span class="at">order =</span> <span class="st">"AOE"</span>, <span class="at">type =</span> <span class="st">"lower"</span>, <span class="at">method =</span> <span class="st">"ell"</span>, </span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag =</span> <span class="cn">FALSE</span>, <span class="at">tl.pos =</span> <span class="st">"n"</span>, <span class="at">cl.pos =</span> <span class="st">"n"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-84-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-the-model" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3</strong></span> <strong>Fit the model</strong></h2>
<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3.1</strong></span> <strong>Analysis</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do linear regression</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(R <span class="sc">~</span> ., <span class="at">data =</span> usc)</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(crime_rate_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = R ~ ., data = usc)

Residuals:
    Min      1Q  Median      3Q     Max 
-34.884 -11.923  -1.135  13.495  50.560 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -6.918e+02  1.559e+02  -4.438 9.56e-05 ***
Age          1.040e+00  4.227e-01   2.460  0.01931 *  
S           -8.308e+00  1.491e+01  -0.557  0.58117    
Ed           1.802e+00  6.496e-01   2.773  0.00906 ** 
Ex0          1.608e+00  1.059e+00   1.519  0.13836    
Ex1         -6.673e-01  1.149e+00  -0.581  0.56529    
LF          -4.103e-02  1.535e-01  -0.267  0.79087    
M            1.648e-01  2.099e-01   0.785  0.43806    
N           -4.128e-02  1.295e-01  -0.319  0.75196    
NW           7.175e-03  6.387e-02   0.112  0.91124    
U1          -6.017e-01  4.372e-01  -1.376  0.17798    
U2           1.792e+00  8.561e-01   2.093  0.04407 *  
W            1.374e-01  1.058e-01   1.298  0.20332    
X            7.929e-01  2.351e-01   3.373  0.00191 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.94 on 33 degrees of freedom
Multiple R-squared:  0.7692,    Adjusted R-squared:  0.6783 
F-statistic: 8.462 on 13 and 33 DF,  p-value: 3.686e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computes confidence intervals for each parameters in this linear regression model</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(crime_rate_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    2.5 %       97.5 %
(Intercept) -1.008994e+03 -374.6812339
Age          1.798032e-01    1.8998161
S           -3.864617e+01   22.0295401
Ed           4.798774e-01    3.1233247
Ex0         -5.460558e-01    3.7616925
Ex1         -3.004455e+00    1.6699389
LF          -3.532821e-01    0.2712200
M           -2.623148e-01    0.5919047
N           -3.047793e-01    0.2222255
NW          -1.227641e-01    0.1371135
U1          -1.491073e+00    0.2877222
U2           5.049109e-02    3.5340347
W           -7.795484e-02    0.3526718
X            3.146483e-01    1.2712173</code></pre>
</div>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute analysis of variance tables for this linear regression model</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(crime_rate_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: R
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Age        1   550.8   550.8  1.1448 0.2924072    
S          1   153.7   153.7  0.3194 0.5757727    
Ed         1  9056.7  9056.7 18.8221 0.0001275 ***
Ex0        1 30760.3 30760.3 63.9278 3.182e-09 ***
Ex1        1  1530.2  1530.2  3.1802 0.0837349 .  
LF         1   611.3   611.3  1.2705 0.2677989    
M          1  1110.0  1110.0  2.3069 0.1383280    
N          1   426.5   426.5  0.8864 0.3533080    
NW         1   142.0   142.0  0.2951 0.5906485    
U1         1    70.7    70.7  0.1468 0.7040339    
U2         1  2696.6  2696.6  5.6043 0.0239336 *  
W          1   347.5   347.5  0.7221 0.4015652    
X          1  5474.2  5474.2 11.3768 0.0019126 ** 
Residuals 33 15878.7   481.2                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3.2</strong></span> <strong>Conclusion</strong></h3>
<ul>
<li>The intercept terms, Age, ED, U2, and X are significant variables to explain the crime rate. The 95% confidence intervals also confirm it.</li>
<li>The model is significant: <span class="math inline">\(p &lt; 0.05\)</span>, adjusted <span class="math inline">\(R^2 = 0.6783\)</span>.</li>
</ul>
</section>
<section id="the-difference-between-r2-and-adj-r2" class="level3">
<h3 class="anchored" data-anchor-id="the-difference-between-r2-and-adj-r2"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.3.3</strong></span> <strong>The difference between <span class="math inline">\(R^2\)</span> and Adj-<span class="math inline">\(R^2\)</span></strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>get_R2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, method){</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(usc<span class="sc">$</span>R <span class="sc">~</span> <span class="fu">as.matrix</span>(usc[, <span class="dv">2</span><span class="sc">:</span>x])))[[method]], <span class="dv">3</span>)</span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>dtf_R2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>,</span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">R2 =</span> <span class="fu">sapply</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>, get_R2, <span class="at">method =</span> <span class="st">'r.squared'</span>),</span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">AdjR2 =</span> <span class="fu">sapply</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>, get_R2, <span class="at">method =</span> <span class="st">'adj.r.squared'</span>))</span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a>dtf_R2 <span class="sc">|&gt;</span> </span>
<span id="cb385-10"><a href="#cb385-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>n) <span class="sc">|&gt;</span> </span>
<span id="cb385-11"><a href="#cb385-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb385-12"><a href="#cb385-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(n, value, <span class="at">col =</span> name)) <span class="sc">+</span> </span>
<span id="cb385-13"><a href="#cb385-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(n, value, <span class="at">col =</span> name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="evaluate-improve-the-model" class="level2">
<h2 class="anchored" data-anchor-id="evaluate-improve-the-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4</strong></span> <strong>Evaluate &amp; improve the model</strong></h2>
<section id="issue" class="level3">
<h3 class="anchored" data-anchor-id="issue"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4.1</strong></span> <strong>Issue</strong></h3>
<p><mark><strong>Multicollinearity:</strong></mark></p>
<ul>
<li>multi-: multiple columns</li>
<li>col-: relationship</li>
<li>linearity: linear</li>
</ul>
<p><strong>Problems:</strong></p>
<ol type="1">
<li>Imprecise estimates of <span class="math inline">\(\beta\)</span></li>
<li>The t-tests may fail to reveal significant factors</li>
<li>Missing importance of predictors</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Single linear regression</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Euphorbiaceae, <span class="at">package =</span> <span class="st">'gpk'</span>)</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>dtf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> Euphorbiaceae<span class="sc">$</span>GBH,</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> Euphorbiaceae<span class="sc">$</span>Height)</span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> dtf) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = dtf)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.369  -5.543  -1.566   5.707  28.086 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.76295    2.15471   4.067 9.29e-05 ***
x1           0.30303    0.03612   8.390 2.56e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.417 on 104 degrees of freedom
Multiple R-squared:  0.4037,    Adjusted R-squared:  0.3979 
F-statistic:  70.4 on 1 and 104 DF,  p-value: 2.564e-13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiply linear regression</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>dtf<span class="sc">$</span>x2 <span class="ot">&lt;-</span> <span class="fu">jitter</span>(dtf<span class="sc">$</span>x)  <span class="co"># Add some random error to data</span></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dtf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ENV222-note_files/figure-html/unnamed-chunk-87-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> dtf) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = dtf)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.059  -6.226  -1.546   5.938  28.393 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    8.956      2.165   4.136 7.22e-05 ***
x1            -7.175      7.870  -0.912    0.364    
x2             7.476      7.867   0.950    0.344    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.422 on 103 degrees of freedom
Multiple R-squared:  0.4088,    Adjusted R-squared:  0.3974 
F-statistic: 35.62 on 2 and 103 DF,  p-value: 1.748e-12</code></pre>
</div>
</div>
<p><a id="Variance inflation factor (VIF)" href=""></a></p>
</section>
<section id="variance-inflation-factor-vif" class="level3">
<h3 class="anchored" data-anchor-id="variance-inflation-factor-vif"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4.2</strong></span> <strong>Variance inflation factor (VIF)</strong></h3>
<p><span class="math display">\[\mathrm{VIF}_j = \frac{1}{1-R_j^2}\]</span></p>
<ul>
<li><span class="math inline">\(\mathrm{VIF}_j\)</span><strong>:</strong> <span class="math inline">\(VIF\)</span> for the <span class="math inline">\(j\)</span>-th variable</li>
<li><span class="math inline">\(R^2_j\)</span><strong>:</strong> <span class="math inline">\(R^2\)</span> from the regression of the <span class="math inline">\(j\)</span>-th explanatory variable on the remaining explanatory variables.</li>
</ul>
<p>Remove the <code>R</code> from usc dataset:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>uscrimewor <span class="ot">&lt;-</span> usc[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(uscrimewor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Age" "S"   "Ed"  "Ex0" "Ex1" "LF"  "M"   "N"   "NW"  "U1"  "U2"  "W"  
[13] "X"  </code></pre>
</div>
</div>
<p>Calculate the <span class="math inline">\(VIF\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the VIF for Ex0</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>usc_lm_Ex0 <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Ex0  <span class="sc">~</span> ., <span class="at">data =</span> uscrimewor))</span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> usc_lm_Ex0<span class="sc">$</span>r.squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 94.63312</code></pre>
</div>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute all of the VIF</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>faraway<span class="sc">::</span><span class="fu">vif</span>(uscrimewor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Age         S        Ed       Ex0       Ex1        LF         M         N 
 2.698021  4.876751  5.049442 94.633118 98.637233  3.677557  3.658444  2.324326 
       NW        U1        U2         W         X 
 4.123274  5.938264  4.997617  9.968958  8.409449 </code></pre>
</div>
</div>
<p><mark><strong>Filter:</strong> <span class="math inline">\(VIF &gt; 10\)</span> (<span class="math inline">\(R^2 &gt; 0.9\)</span>)</mark><br><br> Drop the variable with highest <span class="math inline">\(VIF\)</span> and then update the model until all <span class="math inline">\(VIF \leq 10\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a>uscrimewor2 <span class="ot">&lt;-</span> uscrimewor[, <span class="fu">c</span>(<span class="st">'Age'</span>,<span class="st">'S'</span>,<span class="st">'Ed'</span>,<span class="st">'Ex0'</span>,<span class="st">'LF'</span>,<span class="st">'M'</span>,<span class="st">'N'</span>,<span class="st">'NW'</span>,<span class="st">'U1'</span>,<span class="st">'U2'</span>,<span class="st">'W'</span>,<span class="st">'X'</span>)]</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>faraway<span class="sc">::</span><span class="fu">vif</span>(uscrimewor2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Age        S       Ed      Ex0       LF        M        N       NW 
2.670798 4.864533 4.822240 5.109739 3.414298 3.657629 2.321929 3.963407 
      U1       U2        W        X 
5.912063 4.982983 9.955587 8.354136 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>crime_rate_lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(R <span class="sc">~</span> Age <span class="sc">+</span> S <span class="sc">+</span> Ed <span class="sc">+</span> Ex0 <span class="sc">+</span> LF <span class="sc">+</span> M <span class="sc">+</span> N <span class="sc">+</span> NW <span class="sc">+</span> U1 <span class="sc">+</span> U2 <span class="sc">+</span> W <span class="sc">+</span> X, usc)</span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(crime_rate_lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = R ~ Age + S + Ed + Ex0 + LF + M + N + NW + U1 + 
    U2 + W + X, data = usc)

Residuals:
   Min     1Q Median     3Q    Max 
-38.76 -13.59   1.09  13.25  48.93 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -7.041e+02  1.529e+02  -4.604 5.58e-05 ***
Age          1.064e+00  4.165e-01   2.556 0.015226 *  
S           -7.875e+00  1.475e+01  -0.534 0.596823    
Ed           1.722e+00  6.286e-01   2.739 0.009752 ** 
Ex0          1.010e+00  2.436e-01   4.145 0.000213 ***
LF          -1.718e-02  1.464e-01  -0.117 0.907297    
M            1.630e-01  2.079e-01   0.784 0.438418    
N           -3.886e-02  1.282e-01  -0.303 0.763604    
NW          -1.299e-04  6.200e-02  -0.002 0.998340    
U1          -5.848e-01  4.319e-01  -1.354 0.184674    
U2           1.819e+00  8.465e-01   2.149 0.038833 *  
W            1.351e-01  1.047e-01   1.290 0.205711    
X            8.040e-01  2.320e-01   3.465 0.001453 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.72 on 34 degrees of freedom
Multiple R-squared:  0.7669,    Adjusted R-squared:  0.6846 
F-statistic:  9.32 on 12 and 34 DF,  p-value: 1.351e-07</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> The 12 explanatory variables account for 76.7% of the variability in the crime rates of the 47 states.</p>
</section>
<section id="eigen-system-analysis" class="level3">
<h3 class="anchored" data-anchor-id="eigen-system-analysis"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.4.3</strong></span> <strong>Eigen System Analysis</strong></h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>uscrimewor <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(uscrimewor)</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>usc_stan <span class="ot">&lt;-</span> <span class="fu">scale</span>(uscrimewor)</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>x1x_stan <span class="ot">&lt;-</span> <span class="fu">t</span>(usc_stan) <span class="sc">%*%</span> usc_stan</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>usc_eigen <span class="ot">&lt;-</span> <span class="fu">eigen</span>(x1x_stan)</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>usc_kappa <span class="ot">&lt;-</span> <span class="fu">max</span>(usc_eigen<span class="sc">$</span>values) <span class="sc">/</span> <span class="fu">min</span>(usc_eigen<span class="sc">$</span>values)  <span class="co"># Condition number k</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span class="math inline">\(k\)</span> &lt; 100: no multicollinearity</li>
<li>100 &lt; <span class="math inline">\(k\)</span> &lt; 1000: moderate multicollinearity</li>
<li><span class="math inline">\(k\)</span> &gt; 1000: severe multicollinearity</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>usec_index <span class="ot">&lt;-</span> <span class="fu">max</span>(usc_eigen<span class="sc">$</span>values) <span class="sc">/</span> usc_eigen<span class="sc">$</span>values  <span class="co"># Condition indices</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>usc_eigen<span class="sc">$</span>vectors[, usec_index <span class="sc">&gt;</span> <span class="dv">1000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.010618030 -0.005195201  0.032819351  0.698089398 -0.713641697
 [6] -0.033483032 -0.003217082 -0.008582334  0.022697876 -0.004346733
[11] -0.013567474 -0.003024453 -0.015409343</code></pre>
</div>
</div>
<p>We still don’t know which one should be remove, so we’d better use <a href="#Variance%20inflation%20factor%20(VIF)">Variance inflation factor (VIF)</a>.</p>
</section>
</section>
<section id="simply-the-model" class="level2">
<h2 class="anchored" data-anchor-id="simply-the-model"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5</strong></span> <strong>Simply the model</strong></h2>
<section id="backward-selection" class="level3">
<h3 class="anchored" data-anchor-id="backward-selection"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.1</strong></span> <strong>Backward selection</strong></h3>
<ol type="1">
<li>Start with all the predictors in the model.</li>
<li>Remove the predictor with highest p-value greater than <span class="math inline">\(\alpha\)</span> (= 0.05 usually).</li>
<li>Refit the model and go to 2.</li>
<li>Stop when all p-values are less than <span class="math inline">\(\alpha\)</span>.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This function is used to calculate the coefficients of the linear regression model and sort them from largest to smallest by P-value</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>get_p <span class="ot">&lt;-</span> <span class="cf">function</span>(model){</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>  smry2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>coefficients)</span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>  smry2[<span class="fu">order</span>(<span class="sc">-</span>smry2<span class="sc">$</span>Pr...t..), ]</span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate   Std..Error      t.value     Pr...t..
NW          -1.299152e-04   0.06200366 -0.002095283 9.983405e-01
LF          -1.717960e-02   0.14643342 -0.117320197 9.072966e-01
N           -3.886138e-02   0.12818167 -0.303174262 7.636044e-01
S           -7.874779e+00  14.74705947 -0.533989803 5.968230e-01
M            1.629746e-01   0.20785304  0.784085841 4.384185e-01
W            1.351072e-01   0.10472364  1.290130466 2.057112e-01
U1          -5.848089e-01   0.43191770 -1.353982319 1.846739e-01
U2           1.819172e+00   0.84648600  2.149086500 3.883343e-02
Age          1.064473e+00   0.41645193  2.556051830 1.522626e-02
Ed           1.721558e+00   0.62864970  2.738501354 9.752489e-03
X            8.040071e-01   0.23201637  3.465303351 1.452904e-03
Ex0          1.009730e+00   0.24359222  4.145163752 2.131854e-04
(Intercept) -7.040822e+02 152.94347802 -4.603545173 5.576618e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update-1</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm3 <span class="ot">&lt;-</span> <span class="fu">update</span>(crime_rate_lm2, . <span class="sc">~</span> . <span class="sc">-</span> NW)</span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate  Std..Error    t.value     Pr...t..
LF            -0.01726849   0.1381358 -0.1250110 9.012301e-01
N             -0.03886188   0.1263370 -0.3076048 7.602061e-01
S             -7.88953914  12.7694182 -0.6178464 5.406763e-01
M              0.16308486   0.1981909  0.8228675 4.161547e-01
W              0.13515532   0.1007004  1.3421533 1.881884e-01
U1            -0.58495622   0.4200266 -1.3926648 1.725057e-01
U2             1.81920587   0.8341503  2.1809089 3.599816e-02
Age            1.06419549   0.3891918  2.7343726 9.740218e-03
Ed             1.72173268   0.6141343  2.8035115 8.189455e-03
X              0.80399165   0.2285624  3.5176026 1.227429e-03
Ex0            1.00951551   0.2179312  4.6322680 4.846288e-05
(Intercept) -704.12001486 149.6901234 -4.7038509 3.911594e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update-2</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm4 <span class="ot">&lt;-</span> <span class="fu">update</span>(crime_rate_lm3, . <span class="sc">~</span> . <span class="sc">-</span> LF)</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Estimate  Std..Error    t.value     Pr...t..
N             -0.04145888   0.1229018 -0.3373334 7.378245e-01
S             -7.18567759  11.3033138 -0.6357142 5.289835e-01
M              0.15058853   0.1687793  0.8922216 3.781994e-01
W              0.13416908   0.0990088  1.3551227 1.838211e-01
U1            -0.56348963   0.3780445 -1.4905379 1.447935e-01
U2             1.81276664   0.8210969  2.2077377 3.372029e-02
Age            1.06639529   0.3834415  2.7811163 8.565270e-03
Ed             1.70183790   0.5849903  2.9091728 6.175924e-03
X              0.79674056   0.2180364  3.6541625 8.159010e-04
Ex0            1.01443740   0.2113944  4.7987905 2.774137e-05
(Intercept) -700.19856796 144.3514585 -4.8506511 2.369307e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update-3</span></span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm5 <span class="ot">&lt;-</span> <span class="fu">update</span>(crime_rate_lm4,.<span class="sc">~</span>.<span class="sc">-</span>N)</span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate   Std..Error    t.value     Pr...t..
S             -6.5057045  10.98812498 -0.5920668 5.574067e-01
M              0.1772842   0.14728022  1.2037201 2.363427e-01
W              0.1282847   0.09628581  1.3323326 1.908991e-01
U1            -0.5752009   0.37191143 -1.5466073 1.304695e-01
U2             1.8090238   0.81113002  2.2302513 3.187983e-02
Age            1.0685350   0.37876979  2.8210671 7.651917e-03
Ed             1.7019848   0.57794198  2.9449059 5.556896e-03
X              0.7710981   0.20189436  3.8193147 4.943947e-04
Ex0            0.9833297   0.18792831  5.2324725 6.864110e-06
(Intercept) -716.5469741 134.33461432 -5.3340457 5.005846e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update-4</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm6 <span class="ot">&lt;-</span> <span class="fu">update</span>(crime_rate_lm5,.<span class="sc">~</span>.<span class="sc">-</span>S)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate   Std..Error   t.value     Pr...t..
M              0.1848948   0.14545901  1.271113 2.114146e-01
W              0.1271449   0.09544037  1.332192 1.907319e-01
U1            -0.5295794   0.36071897 -1.468122 1.503006e-01
U2             1.7070199   0.78581970  2.172279 3.614090e-02
Age            1.0083194   0.36172869  2.787502 8.248097e-03
Ed             1.7416360   0.56912198  3.060216 4.044243e-03
X              0.7320980   0.18920844  3.869267 4.153598e-04
Ex0            0.9785376   0.18614257  5.256926 5.935205e-06
(Intercept) -714.4047282 133.13339398 -5.366082 4.210448e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update-5</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm7 <span class="ot">&lt;-</span> <span class="fu">update</span>(crime_rate_lm6,.<span class="sc">~</span>.<span class="sc">-</span>M)</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate  Std..Error   t.value     Pr...t..
U1            -0.3091858   0.3188025 -0.969835 3.381053e-01
W              0.1454765   0.0950863  1.529942 1.341027e-01
U2             1.4415600   0.7635174  1.888051 6.647498e-02
Age            1.1317545   0.3511903  3.222624 2.566455e-03
Ed             2.0273937   0.5269502  3.847410 4.309248e-04
X              0.7960871   0.1838228  4.330732 1.006325e-04
Ex0            0.9862878   0.1875055  5.260046 5.496412e-06
(Intercept) -614.6654324 108.3983291 -5.670433 1.485771e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update-6</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm8 <span class="ot">&lt;-</span> <span class="fu">update</span>(crime_rate_lm7,.<span class="sc">~</span>.<span class="sc">-</span>U1)</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate  Std..Error   t.value     Pr...t..
W              0.1595649   0.0939003  1.699302 9.702803e-02
U2             0.8281694   0.4273992  1.937695 5.974283e-02
Age            1.1251803   0.3508640  3.206884 2.640080e-03
Ed             1.8178631   0.4802674  3.785106 5.048962e-04
X              0.8235714   0.1814902  4.537828 5.095878e-05
(Intercept) -618.5028439 108.2456006 -5.713884 1.193042e-06
Ex0            1.0506875   0.1752237  5.996264 4.783972e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update-7</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>crime_rate_lm9 <span class="ot">&lt;-</span> <span class="fu">update</span>(crime_rate_lm8,.<span class="sc">~</span>.<span class="sc">-</span>W)</span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p</span>(crime_rate_lm9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Estimate Std..Error   t.value     Pr...t..
U2             0.9136081  0.4340919  2.104642 4.149584e-02
Age            1.0198219  0.3532027  2.887356 6.175068e-03
Ed             2.0307726  0.4741890  4.282623 1.086147e-04
X              0.6349257  0.1468460  4.323752 9.559356e-05
(Intercept) -524.3743270 95.1155692 -5.513023 2.126586e-06
Ex0            1.2331222  0.1416347  8.706359 7.259666e-11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final summary</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(crime_rate_lm9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = R ~ Age + Ed + Ex0 + U2 + X, data = usc)

Residuals:
    Min      1Q  Median      3Q     Max 
-45.344  -9.859  -1.807  10.603  62.964 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -524.3743    95.1156  -5.513 2.13e-06 ***
Age            1.0198     0.3532   2.887 0.006175 ** 
Ed             2.0308     0.4742   4.283 0.000109 ***
Ex0            1.2331     0.1416   8.706 7.26e-11 ***
U2             0.9136     0.4341   2.105 0.041496 *  
X              0.6349     0.1468   4.324 9.56e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.3 on 41 degrees of freedom
Multiple R-squared:  0.7296,    Adjusted R-squared:  0.6967 
F-statistic: 22.13 on 5 and 41 DF,  p-value: 1.105e-10</code></pre>
</div>
</div>
</section>
<section id="forward-selection" class="level3">
<h3 class="anchored" data-anchor-id="forward-selection"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.2</strong></span> <strong>Forward selection</strong></h3>
<ol type="1">
<li>Start with no variables in the model.</li>
<li>For all predictors not in the model, check their p-value if they are added to the model. Choose the one with lowest p-value less than alpha critical.</li>
<li>Continue until no new predictors can be added.</li>
</ol>
</section>
<section id="aic-selection" class="level3">
<h3 class="anchored" data-anchor-id="aic-selection"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.3</strong></span> <strong>AIC selection</strong></h3>
<p>Akaike Information Criteria (AIC) <strong>principle</strong>: <mark>big -&gt; bad</mark></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>crime_rate_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(crime_rate_lm, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=301.66
R ~ Age + S + Ed + Ex0 + Ex1 + LF + M + N + NW + U1 + U2 + W + 
    X

       Df Sum of Sq   RSS    AIC
- NW    1       6.1 15885 299.68
- LF    1      34.4 15913 299.76
- N     1      48.9 15928 299.81
- S     1     149.4 16028 300.10
- Ex1   1     162.3 16041 300.14
- M     1     296.5 16175 300.53
&lt;none&gt;              15879 301.66
- W     1     810.6 16689 302.00
- U1    1     911.5 16790 302.29
- Ex0   1    1109.8 16989 302.84
- U2    1    2108.8 17988 305.52
- Age   1    2911.6 18790 307.57
- Ed    1    3700.5 19579 309.51
- X     1    5474.2 21353 313.58

Step:  AIC=299.68
R ~ Age + S + Ed + Ex0 + Ex1 + LF + M + N + U1 + U2 + W + X

       Df Sum of Sq   RSS    AIC
- LF    1      28.7 15913 297.76
- N     1      48.6 15933 297.82
- Ex1   1     156.3 16041 298.14
- S     1     158.0 16043 298.14
- M     1     294.1 16179 298.54
&lt;none&gt;              15885 299.68
- W     1     820.2 16705 300.05
- U1    1     913.1 16798 300.31
- Ex0   1    1104.3 16989 300.84
+ NW    1       6.1 15879 301.66
- U2    1    2107.1 17992 303.53
- Age   1    3365.8 19251 306.71
- Ed    1    3757.1 19642 307.66
- X     1    5503.6 21388 311.66

Step:  AIC=297.76
R ~ Age + S + Ed + Ex0 + Ex1 + M + N + U1 + U2 + W + X

       Df Sum of Sq   RSS    AIC
- N     1      62.2 15976 295.95
- S     1     129.4 16043 296.14
- Ex1   1     134.8 16048 296.16
- M     1     276.8 16190 296.57
&lt;none&gt;              15913 297.76
- W     1     801.9 16715 298.07
- U1    1     941.8 16855 298.47
- Ex0   1    1075.9 16989 298.84
+ LF    1      28.7 15885 299.68
+ NW    1       0.3 15913 299.76
- U2    1    2088.5 18002 301.56
- Age   1    3407.9 19321 304.88
- Ed    1    3895.3 19809 306.06
- X     1    5621.3 21535 309.98

Step:  AIC=295.95
R ~ Age + S + Ed + Ex0 + Ex1 + M + U1 + U2 + W + X

       Df Sum of Sq   RSS    AIC
- S     1     104.4 16080 294.25
- Ex1   1     123.3 16099 294.31
- M     1     533.8 16509 295.49
&lt;none&gt;              15976 295.95
- W     1     748.7 16724 296.10
- U1    1     997.7 16973 296.80
- Ex0   1    1021.3 16997 296.86
+ N     1      62.2 15913 297.76
+ LF    1      42.3 15933 297.82
+ NW    1       0.0 15976 297.95
- U2    1    2082.3 18058 299.71
- Age   1    3425.9 19402 303.08
- Ed    1    3887.6 19863 304.19
- X     1    5896.9 21873 308.71

Step:  AIC=294.25
R ~ Age + Ed + Ex0 + Ex1 + M + U1 + U2 + W + X

       Df Sum of Sq   RSS    AIC
- Ex1   1     171.5 16252 292.75
- M     1     563.4 16643 293.87
&lt;none&gt;              16080 294.25
- W     1     734.7 16815 294.35
- U1    1     906.0 16986 294.83
- Ex0   1    1162.0 17242 295.53
+ S     1     104.4 15976 295.95
+ N     1      37.2 16043 296.14
+ NW    1      14.2 16066 296.21
+ LF    1       1.9 16078 296.25
- U2    1    1978.0 18058 297.71
- Age   1    3354.5 19434 301.16
- Ed    1    4139.1 20219 303.02
- X     1    6094.8 22175 307.36

Step:  AIC=292.75
R ~ Age + Ed + Ex0 + M + U1 + U2 + W + X

       Df Sum of Sq   RSS    AIC
- M     1     691.0 16943 292.71
&lt;none&gt;              16252 292.75
- W     1     759.0 17011 292.90
- U1    1     921.8 17173 293.35
+ Ex1   1     171.5 16080 294.25
+ S     1     152.5 16099 294.31
+ NW    1      36.0 16215 294.65
+ N     1      23.1 16228 294.69
+ LF    1       5.5 16246 294.74
- U2    1    2018.1 18270 296.25
- Age   1    3323.1 19575 299.50
- Ed    1    4005.1 20257 301.11
- X     1    6402.7 22654 306.36
- Ex0   1   11818.8 28070 316.44

Step:  AIC=292.71
R ~ Age + Ed + Ex0 + U1 + U2 + W + X

       Df Sum of Sq   RSS    AIC
- U1    1     408.6 17351 291.83
&lt;none&gt;              16943 292.71
+ M     1     691.0 16252 292.75
- W     1    1016.9 17959 293.45
+ Ex1   1     299.0 16643 293.87
+ N     1     262.5 16680 293.98
+ LF    1     213.3 16729 294.11
+ S     1     213.1 16729 294.11
+ NW    1     114.2 16828 294.39
- U2    1    1548.6 18491 294.82
- Age   1    4511.6 21454 301.81
- Ed    1    6430.6 23373 305.83
- X     1    8147.7 25090 309.16
- Ex0   1   12019.6 28962 315.91

Step:  AIC=291.83
R ~ Age + Ed + Ex0 + U2 + W + X

       Df Sum of Sq   RSS    AIC
&lt;none&gt;              17351 291.83
+ U1    1     408.6 16942 292.71
- W     1    1252.6 18604 293.11
+ Ex1   1     251.2 17100 293.14
+ LF    1     230.7 17120 293.20
+ N     1     189.6 17162 293.31
+ M     1     177.8 17173 293.35
+ S     1      71.0 17280 293.64
+ NW    1      59.2 17292 293.67
- U2    1    1628.7 18980 294.05
- Age   1    4461.0 21812 300.58
- Ed    1    6214.7 23566 304.22
- X     1    8932.3 26283 309.35
- Ex0   1   15596.5 32948 319.97</code></pre>
</div>
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(crime_rate_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = R ~ Age + Ed + Ex0 + U2 + W + X, data = usc)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.306 -10.209  -1.313   9.919  54.544 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -618.5028   108.2456  -5.714 1.19e-06 ***
Age            1.1252     0.3509   3.207 0.002640 ** 
Ed             1.8179     0.4803   3.785 0.000505 ***
Ex0            1.0507     0.1752   5.996 4.78e-07 ***
U2             0.8282     0.4274   1.938 0.059743 .  
W              0.1596     0.0939   1.699 0.097028 .  
X              0.8236     0.1815   4.538 5.10e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 20.83 on 40 degrees of freedom
Multiple R-squared:  0.7478,    Adjusted R-squared:   0.71 
F-statistic: 19.77 on 6 and 40 DF,  p-value: 1.441e-10</code></pre>
</div>
</div>
</section>
<section id="result-3" class="level3">
<h3 class="anchored" data-anchor-id="result-3"><span style="color:gray; font-family:Microsoft JhengHei;"><strong>13.5.4</strong></span> <strong>Result</strong></h3>
<p><strong>According to the backward selection:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(crime_rate_lm9, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{R}} = -524.37 + 1.02(\operatorname{Age}) + 2.03(\operatorname{Ed}) + 1.23(\operatorname{Ex0}) + 0.91(\operatorname{U2}) + 0.63(\operatorname{X})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(crime_rate_lm9, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                                 R             
-----------------------------------------------
Age                          1.020***          
                              (0.353)          
                                               
Ed                           2.031***          
                              (0.474)          
                                               
Ex0                          1.233***          
                              (0.142)          
                                               
U2                            0.914**          
                              (0.434)          
                                               
X                            0.635***          
                              (0.147)          
                                               
Constant                    -524.374***        
                             (95.116)          
                                               
-----------------------------------------------
Observations                    47             
R2                             0.730           
Adjusted R2                    0.697           
Residual Std. Error      21.301 (df = 41)      
F Statistic           22.129*** (df = 5; 41)   
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>The model shows that the variables Age, Ed, Ex0, U2, and X explain 73% of the variability in the crime rates.<br></p>
<p><strong>According to the AIC selection:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(crime_rate_aic, <span class="at">use_coefs =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">\[
\operatorname{\widehat{R}} = -618.5 + 1.13(\operatorname{Age}) + 1.82(\operatorname{Ed}) + 1.05(\operatorname{Ex0}) + 0.83(\operatorname{U2}) + 0.16(\operatorname{W}) + 0.82(\operatorname{X})
\]</span></p>
</div>
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(crime_rate_aic, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                                 R             
-----------------------------------------------
Age                          1.125***          
                              (0.351)          
                                               
Ed                           1.818***          
                              (0.480)          
                                               
Ex0                          1.051***          
                              (0.175)          
                                               
U2                            0.828*           
                              (0.427)          
                                               
W                             0.160*           
                              (0.094)          
                                               
X                            0.824***          
                              (0.181)          
                                               
Constant                    -618.503***        
                             (108.246)         
                                               
-----------------------------------------------
Observations                    47             
R2                             0.748           
Adjusted R2                    0.710           
Residual Std. Error      20.827 (df = 40)      
F Statistic           19.771*** (df = 6; 40)   
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>The model shows that the variables Age, Ed, Ex0, U2, W, and X explain 75% of the variability in the crime rates.</p>
</section>
</section>
</section>
<section id="logistic-regression" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>14</strong></span> <strong>Logistic regression</strong></h1>
<p><span style="color:#008888">To be continue…</span></p>
</section>
<section id="poisson-regression" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>15</strong></span> <strong>Poisson regression</strong></h1>
<p><span style="color:#008888">To be continue…</span></p>
</section>
<section id="non-linear-regression" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>16</strong></span> <strong>Non-linear regression</strong></h1>
<p><span style="color:#008888">To be continue…</span></p>
</section>
<section id="principal-component-analysis" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>17</strong></span> <strong>Principal component analysis</strong></h1>
<p><span style="color:#008888">To be continue…</span></p>
</section>
<section id="cluster-analysis" class="level1">
<h1><span style="color:gray; font-family:Microsoft JhengHei;"><strong>18</strong></span> <strong>Cluster analysis</strong></h1>
<p><span style="color:#008888">To be continue…</span></p>
</section>
<section id="sessioninfo" class="level1">
<h1><strong><span style="color:green">SessionInfo:</span></strong></h1>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.3 (2023-03-15 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default

locale:
[1] LC_COLLATE=Chinese (Simplified)_China.utf8 
[2] LC_CTYPE=Chinese (Simplified)_China.utf8   
[3] LC_MONETARY=Chinese (Simplified)_China.utf8
[4] LC_NUMERIC=C                               
[5] LC_TIME=Chinese (Simplified)_China.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] jmv_2.3.4          car_3.1-1          carData_3.0-5      ISLR_1.4          
 [5] biotools_4.2       mvnormalTest_1.0.0 rstatix_0.7.2      MASS_7.3-58.2     
 [9] gplots_3.1.3       agricolae_1.3-5    openair_2.16-0     lubridate_1.9.2   
[13] forcats_1.0.0      stringr_1.5.0      dplyr_1.1.0        purrr_1.0.1       
[17] readr_2.1.4        tibble_3.1.8       tidyverse_2.0.0    latex2exp_0.9.6   
[21] patchwork_1.1.2    ggplot2_3.4.1      Epi_2.47           tidyr_1.3.0       
[25] magrittr_2.0.3     knitr_1.42        

loaded via a namespace (and not attached):
  [1] minqa_1.2.5         jmvcore_2.3.19      colorspace_2.1-0   
  [4] deldir_1.0-6        ellipsis_0.3.2      base64enc_0.1-3    
  [7] rstudioapi_0.14     farver_2.1.1        hexbin_1.28.3      
 [10] gsl_2.1-8           fansi_1.0.3         mvtnorm_1.1-3      
 [13] splines_4.2.3       jsonlite_1.8.4      nloptr_2.0.3       
 [16] broom_1.0.3         cluster_2.1.4       png_0.1-8          
 [19] stabledist_0.7-1    copula_1.1-2        shiny_1.7.4        
 [22] mapproj_1.2.11      compiler_4.2.3      backports_1.4.1    
 [25] Matrix_1.5-3        fastmap_1.1.0       cli_3.6.1          
 [28] later_1.3.0         htmltools_0.5.4     tools_4.2.3        
 [31] gtable_0.3.3        glue_1.6.2          maps_3.4.1         
 [34] Rcpp_1.0.10         vctrs_0.5.2         nlme_3.1-162       
 [37] stargazer_5.2.3     xfun_0.37           lme4_1.1-31        
 [40] timechange_0.2.0    mime_0.12           miniUI_0.1.1.1     
 [43] lifecycle_1.0.3     gtools_3.9.4        zoo_1.8-11         
 [46] scales_1.2.1        hms_1.1.2           promises_1.2.0.1   
 [49] parallel_4.2.3      faraway_1.0.8       RColorBrewer_1.1-3 
 [52] yaml_2.3.7          mvnormtest_0.1-9    labelled_2.10.0    
 [55] reshape_0.8.9       latticeExtra_0.6-30 stringi_1.7.12     
 [58] highr_0.10          klaR_1.7-2          AlgDesign_1.2.1    
 [61] corrplot_0.92       pcaPP_2.0-3         nortest_1.0-4      
 [64] caTools_1.18.2      boot_1.3-28.1       rlang_1.1.0        
 [67] pkgconfig_2.0.3     moments_0.14.1      bitops_1.0-7       
 [70] evaluate_0.20       lattice_0.20-45     htmlwidgets_1.6.1  
 [73] labeling_0.4.2      cmprsk_2.2-11       tidyselect_1.2.0   
 [76] GGally_2.1.2        plyr_1.8.8          R6_2.5.1           
 [79] generics_0.1.3      combinat_0.0-8      ADGofTest_0.3      
 [82] pillar_1.8.1        haven_2.5.1         withr_2.5.0        
 [85] mgcv_1.8-42         survival_3.5-3      abind_1.4-5        
 [88] pspline_1.0-19      etm_1.1.1           questionr_0.7.8    
 [91] interp_1.1-3        KernSmooth_2.23-20  utf8_1.2.3         
 [94] tzdb_0.3.0          rmarkdown_2.21      equatiomatic_0.3.1 
 [97] jpeg_0.1-10         grid_4.2.3          data.table_1.14.8  
[100] digest_0.6.31       xtable_1.8-4        httpuv_1.6.9       
[103] numDeriv_2016.8-1.1 stats4_4.2.3        munsell_0.5.0      </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>